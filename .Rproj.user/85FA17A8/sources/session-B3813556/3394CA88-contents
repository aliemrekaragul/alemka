
percent_al<-function(df){
  x<- vector("numeric", length=length(df))
  for (i in 1:length(df))
    x[i]<-round(df[i]/sum(df),3)
  
   return(x)
}

#iki sütun halinde tabloyu okutuyoruz:
data<-read.csv("Kitap1.csv", header = FALSE, sep = ";")
colnames(data)<-c("difficulty", "discrimination")
data<-na.omit(data)
mytable<-table(data$difficulty, data$discrimination)

mytable

#EŞANTİYONLAR:
disc_total<-colSums(mytable)
#percent_diff<- percent_al(dif_total)

percent_disc<- percent_al(disc_total)
mytable<-rbind(mytable, disc_total, percent_disc)
dif_total<-rowSums(mytable)
mytable<-cbind(mytable, dif_total)
mytable

data<-read.csv("dif-disc data.csv", header = TRUE, sep = ";")



labelDifficulties<-function (itemDifficulties){
  difficultycommemnt <- c()
  for (difficulty in 1:length(itemDifficulties)){
    if(itemDifficulties[difficulty] <= 0.2){difficultycommemnt[difficulty]<- "difficult" 
    }else if(itemDifficulties[difficulty] > 0.2 & itemDifficulties[difficulty] < 0.8){difficultycommemnt[difficulty]<- "moderate"
    }else{difficultycommemnt[difficulty]<- "easy"
    }
    }
  print(difficultycommemnt)
}



labelDiscriminations<- function(itemDiscriminations){
  discriminationcomment<-c()
  for (discrimination in 1:length(itemDiscriminations)) {
    if(itemDiscriminations[discrimination] <= 0 | is.na(itemDiscriminations[discrimination] )  ){discriminationcomment[discrimination]<- "DISCARD"
    }else if(itemDiscriminations[discrimination] <= 0.2 & itemDiscriminations[discrimination] > 0){ discriminationcomment[discrimination]<- "revise"
    }else if(itemDiscriminations[discrimination] <= 0.3 & itemDiscriminations[discrimination] > 0.2){ discriminationcomment[discrimination]<- "mediocre"
    }else if(itemDiscriminations[discrimination] <= 0.4 & itemDiscriminations[discrimination] > 0.3){ discriminationcomment[discrimination]<- "good"
    }else if(itemDiscriminations[discrimination] > 0.4){ discriminationcomment[discrimination]<- "very good"
    }
  }
  print(discriminationcomment)
  }

table(
labelDifficulties(data[,2]),
labelDiscriminations(data[,3]))


















