<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title> </title>
<link>https://emrekaragul.com/</link>
<atom:link href="https://emrekaragul.com/index.xml" rel="self" type="application/rss+xml"/>
<description>My educational data science blog / notebook</description>
<generator>quarto-1.5.57</generator>
<lastBuildDate>Wed, 04 Dec 2024 21:00:00 GMT</lastBuildDate>
<item>
  <title>Language Detection &amp; Sentiment Analysis with Local LLMs</title>
  <dc:creator>Ali Emre Karagül</dc:creator>
  <link>https://emrekaragul.com/posts/localLlm/</link>
  <description><![CDATA[ <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mailchimp Subscription Modal</title>
<link href="//cdn-images.mailchimp.com/embedcode/classic-071822.css" rel="stylesheet" type="text/css">
<style>
        /* Modal Background */
        .modal {
            display: none; /* Hidden by default */
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5); /* Dimmed background */
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        #openModalBtn {
            background-color: tomato; /* background */
            color: white; /* White text */
            border: none; /* Remove border */
            padding: 10px 20px; /* Add padding */
            font-size: 24px; /* Adjust font size */
            border-radius: 5px; /* Rounded corners */
            cursor: pointer; /* Pointer cursor on hover */
            transition: background-color 0.3s ease; /* Smooth hover effect */
            width: 100%;
            margin-bottom: 20px; /* Add space after the button */
        }

        #openModalBtn:hover {
            background-color: rgb(255, 58, 23); /* Darker on hover */
        }
        /* Modal Content */
        .modal-content {
            background-color: #fff;
            padding: 20px;
            border-radius: 8px;
            max-width: 600px;
            width: 90%;
            text-align: center;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            overflow: auto;
        }

        /* Close Button */
        .close-btn {
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 20px;
            font-weight: bold;
            color: #aaa;
            cursor: pointer;
        }

        .close-btn:hover {
            color: #000;
        }
    </style>
<!-- Trigger Button --><button id="openModalBtn">Wanna subscribe?</button>


    <!-- Modal Structure -->
    <div id="subscriptionModal" class="modal">
        <div class="modal-content">
            <span class="close-btn">×</span>
            <!-- Mailchimp Signup Form -->
            <div>
                <div id="mc_embed_signup">
                    <form action="https://emrekaragul.us21.list-manage.com/subscribe/post?u=e72720e0214b2266cab41097e&amp;id=5cddb1a68e&amp;f_id=0038dfe1f0" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate="">
                        <div id="mc_embed_signup_scroll">
                            <h2 class="anchored">Submit your e-mail to subscribe!</h2>
                            <div class="mc-field-group">
                                <label for="mce-EMAIL">Email Address <span class="asterisk">*</span></label>
                                <input type="email" value="" name="EMAIL" class="required email" id="mce-EMAIL" required=""><span id="mce-EMAIL-HELPERTEXT" class="helper_text"></span>
                            </div>
                            <div id="mce-responses" class="clear foot">
                                <div class="response" id="mce-error-response" style="display:none"></div>
                                <div class="response" id="mce-success-response" style="display:none"></div>
                            </div>
                            
                            <div class="optionalParent">
                                <div class="clear foot">
                                    <input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button">
</div>
                            </div>
                        </div>
                    </form>
                </div>
                <script type="text/javascript" src="//s3.amazonaws.com/downloads.mailchimp.com/js/mc-validate.js"></script><script type="text/javascript">
                    (function($) {
                        window.fnames = new Array();
                        window.ftypes = new Array();
                        fnames[0] = 'EMAIL';
                        ftypes[0] = 'email';
                    }(jQuery));
                    var $mcj = jQuery.noConflict(true);
                </script><!--End mc_embed_signup-->
</div>
        </div>
    </div>

    <script>
        // Get the modal, button, and close elements
        const modal = document.getElementById("subscriptionModal");
        const openModalBtn = document.getElementById("openModalBtn");
        const closeBtn = document.querySelector(".close-btn");

        // Open the modal when the button is clicked
        openModalBtn.addEventListener("click", () => {
            modal.style.display = "flex"; // Show the modal
        });

        // Close the modal when the close button is clicked
        closeBtn.addEventListener("click", () => {
            modal.style.display = "none"; // Hide the modal
        });

        // Close the modal when clicking outside of it
        window.addEventListener("click", (e) => {
            if (e.target === modal) {
                modal.style.display = "none";
            }
        });
    </script><section id="introduction" class="level2"><h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>I have recently received an e-mail from Posit about their recent developments. They have released the BETA version of their new IDE, Positron, for data scientists along with several R packages and a chat bot customized for shiny apps, <a href="https://shiny.posit.co/blog/posts/shiny-assistant/?mkt_tok=NzA5LU5YTi03MDYAAAGXLPFmi2C2rOPNBjAVW1SwVe8Qy-c6SQuWQRpE_vGdNHqd7B4AyQmuYvkCYDOH6eTQdWJNQBXM9mal0BiSbCCx1Za6LGqDU1bHUgkiTfEf9wq7">Shiny Assistant</a>. The packages are <a href="https://elmer.tidyverse.org/?mkt_tok=NzA5LU5YTi03MDYAAAGXLPFmi3BulXH3PmcuNNnpj_xia93mA1SBo0ctMWi_dJF8-kNxZujHYP6JrQL8KemkBg-dLEqQ2jOd4NIfmwFLn0_FcQktFLjyYUeN8fApLCPN">elmer</a>, <a href="https://github.com/simonpcouch/pal?mkt_tok=NzA5LU5YTi03MDYAAAGXLPFmi_FVwNiBAxVKZUFZ6hp7Sb71tc8kSSBlnYK_26jg7kx7JfrC5FDchiJAcsuN4TuZx3MnyRb-RKQf1pES_IQi8clt65qzJvUxbDF5Y4P6">pal</a>, and <a href="https://github.com/mlverse/mall?mkt_tok=NzA5LU5YTi03MDYAAAGXLPFmi4p_MDoSVwPizwPfCnziIInxDDGJOzYifsoOENazWrJEY8UUo_KmbkpRXmbEbTaXO6_XjSfEbjyB1AD4-_BpVMD0KWV8aBvmPkedBebu">mall</a>. Today, we will try <code>mall</code> with a local LLM to automate several tasks and run a sentiment analysis.</p>
<p>A few years ago, running an LLM locally would be a dream for most of the data scientists. However, with the recent developments in the field, there are many free-to-use LLMs that can be run on your local machine. I am choosing my words carefully here. Since Meta released llama, they advertise it as open-source. Yet, it is not open-source in the sense that you can see the algorithm behind it or/and the data used to train it. It is open-source in the sense that you can use it for free. In this regard, it is more of a free-to-use tool than an open-source tool. However, I should also appreciate the effort behind it as we can use a strong LLM freely on our local computers.</p>
</section><section id="getting-started" class="level2 page-columns page-full"><h2 class="anchored" data-anchor-id="getting-started">Getting Started</h2>
<p>Enough of politics. Let’s get started by downloading ollama to our local machine.</p>
<section id="download-ollama" class="level3"><h3 class="anchored" data-anchor-id="download-ollama">Download Ollama</h3>
<p>Ollama is an open-source LLM service tool that helps users to utilize LLMs locally with a single line of command. You can download it from <a href="https://ollama.com/download">here</a> depending on your operating system. Yet, I will run you through Windows rather than Linux or MacOS.</p>
<p>Click <code>Windows</code> on the download page and then click the download button. Once the download is complete, open the downloaded installer. As far as I remember, the installer completes without any prompting.</p>
<p>Before we use R, we need to set some basics. A local LLM is highly dependent on your hardware. You need a good CPU, RAM, and VRAM to run it. Today, I will use <code>llama3.1 8b</code>. <code>8b</code> in the model name refers to the number of parameters that the model is trained with. The more parameters, the more accurate the model. However, the more parameters, the more hardware you need.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Requirements for llama3.1 8b">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Requirements for llama3.1 8b
</div>
</div>
<div class="callout-body-container callout-body">
<p>CPU &gt;= 8 cores</p>
<p>RAM &gt;= 16 GB</p>
<p>VRAM &gt;= 8GB</p>
<p>NVIDIA RTX 3070 or better</p>
</div>
</div>
<p>If you do not have sufficient hardware, you can use a smaller model such as <code>llama3.2</code> which comes with <code>1b</code> and <code>3b</code>. <code>Gemma:2b</code> is also a viable option. If you have even a better computer, you can try other models with higher parameters. You can see the list of all available models <a href="https://ollama.com/search">here</a>.</p>
</section><section id="install-the-model" class="level3 page-columns page-full"><h3 class="anchored" data-anchor-id="install-the-model">Install the Model</h3>
<p>There are many ways to install the model. We will discuss two here. You can either use the terminal or <code>mall</code> package in R. My personal preference is to use the terminal as we will need to terminate ollama to end the memory usage when we are done. However, if you are not familiar with the terminal, you can use R.</p>
<section id="install-the-model-on-the-terminal" class="level4 page-columns page-full"><h4 class="anchored" data-anchor-id="install-the-model-on-the-terminal">Install the Model on the Terminal</h4>
<p>Once you have decided on your model, open a terminal. You can do that by searching for <code>Windows PowerShell</code> and running it. If you are Rstudio user, you can also open a terminal in Rstudio. They will both work for our use case.</p>

<div class="no-row-height column-margin column-container"><div class="">
<p><a href="images/empty_terminal.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="https://emrekaragul.com/posts/localLlm/images/empty_terminal.png" class="img-fluid" alt="PowerShell Terminal"></a></p>
</div></div><p>On the terminal, type the following command with the model name of your preference. <code>ollama run &lt;model name&gt;</code></p>

<div class="no-row-height column-margin column-container"><div class="">
<p><a href="images/empty_terminal_2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img src="https://emrekaragul.com/posts/localLlm/images/empty_terminal_2.png" class="img-fluid" alt="RStudio Terminal"></a></p>
</div></div><pre class="terminal"><code>ollama run llama3.1:8b</code></pre>
<p>This will install the model to your computer, if it is not installed already, and then it will start a chat session with the model. You can chat with the bot on the terminal directly. To end the session, simply type <code>/bye</code> or <code>CTRL + C</code>.</p>
<p>You can install as many models as you like as long as your hardware allows. To see all the models that you have installed so far, run <code>ollama list</code> command on the terminal.</p>

<div class="no-row-height column-margin column-container"><div class="">
<p><a href="images/list_models.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img src="https://emrekaragul.com/posts/localLlm/images/list_models.png" class="img-fluid"></a></p>
</div></div></section><section id="install-the-model-via-r" class="level4"><h4 class="anchored" data-anchor-id="install-the-model-via-r">Install the Model via R</h4>
<p>To install a model via R, you need to load the <code>mall</code> package. In the mall package, <code>pull("&lt;model name&gt;")</code> function is used to install a model. <code><a href="https://hauselin.github.io/ollama-r/reference/test_connection.html">test_connection()</a></code> is used to see if your local LLM up and running.</p>
<div class="cell">
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;"><a href="https://hauselin.github.io/ollama-r/">ollamar</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'ollamar' was built under R version 4.4.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'ollamar'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:stats':

    embed</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:methods':

    show</code></pre>
</div>
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model_name</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"llama3.1:8b"</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ollamar</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://hauselin.github.io/ollama-r/reference/pull.html">pull</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model_name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>&lt;httr2_response&gt;</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>POST http://127.0.0.1:11434/api/pull</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Status: 200 OK</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Content-Type: application/x-ndjson</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Body: In memory (861 bytes)</code></pre>
</div>
</div>
<p><code><a href="https://hauselin.github.io/ollama-r/reference/list_models.html">list_models()</a></code> is used to see the models that you have installed so far. That one is more informative than the terminal command as it gives us the parameter size and the quantization level too.</p>
<div class="cell">
<div class="sourceCode" id="cb13" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ollamar</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://hauselin.github.io/ollama-r/reference/list_models.html">list_models</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             name   size parameter_size quantization_level            modified
1        gemma:2b 1.7 GB             3B               Q4_0 2024-12-05T01:49:40
2     llama3.1:8b 4.9 GB           8.0B             Q4_K_M 2024-12-05T14:25:24
3 llama3.2:latest   2 GB           3.2B             Q4_K_M 2024-11-29T20:35:04
4       llama3:8b 4.7 GB           8.0B               Q4_0 2024-12-05T01:19:43
5   llama3:latest 4.7 GB           8.0B               Q4_0 2024-11-30T00:58:23</code></pre>
</div>
</div>
<p>You can also test the model by giving a prompt. The <code>generate</code> function is used to generate a response from the model.</p>
<div class="cell">
<div class="sourceCode" id="cb15" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ollamar</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://hauselin.github.io/ollama-r/reference/generate.html">generate</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model_name</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Tell me a joke about statistics."</span>, output <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"text"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> </span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Here's one:\n\nWhy did the statistician turn down the invitation to the party?\n\nBecause he already had a 99% probability of being bored and a 1% chance of meeting interesting people.\n\nHope that made you laugh!"</code></pre>
</div>
</div>
</section></section></section><section id="task-automation" class="level2 page-columns page-full"><h2 class="anchored" data-anchor-id="task-automation">Task Automation</h2>
<p>If you have come so far, you are ready to use your local LLMs for anything. Let’s see some example usage.</p>
<section id="language-detection" class="level3"><h3 class="anchored" data-anchor-id="language-detection">Language Detection</h3>
<p>Most LLMs are multi-lingual. You can use them to detect the language of a given text such as a comment or a review. Let’s build such an automation. We will use a dataset of global comments from YouTube videos on Kaggle. You can download the <code>csv</code> file directly from <a href="https://drive.google.com/file/d/16uUKmQKbNOSffKr7X8qvYqHDVHANAAON/view?usp=sharing">my Google drive</a> too.</p>
<section id="preparing-the-data" class="level4"><h4 class="anchored" data-anchor-id="preparing-the-data">Preparing the Data</h4>
<p>The data is too large, so in this part, we will investigate and select a subset of 20 rows that contain multiple languages, emojis, urls etc. We will then detect the language of each comment in the subset using our local LLM.</p>
<p>We will be using packages such as <code>dplyr</code>, <code>stringr</code>, <code>tidyverse</code>, and <code>purrr</code> to manipulate the data. Also <code>mall</code> package, having very useful functions such as <code><a href="https://rdrr.io/pkg/mall/man/llm_sentiment.html">llm_sentiment()</a></code>, <code><a href="https://rdrr.io/pkg/mall/man/llm_classify.html">llm_classify()</a></code>, <code><a href="https://rdrr.io/pkg/mall/man/llm_extract.html">llm_extract()</a></code>, <code><a href="https://rdrr.io/pkg/mall/man/llm_custom.html">llm_custom()</a></code> etc, will be used to interact with the LLM.</p>
<div class="cell">
<div class="sourceCode" id="cb17" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;"><a href="https://stringr.tidyverse.org">stringr</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;"><a href="https://purrr.tidyverse.org/">purrr</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> </span>
<span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;"><a href="https://mlverse.github.io/mall/">mall</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span></span>
<span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># set a seed parameter to make the results reproducible</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">123</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
</div>
<p>Let’s load the data and see the structure of it.</p>
<div class="cell">
<div class="sourceCode" id="cb18" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">global_comments</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"GBcomments.csv"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">global_comments</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   video_id         comment_text          likes             replies         
 Length:273551      Length:273551      Length:273551      Length:273551     
 Class :character   Class :character   Class :character   Class :character  
 Mode  :character   Mode  :character   Mode  :character   Mode  :character  </code></pre>
</div>
</div>
<p>We need to change the class of <code>likes</code> and <code>replies</code> to numeric. Also, I have checked the data and detected many duplicate rows. So, we need to get rid of the duplicate data entries. Also let’s drop the rows with NA values.</p>
<div class="cell">
<div class="sourceCode" id="cb20" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">global_comments</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">likes</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">global_comments</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">likes</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">global_comments</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">replies</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">global_comments</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">replies</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span></span>
<span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># drop rows with the same comment text in the same video</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">global_comments</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">global_comments</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://dplyr.tidyverse.org/reference/distinct.html">distinct</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">video_id</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">comment_text</span>, .keep_all <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://tidyr.tidyverse.org/reference/drop_na.html">drop_na</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">global_comments</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">global_comments</span> </span>
<span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">global_comments</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   video_id         comment_text           likes             replies       
 Length:152589      Length:152589      Min.   :    0.00   Min.   :   0.00  
 Class :character   Class :character   1st Qu.:    0.00   1st Qu.:   0.00  
 Mode  :character   Mode  :character   Median :    0.00   Median :   0.00  
                                       Mean   :   16.94   Mean   :  13.95  
                                       3rd Qu.:    0.00   3rd Qu.:   0.00  
                                       Max.   :60630.00   Max.   :3498.00  </code></pre>
</div>
</div>
<p>We have 152589 rows of data. For the demonstration purposes, I will select a couple of videos with comments in multiple languages. There are many ways to detect videos with comments in multiple languages. My approach will be to search for specific strings in Korean, Arabic and German. For example, the first letter of “hello” in Korean is “한” according to Google Translate. Let’s search for this letter in the comments and select the video with the most comments. Also, utilize a similar approach for Arabic and German. Remember we are doing this to create the perfect subset of comments with multiple languages.</p>
<div class="cell">
<div class="sourceCode" id="cb22" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">korean_letter</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"한"</span> </span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">arabic_letter</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ا"</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># the first letter of arabic letters</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">german_word</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" und "</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># "und" is "and" in German</span></span>
<span></span>
<span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">vid_w_korean_comments</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">global_comments</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">comment_text</span>,<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">korean_letter</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">video_id</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>n_comments <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://dplyr.tidyverse.org/reference/desc.html">desc</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">n_comments</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">vid_w_arabic_comments</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">global_comments</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">comment_text</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">arabic_letter</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">video_id</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>n_comments <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://dplyr.tidyverse.org/reference/desc.html">desc</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">n_comments</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">vid_w_german_comments</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">global_comments</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">comment_text</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">german_word</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">video_id</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>n_comments <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://dplyr.tidyverse.org/reference/desc.html">desc</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">n_comments</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span></span>
<span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># merge these rows</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">vids_multiple_langs</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">vid_w_korean_comments</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">vid_w_arabic_comments</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">vid_w_german_comments</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">vids_multiple_langs</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 2
  video_id    n_comments
  &lt;chr&gt;            &lt;int&gt;
1 HuoOEry-Yc4         10
2 jt2OHQh0HoQ         11
3 11S5tcT2Tm0          1</code></pre>
</div>
</div>
<p>We have selected 3 videos with comments in multiple languages. Let’s create a dataset with these videos and their comments called <code>dat</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb24" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">dat</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">global_comments</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">video_id</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">vids_multiple_langs</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">video_id</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">dat</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   video_id         comment_text           likes            replies       
 Length:897         Length:897         Min.   : 0.0000   Min.   : 0.0000  
 Class :character   Class :character   1st Qu.: 0.0000   1st Qu.: 0.0000  
 Mode  :character   Mode  :character   Median : 0.0000   Median : 0.0000  
                                       Mean   : 0.6722   Mean   : 0.1538  
                                       3rd Qu.: 0.0000   3rd Qu.: 0.0000  
                                       Max.   :31.0000   Max.   :12.0000  </code></pre>
</div>
</div>
<p>There are 897 comments in total. I checked it with a glimpse and it actually contains comments in many languages. For example:</p>
<div class="cell">
<div class="sourceCode" id="cb26" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/utils/head.html">tail</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">dat</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">comment_text</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Marvelous, as Always!"                                                                                                                                                                                                                                                                                  
 [2] "Bellisimo :3Saludos desde Mexico cdmx"                                                                                                                                                                                                                                                                  
 [3] "Pure! Serene! and Marvelous!"                                                                                                                                                                                                                                                                           
 [4] "So diverse. Much ethnic. Wow."                                                                                                                                                                                                                                                                          
 [5] "Enough said"                                                                                                                                                                                                                                                                                            
 [6] "😘😘😘😱😱"                                                                                                                                                                                                                                                                                                  
 [7] "woow.. eres magnifica, por ti me apasione con el violin y compre el mio... soy tu mas grande admiradora, dios y algun dia me lo permita conocerte es mi mayor sueño y aprender a tocar el violin.. sigue triunfando y robando los carazones de las personas asi como me lo robaste a mi con tu melodia."
 [8] "Cuando veniste a Guadalajara y escuche esta canción I couldnt believe it was just like no mames 😍😍😍"                                                                                                                                                                                                    
 [9] "man kann richtig sehen wie dir das Tanze und Violine spielen spass und freude macht. 👍\\n\\nSo macht das zuschauen nochmal so viel spass.\\n\\nSuper Video☺️👍"                                                                                                                                           
[10] "Heisses Outfit , dass der Sound gut ist, ist ja schon bald selbstverständlich."                                                                                                                                                                                                                         </code></pre>
</div>
</div>
<p>I can see many languages except for Korean and Arabic in the tail. :D Let’s select a random subset of this data to test our language detection bot.</p>
<div class="cell">
<div class="sourceCode" id="cb28" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># select random 20 comments.</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">dat</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">dat</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://dplyr.tidyverse.org/reference/sample_n.html">sample_n</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">dat</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">comment_text</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "YOU ARE SO CLOSE TO 10 MILLION!!!"                                                                                                                                                                                                                                                                              
 [2] "😍"                                                                                                                                                                                                                                                                                                              
 [3] "Also watch https://youtu.be/7QkYTgDMpCs"                                                                                                                                                                                                                                                                        
 [4] "I❤️U 💋💋💋💋💋💋💋💋💋😍😍😍😍😍😍😍😍😘😘😘😘😘😘😘😘😘💖💖💖💖💖💖💖💖😻😻😻😻😻😻👸👸👸👸👸👸💟💟💟💟💝💝💝💝💓💓💓💗💗💗💜💜💜💋💋💋👰👰👰"                                                                                                                                                                                                                                      
 [5] "Ya lo tengo y estoy escribiendo de acá del iPhone me anda de 10"                                                                                                                                                                                                                                                
 [6] "Amazing video I love the Bollywood touch in this video keep going Lindsey!!"                                                                                                                                                                                                                                    
 [7] "Where's iPhone 9? Just skips to iPhone x. Lol okay nice math there Apple"                                                                                                                                                                                                                                       
 [8] "عملت قنات جديدة تختص في تقديم أنجح و أسهل وصفات الحلويات، تعالو شوفو الفديوهات التي اعملها والله ما رح تندمو ❤"                                                                                                                                                                                                 
 [9] "Nothing new..\\nIphoneX is copy of essiential phone.\\nAndy Rubin has developed more advanced features than iPhoneX.\\nIPHONE X 👎👎👎"                                                                                                                                                                            
[10] "Lol @22:46:09\\n\\nTim's kinda an ass"                                                                                                                                                                                                                                                                          
[11] "3 years late on wireless charging, 3 years late on oled technology , old facial recognition tech enhanced by old IR tech. So your late on just about every front....what to do? I know, lets lose what makes our product instantly recognizable! This is Apples windows 8, Samsung are bound to be loving this."
[12] "https://youtu.be/Kp_DBWtS6SU"                                                                                                                                                                                                                                                                                   
[13] "I love your music videos their always great and inspiring!"                                                                                                                                                                                                                                                     
[14] "I like for Linsey. Love yours full themes. Great job."                                                                                                                                                                                                                                                          
[15] "I love that blond hair!!!!"                                                                                                                                                                                                                                                                                     
[16] "黒髪もも可愛すぎ😍💕💕"                                                                                                                                                                                                                                                                                            
[17] "Sana is my damn bias wrecker, i swear. between her and Nayeon it's so hard😂❤"                                                                                                                                                                                                                                   
[18] "where is Steve Wozniak, fuck apple authority"                                                                                                                                                                                                                                                                   
[19] "just one question, wtf?"                                                                                                                                                                                                                                                                                        
[20] "She is BEA-UTIFUL. And this showed a side I've never seen before. Which is not surprising. She's always giving us surprises....she keeps me in my toes"                                                                                                                                                         </code></pre>
</div>
</div>
</section><section id="detecting-languages" class="level4"><h4 class="anchored" data-anchor-id="detecting-languages">Detecting languages</h4>
<p>That subset looks good. I can see emojis, urls and multiple languages along with English. That’s a perfect subset to test the language detection capabilities of our LLM. Here is what we will do: 1. Attach the model with <code><a href="https://rdrr.io/pkg/mall/man/llm_use.html">llm_use()</a></code>. 2. Define a system prompt for language detection. 3. OPTIONAL: Define the valid responses that you expect from the LLM. If this is defined, any response that do not fit the valid responses will be replaced with <code>NA</code>. 4. Detect the language of each comment in the data and add the results as a new column.</p>
<div class="cell">
<div class="sourceCode" id="cb30" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/mall/man/llm_use.html">llm_use</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ollama"</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model_name</span>, seed <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, .silent <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sys_prompt</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span></span>
<span>  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"You are a language detection bot."</span>,</span>
<span>  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"I will provide you with Youtube comments on a video."</span>,</span>
<span>  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Try to detect the language of the comment and reply with the ISO 639-1 language code used in the given comment."</span>,</span>
<span>  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Reply only with the language code."</span>,</span>
<span>  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"If you cannot detect a language as the comments might contain emojis or urls only, reply with 'UNDETECTABLE' with uppercase"</span>,</span>
<span>  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Some examples:"</span>,</span>
<span>  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"comment text: 'Thumbs up asap', your response: 'en'."</span>,</span>
<span>  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"comment text: 'Hola, ¿cómo estás?', your response: 'es'."</span>, </span>
<span>  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Here is the comment:"</span></span>
<span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span></span>
<span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># I am not adding 'UNDETECTABLE' to valid responses as the function will tag such cases as NA.</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">valid_responses</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"aa"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ab"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ae"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"af"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ak"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"am"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"an"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ar-ae"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ar-bh"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ar-dz"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ar-eg"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ar-iq"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ar-jo"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ar-kw"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ar-lb"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ar-ly"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ar-ma"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ar-om"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ar-qa"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ar-sa"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ar-sy"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ar-tn"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ar-ye"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ar"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"as"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"av"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ay"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"az"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ba"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"be"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bg"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bh"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bi"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bm"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bn"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bo"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"br"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bs"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ca"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ce"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ch"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"co"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cr"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cs"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cu"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cv"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cy"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"da"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"de-at"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"de-ch"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"de-de"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"de-li"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"de-lu"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"de"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"div"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dv"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dz"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ee"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"el"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"en-au"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"en-bz"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"en-ca"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"en-cb"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"en-gb"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"en-ie"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"en-jm"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"en-nz"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"en-ph"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"en-tt"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"en-us"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"en-za"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"en-zw"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"en"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"eo"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"es-ar"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"es-bo"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"es-cl"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"es-co"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"es-cr"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"es-do"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"es-ec"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"es-es"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"es-gt"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"es-hn"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"es-mx"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"es-ni"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"es-pa"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"es-pe"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"es-pr"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"es-py"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"es-sv"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"es-us"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"es-uy"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"es-ve"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"es"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"et"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"eu"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fa"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ff"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fi"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fj"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fo"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fr-be"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fr-ca"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fr-ch"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fr-fr"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fr-lu"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fr-mc"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fr"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fy"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ga"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gd"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gl"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gn"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gu"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gv"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ha"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"he"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"hi"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ho"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"hr-ba"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"hr-hr"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"hr"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ht"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"hu"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"hy"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"hz"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ia"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"id"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ie"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ig"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ii"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ik"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"in"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"io"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"is"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"it-ch"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"it-it"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"it"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"iu"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"iw"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ja"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ji"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"jv"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"jw"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ka"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"kg"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ki"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"kj"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"kk"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"kl"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"km"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"kn"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ko"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"kok"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"kr"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ks"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ku"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"kv"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"kw"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ky"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"kz"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"la"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lb"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lg"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"li"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ln"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lo"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ls"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lt"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lu"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lv"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mg"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mh"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mi"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mk"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ml"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mn"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mo"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mr"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ms-bn"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ms-my"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ms"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mt"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"my"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"na"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"nb"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"nd"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ne"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ng"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"nl-be"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"nl-nl"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"nl"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"nn"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"no"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"nr"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ns"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"nv"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ny"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"oc"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"oj"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"om"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"or"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"os"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pa"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pi"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pl"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ps"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pt-br"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pt-pt"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pt"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"qu-bo"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"qu-ec"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"qu-pe"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"qu"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"rm"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"rn"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ro"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ru"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"rw"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sa"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sb"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sc"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sd"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"se-fi"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"se-no"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"se-se"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"se"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sg"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sh"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"si"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sk"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sl"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sm"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sn"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"so"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sq"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sr-ba"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sr-sp"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sr"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ss"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"st"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"su"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sv-fi"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sv-se"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sv"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sw"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sx"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"syr"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ta"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"te"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tg"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"th"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ti"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tk"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tl"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tn"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"to"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tr"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ts"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tt"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tw"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ty"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ug"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"uk"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ur"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"us"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"uz"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ve"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"vi"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"vo"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"wa"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"wo"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"xh"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"yi"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"yo"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"za"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"zh-cn"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"zh-hk"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"zh-mo"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"zh-sg"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"zh-tw"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"zh"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"zu"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">dat</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">dat</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/mall/man/llm_custom.html">llm_custom</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">comment_text</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sys_prompt</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"language"</span>, valid_resps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">valid_responses</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>! There were 3 predictions with invalid output, they were coerced to NA</code></pre>
</div>
</div>
<p>Let’s see the results.</p>
<div class="cell">
<div class="sourceCode" id="cb32" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">dat</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">dat</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># convert dat to tibble (optional)</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">dat</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">language</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">comment_text</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 20 × 2
   language comment_text                                                        
   &lt;chr&gt;    &lt;chr&gt;                                                               
 1 en       "YOU ARE SO CLOSE TO 10 MILLION!!!"                                 
 2 &lt;NA&gt;     "\U0001f60d"                                                        
 3 &lt;NA&gt;     "Also watch https://youtu.be/7QkYTgDMpCs"                           
 4 en       "I❤️U \U0001f48b\U0001f48b\U0001f48b\U0001f48b\U0001f48b\U0001f48b\U…
 5 es       "Ya lo tengo y estoy escribiendo de acá del iPhone me anda de 10"   
 6 en       "Amazing video I love the Bollywood touch in this video keep going …
 7 en       "Where's iPhone 9? Just skips to iPhone x. Lol okay nice math there…
 8 ar       "عملت قنات جديدة تختص في تقديم أنجح و أسهل وصفات الحلويات، تعالو شو…
 9 en       "Nothing new..\\nIphoneX is copy of essiential phone.\\nAndy Rubin …
10 en       "Lol @22:46:09\\n\\nTim's kinda an ass"                             
11 en       "3 years late on wireless charging, 3 years late on oled technology…
12 &lt;NA&gt;     "https://youtu.be/Kp_DBWtS6SU"                                      
13 en       "I love your music videos their always great and inspiring!"        
14 en       "I like for Linsey. Love yours full themes. Great job."             
15 en       "I love that blond hair!!!!"                                        
16 ja       "黒髪もも可愛すぎ\U0001f60d\U0001f495\U0001f495"                    
17 ko       "Sana is my damn bias wrecker, i swear. between her and Nayeon it's…
18 en       "where is Steve Wozniak, fuck apple authority"                      
19 en       "just one question, wtf?"                                           
20 en       "She is BEA-UTIFUL. And this showed a side I've never seen before. …</code></pre>
</div>
</div>
<p>Nice, we have detected the languages of the comments. We can also see that some comments are tagged as <code>NA</code>. These are the comments that contain emojis, urls, or gibberish.</p>
</section></section><section id="sentiment-analysis" class="level3"><h3 class="anchored" data-anchor-id="sentiment-analysis">Sentiment Analysis</h3>
<p>For the sentiment analysis we will use another <a href="https://www.kaggle.com/datasets/arhamrumi/amazon-product-reviews">Kaggle</a> dataset. You can download it from my Google Drive <a href="https://drive.google.com/file/d/1Q5pFKuwwKrwcQnDyBixW98VwVt7cZYnT/view?usp=sharing">here</a>. The dataset contains Amazon product reviews. We will select random 20 comments and run a sentiment analysis on them.</p>
<div class="cell">
<div class="sourceCode" id="cb34" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">reviews</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"reviews.csv"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">reviews</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       Id         ProductId            UserId          ProfileName       
 Min.   :    1   Length:35173       Length:35173       Length:35173      
 1st Qu.: 8794   Class :character   Class :character   Class :character  
 Median :17587   Mode  :character   Mode  :character   Mode  :character  
 Mean   :17587                                                           
 3rd Qu.:26380                                                           
 Max.   :35173                                                           
                                                                         
 HelpfulnessNumerator HelpfulnessDenominator     Score      
 Min.   :  0.000      Min.   :  0.000        Min.   :1.000  
 1st Qu.:  0.000      1st Qu.:  0.000        1st Qu.:4.000  
 Median :  0.000      Median :  1.000        Median :5.000  
 Mean   :  1.558      Mean   :  2.002        Mean   :4.156  
 3rd Qu.:  1.000      3rd Qu.:  2.000        3rd Qu.:5.000  
 Max.   :203.000      Max.   :219.000        Max.   :5.000  
 NA's   :1            NA's   :1              NA's   :1      
      Time             Summary              Text          
 Min.   :9.617e+08   Length:35173       Length:35173      
 1st Qu.:1.268e+09   Class :character   Class :character  
 Median :1.307e+09   Mode  :character   Mode  :character  
 Mean   :1.294e+09                                        
 3rd Qu.:1.330e+09                                        
 Max.   :1.351e+09                                        
 NA's   :1                                                </code></pre>
</div>
</div>
<section id="preparing-the-data-1" class="level4"><h4 class="anchored" data-anchor-id="preparing-the-data-1">Preparing the Data</h4>
<p>The data actually contains a <code>score</code> column which is the rating of the product. We will select 4 random reviews for each score from 1 to 5 so that we can also test the LLM performance this time.</p>
<div class="cell">
<div class="sourceCode" id="cb36" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">reviews_sample</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">reviews</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://tidyr.tidyverse.org/reference/drop_na.html">drop_na</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Score</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://dplyr.tidyverse.org/reference/sample_n.html">sample_n</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://dplyr.tidyverse.org/reference/group_by.html">ungroup</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
</div>
</section><section id="running-sentiment-analysis" class="level4"><h4 class="anchored" data-anchor-id="running-sentiment-analysis">Running Sentiment Analysis</h4>
<p>We can use <code><a href="https://rdrr.io/pkg/mall/man/llm_custom.html">llm_custom()</a></code> function again with a well developed system prompt by ourselves. Yet, the package <code>mall</code> already contains a function for sentiment analysis called <code><a href="https://rdrr.io/pkg/mall/man/llm_sentiment.html">llm_sentiment()</a></code>. Let’s try it out:</p>
<p>First, attach the model. Then run the sentiment analysis on the reviews. We will use the <code>Text</code> column as the target variable and <code>comment_sentiment</code> as the new column name for the sentiment analysis results.</p>
<div class="cell">
<div class="sourceCode" id="cb37" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/mall/man/llm_use.html">llm_use</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ollama"</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model_name</span>, seed <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, .silent <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">reviews_sample</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/mall/man/llm_sentiment.html">llm_sentiment</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">reviews_sample</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Text</span>, pred_name <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"comment_sentiment"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
</div>
<p>Let’s see the results.</p>
<div class="cell">
<div class="sourceCode" id="cb38" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">reviews_sample</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">comment_sentiment</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Score</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Text</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 20 × 3
   comment_sentiment Score Text                                                 
   &lt;chr&gt;             &lt;int&gt; &lt;chr&gt;                                                
 1 negative              1 "I have 2 chihuahua's and they are not at all intere…
 2 negative              1 "I am sure that this coffee tastes good, but I am no…
 3 negative              1 "I bought this gourmet popping corn believing I was …
 4 negative              1 "I strongly suspect this caviar, which is widely ava…
 5 negative              2 "I ordered this for my birthday. I got birthday mone…
 6 negative              2 "I love raspberry and chocolate.  I could live on Se…
 7 negative              2 "As with most of the reviews here my tins arrived wi…
 8 negative              2 "These dried strawberries do taste good - indeed, th…
 9 negative              3 "It was my mistake - I thought there were 6 bags rat…
10 neutral               3 "I have been feeding Canidae for a long time, and wh…
11 negative              3 "I usually buy this at our local Whole Foods or Harr…
12 neutral               3 "This carbonated product has a nice natural juice ta…
13 negative              4 "If you read the first review and then read the comp…
14 positive              4 "This Wolfgang Puck coffee tasted great. The vanilla…
15 positive              4 "Being a peanut butter lover, have to keep it out of…
16 positive              4 "My dogs are bone lovers.  These are a little messy …
17 positive              5 "Received aj&amp;iacute; amarillo in a well-wrapped box.…
18 positive              5 "This coffee is bold and strong, just how I like it.…
19 positive              5 "Having been on a gluten free diet for less than a y…
20 neutral               5 "I have to admit, when I saw this available on vine …</code></pre>
</div>
</div>
<p>We can see that although our bot is mostly successful, there are some false negative (where the detected sentiment is negative while the score is 4 or 5) results. A larger model would be more successful in this task. Yet, there are no false positive results as all 1 and 2 scores are detected as negative. Naturally, we expect scores 3 to be neutral, but the comment might be more on the negative or positive side. So it is ok if the model detects a 3 as negative or positive rather than neutral.</p>
</section></section><section id="terminate-the-ollama-session" class="level3 page-columns page-full"><h3 class="anchored" data-anchor-id="terminate-the-ollama-session">Terminate the Ollama Session</h3>
<p>Whatever the task is, after using a local LLM, it would be wise to terminate the session to free up the memory. You can do this by running the following command in the terminal.</p>
<pre class="terminal"><code> Get-Process | Where-Object {$_.ProcessName -like '*ollama*'} | Stop-Process</code></pre>
<p>What I do to make sure that the session is terminated is to check the memory usage of the LLM on the Task Manager. Just press <code>CTRL + ALT + DEL</code> and select Task Manager on Windows. Then go to the <code>Processes</code> tab and order by <code>Memory</code>. You will see the memory usage of Ollama. If ollama is not in the list or its memory usage value is close to zero, then the session is terminated. See the screen shot before the termination below. The memory usage is up above of the list. After stopping the process, it was gone.</p>

<div class="no-row-height column-margin column-container"><div class="">
<p><a href="images/task_manager_before.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4"><img src="https://emrekaragul.com/posts/localLlm/images/task_manager_before.png" class="img-fluid"></a></p>
</div></div></section></section><section id="conclusion" class="level2"><h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<p>In this post, we discussed how to use a local LLM for language detection and sentiment analysis. Ollama services were used to install <code>llama3.1:8b</code> We used the <code>mall</code> package to interact with the LLM. We also discussed how to install the model and how to terminate the session on the terminal.</p>
<p>We have seen that the LLM is quite successful in detecting the languages of the comments or the sentiments of the reviews. <strong>An important final mark would be to remember that the larger the model, the better the accuracy.</strong> However, the larger the model, the more hardware you need. So, it is always a trade-off between accuracy and resources.</p>


</section> ]]></description>
  <category>ollamar</category>
  <category>mall</category>
  <category>dplyr</category>
  <category>stringr</category>
  <category>purrr</category>
  <category>tidyverse</category>
  <guid>https://emrekaragul.com/posts/localLlm/</guid>
  <pubDate>Wed, 04 Dec 2024 21:00:00 GMT</pubDate>
  <media:content url="https://emrekaragul.com/posts/localLlm/image.png" medium="image" type="image/png" height="144" width="144"/>
</item>
<item>
  <title>How to Build a Custom Chat Bot with R</title>
  <dc:creator>Ali Emre Karagül</dc:creator>
  <link>https://emrekaragul.com/posts/ChatBot/</link>
  <description><![CDATA[ <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mailchimp Subscription Modal</title>
<link href="//cdn-images.mailchimp.com/embedcode/classic-071822.css" rel="stylesheet" type="text/css">
<style>
        /* Modal Background */
        .modal {
            display: none; /* Hidden by default */
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5); /* Dimmed background */
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        #openModalBtn {
            background-color: tomato; /* background */
            color: white; /* White text */
            border: none; /* Remove border */
            padding: 10px 20px; /* Add padding */
            font-size: 24px; /* Adjust font size */
            border-radius: 5px; /* Rounded corners */
            cursor: pointer; /* Pointer cursor on hover */
            transition: background-color 0.3s ease; /* Smooth hover effect */
            width: 100%;
            margin-bottom: 20px; /* Add space after the button */
        }

        #openModalBtn:hover {
            background-color: rgb(255, 58, 23); /* Darker on hover */
        }
        /* Modal Content */
        .modal-content {
            background-color: #fff;
            padding: 20px;
            border-radius: 8px;
            max-width: 600px;
            width: 90%;
            text-align: center;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            overflow: auto;
        }

        /* Close Button */
        .close-btn {
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 20px;
            font-weight: bold;
            color: #aaa;
            cursor: pointer;
        }

        .close-btn:hover {
            color: #000;
        }
    </style>
<!-- Trigger Button --><button id="openModalBtn">Wanna subscribe?</button>


    <!-- Modal Structure -->
    <div id="subscriptionModal" class="modal">
        <div class="modal-content">
            <span class="close-btn">×</span>
            <!-- Mailchimp Signup Form -->
            <div>
                <div id="mc_embed_signup">
                    <form action="https://emrekaragul.us21.list-manage.com/subscribe/post?u=e72720e0214b2266cab41097e&amp;id=5cddb1a68e&amp;f_id=0038dfe1f0" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate="">
                        <div id="mc_embed_signup_scroll">
                            <h2 class="anchored">Submit your e-mail to subscribe!</h2>
                            <div class="mc-field-group">
                                <label for="mce-EMAIL">Email Address <span class="asterisk">*</span></label>
                                <input type="email" value="" name="EMAIL" class="required email" id="mce-EMAIL" required=""><span id="mce-EMAIL-HELPERTEXT" class="helper_text"></span>
                            </div>
                            <div id="mce-responses" class="clear foot">
                                <div class="response" id="mce-error-response" style="display:none"></div>
                                <div class="response" id="mce-success-response" style="display:none"></div>
                            </div>
                            
                            <div class="optionalParent">
                                <div class="clear foot">
                                    <input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button">
</div>
                            </div>
                        </div>
                    </form>
                </div>
                <script type="text/javascript" src="//s3.amazonaws.com/downloads.mailchimp.com/js/mc-validate.js"></script><script type="text/javascript">
                    (function($) {
                        window.fnames = new Array();
                        window.ftypes = new Array();
                        fnames[0] = 'EMAIL';
                        ftypes[0] = 'email';
                    }(jQuery));
                    var $mcj = jQuery.noConflict(true);
                </script><!--End mc_embed_signup-->
</div>
        </div>
    </div>

    <script>
        // Get the modal, button, and close elements
        const modal = document.getElementById("subscriptionModal");
        const openModalBtn = document.getElementById("openModalBtn");
        const closeBtn = document.querySelector(".close-btn");

        // Open the modal when the button is clicked
        openModalBtn.addEventListener("click", () => {
            modal.style.display = "flex"; // Show the modal
        });

        // Close the modal when the close button is clicked
        closeBtn.addEventListener("click", () => {
            modal.style.display = "none"; // Hide the modal
        });

        // Close the modal when clicking outside of it
        window.addEventListener("click", (e) => {
            if (e.target === modal) {
                modal.style.display = "none";
            }
        });
    </script><section id="introduction" class="level2"><h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>Using LLMs in our daily tasks is a common practice now. Most of the time we use them with user interfaces provided by the companies such as OpenAi. However, they are also highly utilized by developers in chat bots or automation processes. There are dozens of commercial or non-commercial LLMs in the market. You can use any of them to build your own chat bot. In this tutorial, we will use llama to build a custom chat bot with R.</p>
<div class="callout callout-style-default callout-note callout-titled" title="about R package Elmer">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
about R package Elmer
</div>
</div>
<div class="callout-body-container callout-body">
<p>I have read that Hadly Wickham and Posit have been working on an R package into <code>Tidyverse</code> to make LLM API calls from R. It is still experimental; thus can be installed via <a href="https://github.com/tidyverse/elmer">github repository</a>. We are not going to be using it in this tutorial.</p>
</div>
</div>
<p>There are two ways to use llama: 1. Run llama on your local machine if your machine has sufficient hardware. 2. Use an API to send requests to servers of third-party providers such as Groq.</p>
<p>The first option is pretty easy and there are many interfaces to use llama on your local machine. However, it requires a GPU depending on the model you would like to utilize and is used by only your local environment unless you make your own server out of your computer. The second option, on the other hand, is more scalable and you can deploy it to web. You won’t need to worry about the hardware (GPUs etc) or the maintenance of the server.</p>
<p>In this tutorial, we will use the second option to build our chat bot, but if you want to use the first option, you can download llama to your local environment from <a href="https://ollama.com/download">here</a>. Also, see a tutorial about how to build a local LMM <a href="https://www.datacamp.com/tutorial/run-llama-3-locally">here</a>.</p>
</section><section id="getting-started" class="level2 page-columns page-full"><h2 class="anchored" data-anchor-id="getting-started">Getting Started</h2>
<p>Yet, today, we will use Groq’s servers to build our chat bot. <a href="https://groq.com/about-us/">Groq</a> is an amazing web tool that provides free APIs to developers with hourly and daily limits. But, no need to worry as the limits are quite high and it is almost impossible to reach them unless you are using it in your production environment rather than development purposes. You can sign up for free and get your API key from <a href="https://console.groq.com/login">here</a>.</p>

<div class="no-row-height column-margin column-container"><div class="">
<p><a href="images/groq_playground.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Groq Playground Interface"><img src="https://emrekaragul.com/posts/ChatBot/images/groq_playground.png" class="img-fluid" alt="Groq Playground Interface"></a> Click to expand.</p>
</div></div><ol type="1">
<li>Go to the link and sign up with your prefered method.</li>
<li>You will be directed to the Groq’s playground where you can try different LLMs with custom system messages or parameters. Click on the image to expand it.</li>
<li>Click on <strong>API Keys</strong> on the left side of the screen.</li>
<li>Then, click on the <strong>Create API Key</strong> button on the page.</li>
<li>Give a name to your API key and click on the <strong>Submit</strong> button.</li>
<li>You will see your API key on the screen. Copy it and save it in a safe place. You won’t be able to see it again, so if you lose your API key, you will need to create a new one. Never share it with anybody.</li>
</ol>
<p>That’s it, you have your API key now. Let’s see some ways to use a free LLM in your R environment.</p>
</section><section id="using-groq-api-with-r" class="level2"><h2 class="anchored" data-anchor-id="using-groq-api-with-r">Using Groq API with R</h2>
<p>Assign your API key and <code>model</code> name to variables in your R environment. Model can be any one of the models provided by Groq such as <code>gemma2-9b-it</code> or <code>whisper-large-v3-turbo</code>. You can see the list of models <a href="https://console.groq.com/docs/models">here</a>. We will use <code>llama-3.1-70b-versatile</code> in this tutorial.</p>
<div class="cell">
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">api_key</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"COPY_YOUR_API_KEY_HERE"</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"llama-3.1-70b-versatile"</span></span></code></pre></div>
</div>
<p>We can use <code>httr</code> package to send HTTP requests to the server and get the response. We can also use <code>jsonlite</code> package to parse the response.</p>
<div class="cell">
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;"><a href="https://httr.r-lib.org/">httr</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;"><a href="https://jeroen.r-universe.dev/jsonlite">jsonlite</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">chatbot</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">api_key</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">conversation_history</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span></span>
<span>  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">url</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://api.groq.com/openai/v1/chat/completions"</span></span>
<span>  </span>
<span></span>
<span>  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">response</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://httr.r-lib.org/reference/POST.html">POST</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span></span>
<span>    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">url</span>,</span>
<span>    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://httr.r-lib.org/reference/add_headers.html">add_headers</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span></span>
<span>      `Content-Type` <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"application/json"</span>,</span>
<span>      `Authorization` <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Bearer"</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">api_key</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span>    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>,</span>
<span>    body <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/jsonlite/man/fromJSON.html">toJSON</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span></span>
<span>      model <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model</span>,</span>
<span>      messages <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">conversation_history</span></span>
<span>    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>, auto_unbox <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>,</span>
<span>    encode <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"json"</span></span>
<span>  <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span>  </span>
<span>  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://httr.r-lib.org/reference/http_status.html">http_status</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">response</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">category</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Success"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span>    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;"><a href="https://rdrr.io/r/base/stop.html">stop</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"API request failed: "</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://httr.r-lib.org/reference/content.html">content</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">response</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"text"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span>  <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span>  </span>
<span>  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">result</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://httr.r-lib.org/reference/content.html">content</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">response</span>, as <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"parsed"</span>, simplifyVector <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span>  </span>
<span>  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">result</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"choices"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"message"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"content"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span></code></pre></div>
</div>
<p>The given code is a function called <code>chatbot</code> that sends a POST request to the Groq’s server with the given <code>api_key</code>, <code>model</code> and <code>conversation_history</code>. The <code>conversation_history</code> is a list of messages that the chat bot has either received or replied so far. The function returns the response of the LLM as a string. We will be using this function to make requests to the API.</p>
<p>Let’s make a try:</p>
<div class="cell">
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">conversation_history</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">user_message</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Hello, tell me a joke about statistics!"</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">conversation_history</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/append.html">append</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">conversation_history</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>role <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"user"</span>, content <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">user_message</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span></span>
<span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get the response from the chat bot</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">bot_response</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">chatbot</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">api_key</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">conversation_history</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">bot_response</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Why did the statistician get lost in the forest? 

Because he was 95% sure he was on the right path.</code></pre>
</div>
</div>
</section><section id="running-the-bot-on-the-console" class="level2 page-columns page-full"><h2 class="anchored" data-anchor-id="running-the-bot-on-the-console">Running the Bot on the Console</h2>
<p>Now that we are sure we can get response to our messages, let’s build a simple chat bot that can be run on the console. We will use <code>readline</code> function to get the user input.</p>
<div class="cell">
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Chatbot initialized. Type 'exit' to quit."</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">while</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span>  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">user_message</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/readline.html">readline</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>prompt <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"You: "</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span>  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/chartr.html">tolower</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">user_message</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"exit"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span>    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Goodbye!"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span>    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">break</span></span>
<span>  <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span>  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">conversation_history</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/append.html">append</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">conversation_history</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>role <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"user"</span>, content <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">user_message</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span>  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">bot_response</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">chatbot</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">api_key</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">conversation_history</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span>  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">conversation_history</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/append.html">append</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">conversation_history</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>role <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"assistant"</span>, content <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">bot_response</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Chat bot:"</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">bot_response</span>, sep <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"\n"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span></code></pre></div>
</div>
<p>When you run this code, you will be prompted to type your message in the console. You will start a conversation with the chat bot, and you can ask follow-up questions as we inform the API about the conversation history while making the requests. Click on the image to expand.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><a href="images/chat-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Chat Example-1"><img src="https://emrekaragul.com/posts/ChatBot/images/chat-1.png" class="img-fluid figure-img" style="width:100.0%" alt="Chat Example"></a></p>
<figcaption>Chat Example-1</figcaption></figure>
</div>
<p>The bot will expect you to type a message until you type <code>exit</code> to quit the conversation or close the console. Even if you type <code>exit</code>, your conversation history will be stored in your local R environment. Unless you delete it or reassign an empty list again, the chat bot will remember the previous messages and will reply you accordingly when you start it again. To reassign an empty list, or in other words to clear the chat history, you just need to run the following:</p>
<div class="cell">
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">conversation_history</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
</div>
<section id="creating-a-custom-bot-with-a-system-message" class="level3 page-columns page-full"><h3 class="anchored" data-anchor-id="creating-a-custom-bot-with-a-system-message">Creating a Custom Bot with a System Message</h3>
<p>We can also give a system message to the API to inform the chat bot about the context of the conversation. This will assign a persona to the bot and it will reply accordingly. For example; “<strong>You are a comedian bot who makes jokes about statistics. No matter what the user says, just make a joke about statistics.</strong>” would be a good system message for our bot called <code>fun_stats_bot</code>. All we need is to <code>append</code> the system message in to the conversation history when it is called for the first time.</p>
<div class="cell">
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fun_stats_bot</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">api_key</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">conversation_history</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span>  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">conversation_history</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span>    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">system_message</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"You are a comedian bot who makes jokes about statistics. No matter what the user says, just make a joke about statistics."</span></span>
<span>    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">conversation_history</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/append.html">append</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">conversation_history</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>role <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"system"</span>, content <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">system_message</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span>  <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span>  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">url</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://api.groq.com/openai/v1/chat/completions"</span></span>
<span>  </span>
<span></span>
<span>  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">response</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://httr.r-lib.org/reference/POST.html">POST</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span></span>
<span>    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">url</span>,</span>
<span>    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://httr.r-lib.org/reference/add_headers.html">add_headers</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span></span>
<span>      `Content-Type` <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"application/json"</span>,</span>
<span>      `Authorization` <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Bearer"</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">api_key</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span>    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>,</span>
<span>    body <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/jsonlite/man/fromJSON.html">toJSON</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span></span>
<span>      model <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model</span>,</span>
<span>      messages <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">conversation_history</span></span>
<span>    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>, auto_unbox <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>,</span>
<span>    encode <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"json"</span></span>
<span>  <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span>  </span>
<span>  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://httr.r-lib.org/reference/http_status.html">http_status</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">response</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">category</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Success"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span>    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;"><a href="https://rdrr.io/r/base/stop.html">stop</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"API request failed: "</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://httr.r-lib.org/reference/content.html">content</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">response</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"text"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span>  <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span>  </span>
<span>  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">result</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://httr.r-lib.org/reference/content.html">content</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">response</span>, as <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"parsed"</span>, simplifyVector <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span>  </span>
<span>  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">result</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"choices"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"message"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"content"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span></code></pre></div>
</div>
<p>Now, we can run the chat bot with the <code>fun_stats_bot</code> function this time. See a sample chat’s image.</p>

<div class="no-row-height column-margin column-container"><div class="">
<p><a href="images/chat-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3" title="Chat Example-2"><img src="https://emrekaragul.com/posts/ChatBot/images/chat-2.png" class="img-fluid" style="width:100.0%" alt="Chat Example"></a> Click to expand.</p>
</div></div><div class="cell">
<div class="sourceCode" id="cb8" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Chatbot initialized. Type 'exit' to quit."</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">while</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span>  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">user_message</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/readline.html">readline</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>prompt <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"You: "</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span>  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/chartr.html">tolower</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">user_message</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"exit"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span>    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Goodbye!"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span>    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">break</span></span>
<span>  <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span>  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">conversation_history</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/append.html">append</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">conversation_history</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>role <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"user"</span>, content <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">user_message</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span>  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">bot_response</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fun_stats_bot</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">api_key</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">conversation_history</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span>  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">conversation_history</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/append.html">append</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">conversation_history</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>role <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"assistant"</span>, content <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">bot_response</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Chat bot:"</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">bot_response</span>, sep <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"\n"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span></code></pre></div>
</div>
</section></section><section id="building-a-shiny-app-of-a-chat-bot" class="level2"><h2 class="anchored" data-anchor-id="building-a-shiny-app-of-a-chat-bot">Building a Shiny App of a Chat Bot</h2>
<p>That’s it. We have built our own chat bot with R. We can build a web application with it and even deploy it to the web. Here is a sample shiny app: <a href="https://aliemrekaragul.shinyapps.io/fun_stat_bot/">Funny Statistics Bot</a>. The source code for it is also given below (expand the code block to see). This code will create a shiny app that you can run on your local machine or on web. You can find a lot of tutorials on web such as <a href="https://shiny.posit.co/r/deploy.html">how to deploy a shiny app to the web</a>.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb9" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;"><a href="https://shiny.posit.co/">shiny</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;"><a href="https://httr.r-lib.org/">httr</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;"><a href="https://jeroen.r-universe.dev/jsonlite">jsonlite</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;"><a href="https://rstudio.github.io/bslib/">bslib</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">### UTILITIES &amp; VARIABLES ###</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">groq_k</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"COPY_YOUR_API_KEY_HERE"</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"llama-3.1-70b-versatile"</span></span>
<span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">chatbot</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">groq_k</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">conversation_history</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span>  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">url</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://api.groq.com/openai/v1/chat/completions"</span></span>
<span>  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">conversation_history</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span>    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">system_message</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"You are a comedian bot who makes jokes about statistics. No matter what the user says, just make a joke about statistics."</span></span>
<span>    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">conversation_history</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/append.html">append</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">conversation_history</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>role <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"system"</span>, content <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">system_message</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span>  <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span>  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">response</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://httr.r-lib.org/reference/POST.html">POST</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span></span>
<span>    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">url</span>,</span>
<span>    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://httr.r-lib.org/reference/add_headers.html">add_headers</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span></span>
<span>      `Content-Type` <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"application/json"</span>,</span>
<span>      `Authorization` <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Bearer"</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">groq_k</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span>    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>,</span>
<span>    body <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/jsonlite/man/fromJSON.html">toJSON</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span></span>
<span>      model <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model</span>,</span>
<span>      messages <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">conversation_history</span></span>
<span>    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>, auto_unbox <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>,</span>
<span>    encode <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"json"</span></span>
<span>  <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span>  </span>
<span>  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://httr.r-lib.org/reference/http_status.html">http_status</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">response</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">category</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Success"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span>    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;"><a href="https://rdrr.io/r/base/stop.html">stop</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"API request failed: "</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://httr.r-lib.org/reference/content.html">content</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">response</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"text"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span>  <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span>  </span>
<span>  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">result</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://httr.r-lib.org/reference/content.html">content</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">response</span>, as <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"parsed"</span>, simplifyVector <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span>  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">result</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"choices"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"message"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"content"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">press_enter_to_send</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">$(function() {</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  var $els = $("[data-proxy-click]");</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  $.each(</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    $els,</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    function(idx, el) {</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">      var $el = $(el);</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">      var $proxy = $("#" + $el.data("proxyClick"));</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">      $el.keydown(function (e) {</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">        if (e.keyCode == 13) {</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">          $proxy.click();</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">        }</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">      });</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    }</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  );</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">});</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span></span>
<span></span>
<span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">### FRONTEND ###</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ui</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rstudio.github.io/bslib/reference/page_sidebar.html">page_sidebar</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span></span>
<span>  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">tags</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">tags</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">script</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rstudio.github.io/htmltools/reference/HTML.html">HTML</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">press_enter_to_send</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>,</span>
<span>  title <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Funny Statistics Bot"</span>,</span>
<span>  sidebar <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rstudio.github.io/bslib/reference/sidebar.html">sidebar</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span></span>
<span>    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Your old conversations would be here, but this app does not store your data."</span></span>
<span>  <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>,</span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rstudio.github.io/bslib/reference/card.html">card</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span></span>
<span>    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rstudio.github.io/bslib/reference/card_body.html">card_header</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Conversation"</span>, class <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bg-dark"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>,</span>
<span>    </span>
<span>    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rstudio.github.io/bslib/reference/card_body.html">card_body</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>class <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bg-light"</span>,</span>
<span>      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/shiny/man/htmlOutput.html">uiOutput</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"conversation_display"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span>    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>,</span>
<span>    </span>
<span>    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rstudio.github.io/bslib/reference/card_body.html">card_footer</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span></span>
<span>      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rstudio.github.io/htmltools/reference/tagAppendAttributes.html">tagAppendAttributes</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span></span>
<span>        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/shiny/man/textInput.html">textInput</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"user_message"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Your Message:"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>, width <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"100%"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>,</span>
<span>        `data-proxy-click` <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"send"</span></span>
<span>      <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>,</span>
<span>      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/shiny/man/actionButton.html">actionButton</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"send"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Send"</span>, icon <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/shiny/man/icon.html">icon</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"paper-plane"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>, class <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"btn-primary"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>,</span>
<span>      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/shiny/man/actionButton.html">actionButton</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"clear"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Clear"</span>, icon <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/shiny/man/icon.html">icon</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"trash-alt"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>, class <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"btn-danger"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>,</span>
<span>    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span>  <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span></span>
<span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">### BACKEND ###</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">server</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">input</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">output</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">session</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span></span>
<span>  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">conversation_history</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/shiny/man/reactiveVal.html">reactiveVal</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span>  </span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/shiny/man/observeEvent.html">observeEvent</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">input</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">send</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span>    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/shiny/man/req.html">req</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">input</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">user_message</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> </span>
<span>    </span>
<span>    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">current_history</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">conversation_history</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span>    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">current_history</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/append.html">append</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">current_history</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>role <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"user"</span>, content <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">input</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">user_message</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span></span>
<span>    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">bot_response</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;"><a href="https://rdrr.io/r/base/conditions.html">tryCatch</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span>      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">chatbot</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">groq_k</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">current_history</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span>    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span>, error <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">e</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span>      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Error: Unable to fetch response. Please try again."</span></span>
<span>    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span>    </span>
<span>    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">current_history</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/append.html">append</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">current_history</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>role <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"assistant"</span>, content <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">bot_response</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span>    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">conversation_history</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">current_history</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span>    </span>
<span>    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/shiny/man/updateTextInput.html">updateTextInput</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">session</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"user_message"</span>, value <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span>  <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span>  </span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/shiny/man/observeEvent.html">observeEvent</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">input</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">clear</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span>    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">conversation_history</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span>  <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span>  </span>
<span>  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">output</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">conversation_display</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/shiny/man/renderUI.html">renderUI</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span>    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">history</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">conversation_history</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span>    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">history</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span>      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rstudio.github.io/htmltools/reference/builder.html">p</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Start chatting!"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span>    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span>    </span>
<span>    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">tags</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">div</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span></span>
<span>      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">history</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>, <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">i</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span>        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">message</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">history</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[[</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">i</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span></span>
<span>        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">message</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">role</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"user"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span>          <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">tags</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">tags</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">b</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"You: "</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">message</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">content</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span>        <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span>          <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">tags</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">tags</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">b</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Chatbot: "</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">message</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">content</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span>        <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span>      <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span>    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span>  <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span></span>
<span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Run the app</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/shiny/man/shinyApp.html">shinyApp</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>ui <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ui</span>, server <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">server</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
</details>
</div>
</section><section id="conclusion" class="level2"><h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<p>In this tutorial, we have learned how to build a custom chat bot with R using Groq’s API. We have also built a shiny app. There are many use cases for LLMs in production. You can build RAG (retrieval augmented generation), CoT (chain of thought), or HyDE (Hypothetical Document Embeddings) models with R to make your chat bot more intelligent and customized. You can also use the same API to build a question-answering system or a summarization tool. You can build a to-do list generator that can give you items with only a goal phrase. You can create a bot to convert natural language to SQL queries (Text-2-SQL). The possibilities are endless. I hope you enjoyed this tutorial and learned something new. If you have any questions or comments, please feel free to reach out to me. Thank you for reading.</p>


</section> ]]></description>
  <category>httr</category>
  <category>jsonlite</category>
  <category>shiny</category>
  <category>bslib</category>
  <guid>https://emrekaragul.com/posts/ChatBot/</guid>
  <pubDate>Tue, 26 Nov 2024 21:00:00 GMT</pubDate>
  <media:content url="https://emrekaragul.com/posts/ChatBot/image.png" medium="image" type="image/png" height="144" width="144"/>
</item>
<item>
  <title>Multidimensional IRT for Factor Exploration</title>
  <dc:creator>Ali Emre Karagül</dc:creator>
  <link>https://emrekaragul.com/posts/efaWithLikertData-2/</link>
  <description><![CDATA[ <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mailchimp Subscription Modal</title>
<link href="//cdn-images.mailchimp.com/embedcode/classic-071822.css" rel="stylesheet" type="text/css">
<style>
        /* Modal Background */
        .modal {
            display: none; /* Hidden by default */
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5); /* Dimmed background */
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        #openModalBtn {
            background-color: tomato; /* background */
            color: white; /* White text */
            border: none; /* Remove border */
            padding: 10px 20px; /* Add padding */
            font-size: 24px; /* Adjust font size */
            border-radius: 5px; /* Rounded corners */
            cursor: pointer; /* Pointer cursor on hover */
            transition: background-color 0.3s ease; /* Smooth hover effect */
            width: 100%;
            margin-bottom: 20px; /* Add space after the button */
        }

        #openModalBtn:hover {
            background-color: rgb(255, 58, 23); /* Darker on hover */
        }
        /* Modal Content */
        .modal-content {
            background-color: #fff;
            padding: 20px;
            border-radius: 8px;
            max-width: 600px;
            width: 90%;
            text-align: center;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            overflow: auto;
        }

        /* Close Button */
        .close-btn {
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 20px;
            font-weight: bold;
            color: #aaa;
            cursor: pointer;
        }

        .close-btn:hover {
            color: #000;
        }
    </style>
<!-- Trigger Button --><button id="openModalBtn">Wanna subscribe?</button>


    <!-- Modal Structure -->
    <div id="subscriptionModal" class="modal">
        <div class="modal-content">
            <span class="close-btn">×</span>
            <!-- Mailchimp Signup Form -->
            <div>
                <div id="mc_embed_signup">
                    <form action="https://emrekaragul.us21.list-manage.com/subscribe/post?u=e72720e0214b2266cab41097e&amp;id=5cddb1a68e&amp;f_id=0038dfe1f0" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate="">
                        <div id="mc_embed_signup_scroll">
                            <h2 class="anchored">Submit your e-mail to subscribe!</h2>
                            <div class="mc-field-group">
                                <label for="mce-EMAIL">Email Address <span class="asterisk">*</span></label>
                                <input type="email" value="" name="EMAIL" class="required email" id="mce-EMAIL" required=""><span id="mce-EMAIL-HELPERTEXT" class="helper_text"></span>
                            </div>
                            <div id="mce-responses" class="clear foot">
                                <div class="response" id="mce-error-response" style="display:none"></div>
                                <div class="response" id="mce-success-response" style="display:none"></div>
                            </div>
                            
                            <div class="optionalParent">
                                <div class="clear foot">
                                    <input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button">
</div>
                            </div>
                        </div>
                    </form>
                </div>
                <script type="text/javascript" src="//s3.amazonaws.com/downloads.mailchimp.com/js/mc-validate.js"></script><script type="text/javascript">
                    (function($) {
                        window.fnames = new Array();
                        window.ftypes = new Array();
                        fnames[0] = 'EMAIL';
                        ftypes[0] = 'email';
                    }(jQuery));
                    var $mcj = jQuery.noConflict(true);
                </script><!--End mc_embed_signup-->
</div>
        </div>
    </div>

    <script>
        // Get the modal, button, and close elements
        const modal = document.getElementById("subscriptionModal");
        const openModalBtn = document.getElementById("openModalBtn");
        const closeBtn = document.querySelector(".close-btn");

        // Open the modal when the button is clicked
        openModalBtn.addEventListener("click", () => {
            modal.style.display = "flex"; // Show the modal
        });

        // Close the modal when the close button is clicked
        closeBtn.addEventListener("click", () => {
            modal.style.display = "none"; // Hide the modal
        });

        // Close the modal when clicking outside of it
        window.addEventListener("click", (e) => {
            if (e.target === modal) {
                modal.style.display = "none";
            }
        });
    </script><section id="introduction" class="level2"><h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>Can we use multidimensional IRT (mIRT) for exploratory factor detection? What is the relation between EFA and mIRT? In fact, EFA is designed to work with continuous observed variables. And, in many cases, researchers use likert type scales to measure psychological constructs. So, that kind of discrete data may not be so suitable for EFA. However, <a href="https://link.springer.com/article/10.1007/BF02294363" title="ON THE RELATIONSHIP BETWEEN ITEM RESPONSE THEORY AND FACTOR ANALYSIS OF DISCRETIZED VARIABLES">Takane &amp; Leeuw (1987)</a> put forward that there is a relationship between IRT and EFA. That’s why the answer to the question is: Yes, IRT can be used for factor detection, both confirmatory and exploratory.</p>
<p>Today, we will delve into the use of mIRT for exploratory factor analysis. The data we will use is the same as the one used in <a href="https://emrekaragul.com/posts/efaWithLikertData-1/">the previous post</a> called “Exploratory Factor Analysis with Likert Scale Data”. So, you can check the preprocessing section of that post to see how we filtered the data.</p>
<p>Also, in the previous post, we have a detailed discussion about the number of the factors that can be extracted from this data. That’s why we are going to skip scree plots, K1, and parallel analysis in this post. I suggest seeing the previous post for those issues.</p>
</section><section id="understand-the-data" class="level2"><h2 class="anchored" data-anchor-id="understand-the-data">Understand the data</h2>
<p>The following code is also provided in the previous post. It is used to load the data and filter the participants based on their demographics. Let’s just run the same code to get the data ready for the analysis. If you are coming from the previous post, this code is already run. So, you can skip this part.</p>
<div class="cell" data-code_folding="false">
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/utils/read.table.html">read.delim</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data.csv"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">df_with_demographics</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">engnat</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">hand</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">age</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">18</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">age</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">source</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">df</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">df_with_demographics</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">44</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">df</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">df</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Q21</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Q43</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
</div>
<p>Just to remember how the data is distributed, let’s see the summary and structure of the data. Remember that we have already discarded items 21 and 43 to avoid multicollinearity because they have high correlation with items 8 and 27 consecutively.</p>
<div class="cell" data-code_folding="false">
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">df</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span> ,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># run summary(df) to see all items.</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       Q1              Q2             Q3          Q4              Q5       
 Min.   :0.000   Min.   :0.00   Min.   :0   Min.   :0.000   Min.   :0.000  
 1st Qu.:1.000   1st Qu.:2.00   1st Qu.:1   1st Qu.:2.000   1st Qu.:1.000  
 Median :1.000   Median :5.00   Median :3   Median :4.000   Median :3.000  
 Mean   :2.023   Mean   :3.76   Mean   :3   Mean   :3.281   Mean   :2.972  
 3rd Qu.:3.000   3rd Qu.:5.00   3rd Qu.:5   3rd Qu.:5.000   3rd Qu.:4.000  
 Max.   :5.000   Max.   :5.00   Max.   :5   Max.   :5.000   Max.   :5.000  </code></pre>
</div>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">df</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span> ,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># run str(df) to see all items.</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   26334 obs. of  5 variables:
 $ Q1: int  1 1 1 1 1 1 1 1 1 1 ...
 $ Q2: int  4 1 4 1 5 1 5 5 3 5 ...
 $ Q3: int  1 4 5 5 1 1 5 1 5 5 ...
 $ Q4: int  5 4 1 4 5 5 5 5 5 5 ...
 $ Q5: int  2 5 4 5 1 5 5 1 2 4 ...</code></pre>
</div>
</div>
</section><section id="multidimensional-irt-model-building" class="level2 page-columns page-full"><h2 class="anchored" data-anchor-id="multidimensional-irt-model-building">Multidimensional IRT Model Building</h2>
<section id="initial-model" class="level3"><h3 class="anchored" data-anchor-id="initial-model">Initial Model</h3>
<p>In this post, we are going to build 2-factor model as all the previous analyses suggest that 2-factor model is the best fit for this data. The factors are defined as <em>Masculinity</em> and <em>Femininity</em> by the origibal authors of the scale.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Note on Item Selection">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note on Item Selection
</div>
</div>
<div class="callout-body-container callout-body">
<p>The item selection processes for both mIRT and EFA are described in the literature strictly, although subjectivity within the boundaries of these definitions may still exist. In other words, although most decisions will be the same, there may be some differences among psychometricians in terms of selecting/discarding an item. One psychometrician might select an item while another might not. And, both might have their logical reasons. The reasoning behind selecting/discarding items might depend on both statistics and knowledge of construct that is being assessed. Thus, although I am not an expert in gender roles, I wanted this post to be a personal experiment to check if I can extract the same factors and items as the original authors. So, <strong>I avoided checking the items in the original scale developed by the authors.</strong> See the documentation of the scale for the original items <a href="https://openpsychometrics.org/tests/OSRI/development/" title="documentation">here.</a></p>
</div>
</div>
<p>Let’s build the model with the <code>mirt</code> package.</p>
<div class="cell" data-code_folding="false">
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;"><a href="https://github.com/philchalmers/mirt">mirt</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model_1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/mirt/man/mirt.html">mirt</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">df</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, itemtype <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'graded'</span>, method <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'EM'</span>, verbose <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model_1</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
mirt(data = df, model = 2, itemtype = "graded", method = "EM", 
    verbose = FALSE)

Full-information item factor analysis with 2 factor(s).
Converged within 1e-04 tolerance after 236 EM iterations.
mirt version: 1.42 
M-step optimizer: BFGS 
EM acceleration: Ramsay 
Number of rectangular quadrature: 31
Latent density type: Gaussian 

Log-likelihood = -1590607
Estimated parameters: 293 
AIC = 3181800
BIC = 3184196; SABIC = 3183265
G2 (1e+10) = 2645146, p = 1
RMSEA = 0, CFI = NaN, TLI = NaN</code></pre>
</div>
</div>
<p>The `<code><a href="https://rdrr.io/pkg/mirt/man/mirt.html">mirt()</a></code> is a function built in the mirt package to build multidimensional IRT models. It takes a dataframe, number of factors, IRT model, method etc. In our model, we use the prominent Graded Response Model (GRM) that is suitable for Likert scale ordinal data. “EM”, which stands for “Expectation-Maximization”, is the default estimation method and suggested for models with less than 3 factors. The <code>verbose = FALSE</code> argument is used to suppress the output of the function after each iteration cycle.</p>
<p>With the <code><a href="https://rdrr.io/r/stats/coef.html">coef()</a></code> function of mirt package, we can get the item parameters such as discrimination and difficulty.</p>
<div class="cell" data-code_folding="false">
<div class="sourceCode" id="cb8" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">item_params</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model_1</span>, simplify <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">items</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">item_params</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># run print(item_params) to see all items.</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           a1          a2       d1         d2         d3          d4
Q1  0.5428696 -0.87427291 7.469361 -0.4101088 -0.9383750 -1.53030916
Q2 -1.3926877  0.10494528 7.617294  1.9428222  1.4265050  0.99922695
Q3  0.3767874 -1.84457406 8.098128  1.1101457  0.4213897 -0.18057288
Q4 -1.2437652 -0.22953251 6.872875  1.8390821  0.9332445  0.06892971
Q5  0.2059426 -0.98529256 6.896770  1.1428991  0.4112459 -0.30738685
Q6 -0.3865773  0.04663095 6.864864  2.3255300  1.4584706  0.64351628
            d5
Q1 -2.80068782
Q2  0.08154265
Q3 -1.33340228
Q4 -1.21175535
Q5 -1.40389522
Q6 -0.52337385</code></pre>
</div>
</div>
<p>In the case of factor analysis with MIRT, discrimination parameters are referred as the slope of the item characteristic surface (ICS). <code>a1</code> is the slope of the item on Factor 1, while <code>a2</code> is the slope of the item on Factor 2. Positive or negative values indicate the direction and strength of the relationship between the item and the respective factor.</p>
<p><code>d1</code>, <code>d2</code>, <code>d3</code>, <code>d4</code> and <code>d5</code> are the difficulty parameters of the items. They are also called as the threshold parameters. They represent the intercepts of the item for each category in the likert scale. Thresholds should increase monotonically (d1 &gt; d2 &gt; d3 &gt; …) for well-functioning items. Non-monotonic thresholds suggest problems with item performance. To detect these items, we can use the following function. It is expected to print the index of problematic items.</p>
<div class="cell" data-code_folding="false">
<div class="sourceCode" id="cb10" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">check_monotonic</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span>  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">d_columns</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"^d\\d+$"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span></span>
<span>  </span>
<span>  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">non_monotonic</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/logical.html">logical</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">d_columns</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span>  </span>
<span>  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">i</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/seq.html">seq_len</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">d_columns</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span>    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">non_monotonic</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">i</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/any.html">any</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/diff.html">diff</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">d_columns</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">i</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span>  <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span>  </span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">non_monotonic</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">check_monotonic</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">item_params</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>integer(0)</code></pre>
</div>
</div>
<p>The output is null, suggesting all the items have monotonic thresholds.</p>
<p>The <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code> function provides us with the factor loadings and the communalities (h2) of the variables. The default rotation method is oblimin. Therfore, we provide <code>rotate = "none"</code> in the function. Below the factor loadings, we can see the explained variance by each factor. The first factor explains %17.6 of the variance, while the second factor explains %10.8. Also, the correlation between the factors seems to be zero. Oblique rotations (e.g., oblimin) allow factors to be correlated, providing these estimates directly. As we set the rotation to none, the correlation between the factors is not calculated. Yet, we will get the correlation scores after we apply a rotation.</p>
<div class="cell" data-code_folding="false">
<div class="sourceCode" id="cb12" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model_1</span>, rotate <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Unrotated factor loadings: 

         F1        F2     h2
Q1   0.2729 -0.439568 0.2677
Q2  -0.6326  0.047666 0.4024
Q3   0.1485 -0.726795 0.5503
Q4  -0.5865 -0.108245 0.3558
Q5   0.1041 -0.498283 0.2591
Q6  -0.2214  0.026708 0.0497
Q7   0.2366 -0.400577 0.2164
Q8  -0.4228  0.126203 0.1947
Q9   0.3049 -0.576922 0.4258
Q10 -0.2790  0.051659 0.0805
Q11  0.1865 -0.215908 0.0814
Q12 -0.5260  0.171620 0.3061
Q13  0.4317 -0.091842 0.1948
Q14 -0.5978 -0.035233 0.3586
Q15  0.0794 -0.610298 0.3788
Q16 -0.6210  0.050615 0.3882
Q17  0.1866 -0.542158 0.3288
Q18 -0.3000 -0.082622 0.0968
Q19  0.4003 -0.276375 0.2366
Q20 -0.6201  0.163312 0.4112
Q22 -0.5505  0.050788 0.3056
Q23  0.0277 -0.341561 0.1174
Q24 -0.4089  0.102879 0.1778
Q25  0.3163 -0.396559 0.2573
Q26 -0.5752 -0.007970 0.3310
Q27  0.1348 -0.523084 0.2918
Q28 -0.5349  0.021320 0.2866
Q29  0.1100 -0.583130 0.3521
Q30 -0.5607  0.042580 0.3162
Q31  0.4048 -0.284227 0.2447
Q32 -0.3573  0.095665 0.1368
Q33  0.4155 -0.185081 0.2069
Q34 -0.5225  0.054848 0.2760
Q35  0.1540 -0.588756 0.3704
Q36 -0.5778  0.047455 0.3361
Q37  0.2797 -0.314347 0.1771
Q38 -0.6441 -0.015461 0.4151
Q39  0.1609 -0.744320 0.5799
Q40 -0.5856 -0.025633 0.3436
Q41  0.1618 -0.362005 0.1572
Q42 -0.5156 -0.000675 0.2659
Q44 -0.6280  0.000000 0.3943

SS loadings:  7.399 4.525 
Proportion Var:  0.176 0.108 

Factor correlations: 

   F1 F2
F1  1   
F2  0  1</code></pre>
</div>
</div>
<p>Before we apply a rotation, we need to check communalities to be over 0.30 just as it is in EFA. Communalities do not change after rotation, so we can discard the items with communalities below 0.30 at this stage. Here is the code to print the communalities below 0.3:</p>
<div class="cell" data-code_folding="false">
<div class="sourceCode" id="cb14" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">communalities</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>value <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model_1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">@</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Fit</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"h2"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">low_communalities</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">communalities</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">communalities</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">value</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>, , drop <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span></span>
<span></span>
<span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># print ordered by communality value:</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">low_communalities</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">low_communalities</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">value</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>, , drop <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         value
Q6  0.04973608
Q10 0.08049372
Q11 0.08140447
Q18 0.09683406
Q23 0.11743292
Q32 0.13679041
Q41 0.15723452
Q37 0.17705607
Q24 0.17778655
Q8  0.19465828
Q13 0.19482647
Q33 0.20685832
Q7  0.21643984
Q19 0.23662033
Q31 0.24466433
Q25 0.25733267
Q5  0.25913279
Q42 0.26588832
Q1  0.26771912
Q34 0.27603944
Q28 0.28656914
Q27 0.29178386</code></pre>
</div>
</div>
</section><section id="final-model" class="level3"><h3 class="anchored" data-anchor-id="final-model">Final Model</h3>
<p>Items with low communality values can be discarded from the dataset. To do that, run the following code:</p>
<div class="cell" data-code_folding="false">
<div class="sourceCode" id="cb16" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">discard_these_items</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">low_communalities</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">discard_these_items</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Q1"  "Q5"  "Q6"  "Q7"  "Q8"  "Q10" "Q11" "Q13" "Q18" "Q19" "Q23" "Q24"
[13] "Q25" "Q27" "Q28" "Q31" "Q32" "Q33" "Q34" "Q37" "Q41" "Q42"</code></pre>
</div>
<div class="sourceCode" id="cb18" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">df_final</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">df</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">discard_these_items</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
</div>
<p>Now, using the <code>df_final</code>, we can build our final solution:</p>
<div class="cell" data-code_folding="false">
<div class="sourceCode" id="cb19" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model_2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/mirt/man/mirt.html">mirt</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">df_final</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, itemtype <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'graded'</span>, method <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'EM'</span>, verbose <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model_2</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
mirt(data = df_final, model = 2, itemtype = "graded", method = "EM", 
    verbose = FALSE)

Full-information item factor analysis with 2 factor(s).
Converged within 1e-04 tolerance after 184 EM iterations.
mirt version: 1.42 
M-step optimizer: BFGS 
EM acceleration: Ramsay 
Number of rectangular quadrature: 31
Latent density type: Gaussian 

Log-likelihood = -752201.4
Estimated parameters: 139 
AIC = 1504681
BIC = 1505818; SABIC = 1505376
G2 (1e+10) = 968649.2, p = 1
RMSEA = 0, CFI = NaN, TLI = NaN</code></pre>
</div>
</div>
<p>Let’s see the factor loadings for the final solution. If we need to, we can apply a rotation later on:</p>
<div class="cell" data-code_folding="false">
<div class="sourceCode" id="cb21" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model_2</span>, rotate <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Unrotated factor loadings: 

        F1      F2    h2
Q2   0.605  0.0369 0.368
Q3  -0.148 -0.7520 0.587
Q4   0.575 -0.1099 0.343
Q9  -0.297 -0.5812 0.426
Q12  0.511  0.1587 0.286
Q14  0.634 -0.0172 0.402
Q15 -0.078 -0.5531 0.312
Q16  0.624  0.0593 0.393
Q17 -0.183 -0.5115 0.295
Q20  0.596  0.1708 0.385
Q22  0.541  0.0636 0.297
Q26  0.593  0.0153 0.351
Q29 -0.109 -0.6068 0.380
Q30  0.542  0.0504 0.296
Q35 -0.145 -0.5846 0.363
Q36  0.577  0.0392 0.334
Q38  0.651 -0.0059 0.424
Q39 -0.159 -0.7813 0.636
Q40  0.630 -0.0200 0.397
Q44  0.611  0.0000 0.374

SS loadings:  4.777 2.872 
Proportion Var:  0.239 0.144 

Factor correlations: 

   F1 F2
F1  1   
F2  0  1</code></pre>
</div>
</div>
<p>The factor loadings and communalities of the final solution looks fine. The explained variance by each factor is %23.9 and %14.4, respectively. This suggests an increase in the explained variance by the factors when compared to the initial model. Now, we can apply a rotation to see the correlation of the factors.</p>
<div class="cell" data-code_folding="false">
<div class="sourceCode" id="cb23" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model_2</span>, rotate <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"oblimin"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Rotation:  oblimin 

Rotated factor loadings: 

         F1       F2    h2
Q2   0.6020 -0.01689 0.368
Q3   0.0252  0.77249 0.587
Q4   0.6058  0.13388 0.343
Q9  -0.1646  0.59058 0.426
Q12  0.4781 -0.14616 0.286
Q14  0.6431  0.04007 0.402
Q15  0.0496  0.56925 0.312
Q16  0.6158 -0.03944 0.393
Q17 -0.0663  0.52252 0.295
Q20  0.5618 -0.15568 0.385
Q22  0.5310 -0.04682 0.297
Q26  0.5941  0.00498 0.351
Q29  0.0308  0.62368 0.380
Q30  0.5345 -0.03308 0.296
Q35 -0.0107  0.59951 0.363
Q36  0.5724 -0.02029 0.334
Q38  0.6576  0.02896 0.424
Q39  0.0204  0.80238 0.636
Q40  0.6397  0.04283 0.397
Q44  0.6164  0.02147 0.374

Rotated SS loadings:  4.572 3.009 

Factor correlations: 

       F1 F2
F1  1.000   
F2 -0.257  1</code></pre>
</div>
</div>
<p>The correlation between the factors is -0.26 after the rotation. This is a good result as it is not too high to suggest a single factor solution, nor too low to suggest a completely independent factor solution.</p>
</section><section id="model-fit" class="level3"><h3 class="anchored" data-anchor-id="model-fit">Model Fit</h3>
<p>To see model’s fit indices, we can use <code><a href="https://rdrr.io/pkg/mirt/man/M2.html">M2()</a></code> of mirt:</p>
<div class="cell" data-code_folding="false">
<div class="sourceCode" id="cb25" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/mirt/man/M2.html">M2</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model_2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            M2 df p      RMSEA    RMSEA_5   RMSEA_95      SRMSR      TLI
stats 5090.389 71 0 0.05181388 0.05061086 0.05302509 0.03886059 0.914146
            CFI
stats 0.9445851</code></pre>
</div>
</div>
<p>The model fit indices are suggesting a good model fit. RMSEA and SRMSR values are below 0.08 and TLI and CFI are above 0.90. These values are considered as good fit indices for a model.</p>
</section><section id="visualization" class="level3 page-columns page-full"><h3 class="anchored" data-anchor-id="visualization">Visualization</h3>
<p>The MIRT package provides with 3D plotting options. We can use the <code><a href="https://rdrr.io/r/graphics/plot.default.html">plot()</a></code> and <code><a href="https://rdrr.io/pkg/mirt/man/itemplot.html">itemplot()</a></code> functions to see the 3D plots of the model. We can also implement rotation to see the rotated model’s plot.</p>
<section id="expected-total-score-plot" class="level4"><h4 class="anchored" data-anchor-id="expected-total-score-plot">Expected Total Score Plot</h4>
<div class="sourceCode" id="cb27" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model_2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model_2</span>, rotate <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"oblimin"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell quarto-layout-panel" data-code_folding="false" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><a href="index_files/figure-html/unnamed-chunk-13-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Unrotated model"><img src="https://emrekaragul.com/posts/efaWithLikertData-2/index_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672" alt="Unrotated model"></a></p>
<figcaption>Unrotated model</figcaption></figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><a href="index_files/figure-html/unnamed-chunk-13-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Oblimin rotated model"><img src="https://emrekaragul.com/posts/efaWithLikertData-2/index_files/figure-html/unnamed-chunk-13-2.png" class="img-fluid figure-img" width="672" alt="Oblimin rotated model"></a></p>
<figcaption>Oblimin rotated model</figcaption></figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<p>Expected Total Score Plots</p>
</div>
</div>
</div>
</section><section id="item-trace-plots" class="level4"><h4 class="anchored" data-anchor-id="item-trace-plots">Item Trace Plots</h4>
<p>We can also check for item trace plots. Let’s see the first item’s trace plot for final model without rotation and with rotation:</p>
<div class="sourceCode" id="cb28" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/mirt/man/itemplot.html">itemplot</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model_2</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/mirt/man/itemplot.html">itemplot</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model_2</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, rotate <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"oblimin"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell quarto-layout-panel" data-code_folding="false" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><a href="index_files/figure-html/unnamed-chunk-14-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3" title="Unrotated model"><img src="https://emrekaragul.com/posts/efaWithLikertData-2/index_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672" alt="Unrotated model"></a></p>
<figcaption>Unrotated model</figcaption></figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><a href="index_files/figure-html/unnamed-chunk-14-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4" title="Oblimin rotated model"><img src="https://emrekaragul.com/posts/efaWithLikertData-2/index_files/figure-html/unnamed-chunk-14-2.png" class="img-fluid figure-img" width="672" alt="Oblimin rotated model"></a></p>
<figcaption>Oblimin rotated model</figcaption></figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<p>Item Trace Plots</p>
</div>
</div>
</div>
</section><section id="test-information" class="level4 page-columns page-full"><h4 class="anchored" data-anchor-id="test-information">Test Information</h4>
<p>We can also draw a plot to see the test information. Test information is a measure of the precision of the test at different levels of the latent traits. In multidimensional models we need to produce a contour plot.</p>
<p>We can plot the test information with the following code:</p>
<div class="cell page-columns page-full">
<div class="sourceCode" id="cb29" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model_2</span>, rotate <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"oblimin"</span> ,type<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"infocontour"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> </span></code></pre></div>

<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="index_files/figure-html/unnamed-chunk-15-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5"><img src="https://emrekaragul.com/posts/efaWithLikertData-2/index_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div></div></div>
<p>The test is most effective (provides the highest precision) in the central regions where test information is high (contour values like 6 or 7). Meaning the test is most effective for around 0 thetas of both factors. At the edges of the plot, the test is less precise (values like 1 or 2), meaning the test is less effective at distinguishing individuals with very high or very low abilities in those dimensions.</p>
</section></section><section id="selected-items-and-defining-factors" class="level3"><h3 class="anchored" data-anchor-id="selected-items-and-defining-factors">Selected Items and Defining Factors</h3>
<p>We are solid that our data has 2 factors, with each variable loading to a single factor. These factors were named as <strong>Femininity</strong> and <strong>Masculinity</strong> in the original scale.</p>
<p>These are the factors and their variables.</p>
<table class="table-striped table-hover caption-top table">
<caption>Factors and Items</caption>
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead><tr class="header">
<th>Femininity</th>
<th>Masculinity</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Q2 I have thought about dying my hair.</td>
<td>Q3 I have thrown knives, axes or other sharp things.</td>
</tr>
<tr class="even">
<td>Q4 I give people handmade gifts.</td>
<td>Q9 I like guns.</td>
</tr>
<tr class="odd">
<td>Q12 I use lotion on my hands.</td>
<td>Q15 I have thought it would be exciting to be an outlaw.</td>
</tr>
<tr class="even">
<td>Q14 I dance when I am alone.</td>
<td>Q17 I have considered joining the military.</td>
</tr>
<tr class="odd">
<td>Q16 When I was a child, I put on fake concerts and plays with my friends.</td>
<td>Q29 I have burned things up with a magnifying glass.</td>
</tr>
<tr class="even">
<td>Q20 I sometimes feel like crying when I get angry.</td>
<td>Q35 I have taken apart machines just to see how they work.</td>
</tr>
<tr class="odd">
<td>Q22 I save the letters I get.</td>
<td>Q39 I have set fuels, aerosols or other chemicals on fire, just for fun.</td>
</tr>
<tr class="even">
<td>Q26 I jump up and down in excitement sometimes.</td>
<td></td>
</tr>
<tr class="odd">
<td>Q30 I think horoscopes are fun.</td>
<td></td>
</tr>
<tr class="even">
<td>Q36 I take lots of pictures of my activities.</td>
<td></td>
</tr>
<tr class="odd">
<td>Q38 I leave nice notes for people now and then.</td>
<td></td>
</tr>
<tr class="even">
<td>Q40 I really like dancing.</td>
<td></td>
</tr>
<tr class="odd">
<td>Q44 I decorate my things (e.g.&nbsp;stickers on laptop).</td>
<td></td>
</tr>
</tbody>
</table></section><section id="factor-scores-of-persons" class="level3"><h3 class="anchored" data-anchor-id="factor-scores-of-persons">Factor scores of persons</h3>
<p>Finally, we can extract the factor scores of the persons. These scores can be used in further analyses such as regression, clustering, etc.</p>
<div class="cell" data-code_folding="false">
<div class="sourceCode" id="cb30" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/mirt/man/fscores.html">fscores</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model_2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## run fscores(model_2) to see all scores.</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             F1         F2
[1,]  1.9183653 -2.0882425
[2,] -0.5932079  0.4430873
[3,] -0.3261666  0.7950392
[4,] -1.4358888  0.6969259
[5,]  3.1571670 -2.2801150
[6,] -2.3165436  1.3256648</code></pre>
</div>
</div>
<p>As we did in EFA in the previous post, we can use these factor scores in a scree plot with genders of the participants. Let’s see the plot:</p>
<div class="cell" data-code_folding="false">
<div class="sourceCode" id="cb32" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">mirt_scores</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/mirt/man/fscores.html">fscores</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model_2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">mirt_scores</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Femininity"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Masculinity"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">scores</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">mirt_scores</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">scores</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://dplyr.tidyverse.org/reference/bind_cols.html">bind_cols</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">df_with_demographics</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">gender</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">scores</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">gender</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span>  </span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>gender <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">gender</span>, labels <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Male"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Female"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>  </span>
<span></span>
<span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot the filtered data</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">scores</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Femininity</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Masculinity</span>, color <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">gender</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>legend.position <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bottom"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>color <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Gender"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="index_files/figure-html/unnamed-chunk-17-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6"><img src="https://emrekaragul.com/posts/efaWithLikertData-2/index_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>In my opinion this plot’s being parallelogram-like is interesting. The same plot in EFA was more like a rectangle, although both distributions are similar.</p>
</section><section id="comparison-with-efa-model" class="level3"><h3 class="anchored" data-anchor-id="comparison-with-efa-model">Comparison with EFA Model</h3>
<p>It is also a good idea to check the correlation between the factor scores obtained from mIRT and EFA.</p>
<p>Let’s build the EFA model again:</p>
<div class="cell" data-code_folding="false">
<div class="sourceCode" id="cb33" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;"><a href="https://personality-project.org/r/psych/">psych</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">df_EFA</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">df</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span></span>
<span>  <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Q6</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Q11</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Q10</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Q18</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Q23</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Q32</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Q37</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Q41</span>, </span>
<span>  <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Q24</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Q8</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Q13</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Q33</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Q7</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Q19</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Q31</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Q42</span>, </span>
<span>  <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Q25</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Q34</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Q28</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Q5</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Q1</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Q12</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Q27</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Q30</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Q22</span></span>
<span>  <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span></span>
<span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">poly_matrix</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/psych/man/tetrachor.html">polychoric</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">df_EFA</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">rho</span></span>
<span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">two_fm</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/psych/man/fa.html">fa</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">poly_matrix</span>, nfactors <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, fm <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pa"</span>, rotate <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"oblimin"</span>, cor <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"poly"</span>, SMC<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
</div>
<p>Remember that although the items selected by EFA and IRT are very similar, they are not identical. We can compare the items selected by both methods:</p>
<div class="cell" data-code_folding="false">
<div class="sourceCode" id="cb34" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">mirt_items</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">df_final</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">efa_items</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">df_EFA</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">all_items</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">mirt_items</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">efa_items</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> </span>
<span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">comparison</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span></span>
<span>  mirt_items <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">all_items</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">mirt_items</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">all_items</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>,</span>
<span>  efa_items <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">all_items</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">efa_items</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">all_items</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">comparison</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   mirt_items efa_items
1          Q2        Q2
2          Q3        Q3
3          Q4        Q4
4          Q9        Q9
5         Q12          
6         Q14       Q14
7         Q15       Q15
8         Q16       Q16
9         Q17       Q17
10        Q20       Q20
11        Q22          
12        Q26       Q26
13        Q29       Q29
14        Q30          
15        Q35       Q35
16        Q36       Q36
17        Q38       Q38
18        Q39       Q39
19        Q40       Q40
20        Q44       Q44</code></pre>
</div>
</div>
<p>So items 12, 22, and 30 are selected by IRT model but they are not selected by EFA model.</p>
<p>Now let’s have a look at the correlation between factor scores obtained from mIRT and EFA models:</p>
<div class="cell" data-code_folding="false">
<div class="sourceCode" id="cb36" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">efa_scores</span>  <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/psych/man/factor.scores.html">factor.scores</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">df_EFA</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">two_fm</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">scores</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">efa_scores</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Femininity_efa"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Masculinity_efa"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">mirt_scores</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">efa_scores</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Femininity_efa Masculinity_efa
Femininity       0.9741479      -0.3107335
Masculinity     -0.3301980       0.9873525</code></pre>
</div>
</div>
<p>The participants’ scores obtained from MIRT and EFA models are highly correlated. The correlation between the femininity scores is 0.98, while the correlation between the masculinity scores is 0.99. This suggests that the factor scores obtained from both models are very similar.</p>
</section></section><section id="conclusion" class="level2"><h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<p>In this post, we worked on how to run multidimensional Item Response Theory based exploratory factor analysis on likert scale data. We used the <code>mirt</code> package in R to build the model. We also compared the factor scores obtained from the mIRT model with the factor scores obtained from the EFA model, which was discussed in my previous post. The results suggest that the factor scores from both models are highly correlated. Also, the mIRT model has shown great fit, even better than EFA model. These findings supports the opinion that as EFA is designed to work on continuous data, mIRT is a good alternative for factor detection in likert scale data.</p>
<section id="comparison-with-the-original-scale" class="level3"><h3 class="anchored" data-anchor-id="comparison-with-the-original-scale">Comparison with the Original Scale</h3>
<p>Both my EFA and mIRT models have similar items to the original scale. However, the scales are not identical. The original scale contains 10 items for each factor. The difference occurs because of the variation in our approaches in two ways:</p>
<ol type="1">
<li><p>I discarded two items because they are highly correlated with other two items, pointing to multicollinearity issues. It wasn’t done on the original scale. This might be because the authors might not have this issue in their original data. This difference probably resulted in the alternation in the item selection processes.</p></li>
<li><p>The preferred rotation method is different in the original scale. Although this shouldn’t make an effect on item selection for the factors, the participants’ factor scores might slightly alter. I used oblimin rotation while the original authors used varimax. The varimax is usually preferred when factors are independent of each other (no correlation between factors). The aim of varimax rotation is to maximize the variance of the squared loadings. Thus, it creates a simpler structure and encourages each variable to load strongly on one factor and weakly on others. Assuming the factors (Femininity and Masculinity) are independent of each other, the original authors might have used varimax rotation. In my personal opinion, these two factors could be considered as correlated negatively. That’s why I used oblimin rotation. Yet, as I mentioned before, I am not an expert on gender roles. So, I might be wrong in this assumption. In a real case study, I would definitely consult with an expert in the field to decide on the rotation method.</p></li>
</ol></section></section><section id="further-remarks" class="level2"><h2 class="anchored" data-anchor-id="further-remarks">Further Remarks</h2>
<ul>
<li>Running Confirmatory Factor Analysis (CFA) and mIRT for confirmatory factor detection is planned for a future post.</li>
</ul>


</section> ]]></description>
  <category>dplyr</category>
  <category>ggplot2</category>
  <category>mirt</category>
  <category>psych</category>
  <guid>https://emrekaragul.com/posts/efaWithLikertData-2/</guid>
  <pubDate>Tue, 19 Nov 2024 21:00:00 GMT</pubDate>
  <media:content url="https://emrekaragul.com/posts/efaWithLikertData-2/image.png" medium="image" type="image/png" height="144" width="144"/>
</item>
<item>
  <title>Exploratory Factor Analysis with Likert Scale Data</title>
  <dc:creator>Ali Emre Karagül</dc:creator>
  <link>https://emrekaragul.com/posts/efaWithLikertData-1/</link>
  <description><![CDATA[ <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mailchimp Subscription Modal</title>
<link href="//cdn-images.mailchimp.com/embedcode/classic-071822.css" rel="stylesheet" type="text/css">
<style>
        /* Modal Background */
        .modal {
            display: none; /* Hidden by default */
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5); /* Dimmed background */
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        #openModalBtn {
            background-color: tomato; /* background */
            color: white; /* White text */
            border: none; /* Remove border */
            padding: 10px 20px; /* Add padding */
            font-size: 24px; /* Adjust font size */
            border-radius: 5px; /* Rounded corners */
            cursor: pointer; /* Pointer cursor on hover */
            transition: background-color 0.3s ease; /* Smooth hover effect */
            width: 100%;
            margin-bottom: 20px; /* Add space after the button */
        }

        #openModalBtn:hover {
            background-color: rgb(255, 58, 23); /* Darker on hover */
        }
        /* Modal Content */
        .modal-content {
            background-color: #fff;
            padding: 20px;
            border-radius: 8px;
            max-width: 600px;
            width: 90%;
            text-align: center;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            overflow: auto;
        }

        /* Close Button */
        .close-btn {
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 20px;
            font-weight: bold;
            color: #aaa;
            cursor: pointer;
        }

        .close-btn:hover {
            color: #000;
        }
    </style>
<!-- Trigger Button --><button id="openModalBtn">Wanna subscribe?</button>


    <!-- Modal Structure -->
    <div id="subscriptionModal" class="modal">
        <div class="modal-content">
            <span class="close-btn">×</span>
            <!-- Mailchimp Signup Form -->
            <div>
                <div id="mc_embed_signup">
                    <form action="https://emrekaragul.us21.list-manage.com/subscribe/post?u=e72720e0214b2266cab41097e&amp;id=5cddb1a68e&amp;f_id=0038dfe1f0" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate="">
                        <div id="mc_embed_signup_scroll">
                            <h2 class="anchored">Submit your e-mail to subscribe!</h2>
                            <div class="mc-field-group">
                                <label for="mce-EMAIL">Email Address <span class="asterisk">*</span></label>
                                <input type="email" value="" name="EMAIL" class="required email" id="mce-EMAIL" required=""><span id="mce-EMAIL-HELPERTEXT" class="helper_text"></span>
                            </div>
                            <div id="mce-responses" class="clear foot">
                                <div class="response" id="mce-error-response" style="display:none"></div>
                                <div class="response" id="mce-success-response" style="display:none"></div>
                            </div>
                            
                            <div class="optionalParent">
                                <div class="clear foot">
                                    <input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button">
</div>
                            </div>
                        </div>
                    </form>
                </div>
                <script type="text/javascript" src="//s3.amazonaws.com/downloads.mailchimp.com/js/mc-validate.js"></script><script type="text/javascript">
                    (function($) {
                        window.fnames = new Array();
                        window.ftypes = new Array();
                        fnames[0] = 'EMAIL';
                        ftypes[0] = 'email';
                    }(jQuery));
                    var $mcj = jQuery.noConflict(true);
                </script><!--End mc_embed_signup-->
</div>
        </div>
    </div>

    <script>
        // Get the modal, button, and close elements
        const modal = document.getElementById("subscriptionModal");
        const openModalBtn = document.getElementById("openModalBtn");
        const closeBtn = document.querySelector(".close-btn");

        // Open the modal when the button is clicked
        openModalBtn.addEventListener("click", () => {
            modal.style.display = "flex"; // Show the modal
        });

        // Close the modal when the close button is clicked
        closeBtn.addEventListener("click", () => {
            modal.style.display = "none"; // Hide the modal
        });

        // Close the modal when clicking outside of it
        window.addEventListener("click", (e) => {
            if (e.target === modal) {
                modal.style.display = "none";
            }
        });
    </script><section id="introduction" class="level2"><h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>EFA is used to identify a potentially lower number of unobservable factors or constructs that can explain the patterns of correlations within a set of observed variables. This technique is widely used in the development of tests and measurements in psychological, educational, and social sciences research to ensure that the test measures what it’s supposed to measure.</p>
<p>In this post, we will build an EFA model using a Likert scale data obtained from <a href="https://openpsychometrics.org/_rawdata/" title="https://openpsychometrics.org/_rawdata/">Open Psychometrics</a>. Follow the link and find the zip file (OSRI44_dev_data.zip) containing data related to Open Sex Role Inventory. This is an interactive personality test measuring masculinity and femininity (or gendered personality traits) modeled on the Bem Sex-Role Inventory.</p>
<p>Likert scale data has multiple categories. Thus, it requires running the EFA with polychoric corelations. We will also utilize principle axis factoring. For the reliability of the scale, we will use ordinal Alpha coefficient suggested by <a href="https://digitalcommons.wayne.edu/jmasm/vol6/iss1/4/" title="ordinal alpha paper">Zumbo et al.&nbsp;(2007)</a>. All will be run using R. Unfortunately, software like SPSS do not provide an EFA with polychoric correlations or ordinal alpha coefficient. That’s why we have to use languages like R. Another alternative to SPSS in this regard is JASP (which is also built with R in terms of statistics) but it still doesn’t provide a way to calculate ordinal alpha.</p>
<p>Once you download the data, you will see two files in the folder: <code>codebook.txt</code> and <code>data.csv</code>. The first gives us information about the data, and the later contains the data itself. Move the <code>data.csv</code> to your working directory and run the following code to see the structure of the data.</p>
<div class="cell" data-code_folding="false">
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/utils/read.table.html">read.delim</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data.csv"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">40</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">57</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># run str(data) to see all items. we do not include the first 39 items here</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   318573 obs. of  18 variables:
 $ Q40        : int  4 3 4 3 1 3 2 3 2 4 ...
 $ Q41        : int  1 5 2 4 1 1 1 2 4 4 ...
 $ Q42        : int  5 5 1 1 3 5 4 4 5 5 ...
 $ Q43        : int  1 5 3 4 4 1 4 5 3 4 ...
 $ Q44        : int  5 3 3 3 3 5 1 5 4 4 ...
 $ introelapse: int  579 63 24 3 25 524 5 10 4 21 ...
 $ testelapse : int  211 242 265 231 274 189 213 485 236 263 ...
 $ country    : chr  "US" "PE" "CH" "US" ...
 $ IPC        : int  1 1 1 1 2 1 2 1 1 1 ...
 $ source     : int  1 0 0 1 1 0 1 0 1 1 ...
 $ engnat     : int  1 1 2 1 1 1 1 1 1 1 ...
 $ age        : int  18 19 18 19 16 20 16 17 32 22 ...
 $ education  : int  2 2 2 3 2 2 2 2 3 3 ...
 $ gender     : int  2 1 2 2 1 1 1 2 3 1 ...
 $ orientation: int  2 2 1 1 1 2 1 0 1 1 ...
 $ race       : int  6 6 1 6 6 6 6 1 1 6 ...
 $ religion   : int  1 1 1 2 2 1 2 2 1 1 ...
 $ hand       : int  1 2 1 1 1 1 1 1 1 1 ...</code></pre>
</div>
</div>
</section><section id="preprocessing" class="level2"><h2 class="anchored" data-anchor-id="preprocessing">Preprocessing</h2>
<p>There are 57 variables and the first 44 variables are actual data collected from the questionaire while the rest contains information about the test taker.</p>
<p>To see the number of test takers, run the following:</p>
<div class="cell" data-code_folding="false">
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 318573</code></pre>
</div>
</div>
<p>The number of observations is 318573, which I find a little exhausting for a demo analysis. So I will filter it to reduce the number. These are some of the demographics of the participants:</p>
<ul>
<li><p><code>engnat</code> ” Is English you native language?” 1=Yes, 2=No</p></li>
<li><p><code>age</code> “What is your age?”, entered as text (ages &lt; 13 not recorded)</p></li>
<li><p><code>education</code> “How much education have you completed?” 1=Less than high school, 2=High school, 3=University degree, 4=Graduate degree gender 1=Male, 2=Female, 3=Other</p></li>
<li><p><code>orientation</code> 1=Heterosexual, 2=Bisexual, 3=Homosexual, 4=Asexual, 5=Other</p></li>
<li><p><code>race</code> 1=Mixed race, 2=Asian, 3=Black, 4=Native American, 5=Native Australian, 6=White, 7=Other</p></li>
<li><p><code>religion</code> 1=Atheist/Agnostic, 2=Christian, 3=Muslim, 4=Jewish, 5=Hindu, 6=Buddhist, 7=Other</p></li>
<li><p><code>hand</code> “What hand do you use to write with?” 1=Right, 2=Left, 3=Both</p></li>
<li><p><code>source</code> how the user found the test, based on HTTP Referer info. 1=google, 2=tumblr, 3=facebook/messenger, 4=reddit, 5=bing, 0=other or unknown.</p></li>
</ul>
<p>Let’s filter participants whose native language is English, who are right-handed, between ages 18 and 40, and came from Google. Also, only keep the questionaire data as we are not interested in the others from now on. Finally see the summary of the data:</p>
<div class="cell" data-code_folding="false">
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">df_with_demographics</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">engnat</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">hand</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">age</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">18</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">age</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">source</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">df</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">df_with_demographics</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">44</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">df</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># run summary(df) to see all items.</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       Q1              Q2             Q3          Q4              Q5       
 Min.   :0.000   Min.   :0.00   Min.   :0   Min.   :0.000   Min.   :0.000  
 1st Qu.:1.000   1st Qu.:2.00   1st Qu.:1   1st Qu.:2.000   1st Qu.:1.000  
 Median :1.000   Median :5.00   Median :3   Median :4.000   Median :3.000  
 Mean   :2.023   Mean   :3.76   Mean   :3   Mean   :3.281   Mean   :2.972  
 3rd Qu.:3.000   3rd Qu.:5.00   3rd Qu.:5   3rd Qu.:5.000   3rd Qu.:4.000  
 Max.   :5.000   Max.   :5.00   Max.   :5   Max.   :5.000   Max.   :5.000  </code></pre>
</div>
</div>
</section><section id="model-assumptions" class="level2"><h2 class="anchored" data-anchor-id="model-assumptions">Model Assumptions</h2>
<p><a href="https://bookdown.org/luguben/EFA_in_R/some-assumptions-of-efa.html" title="EFA's assumptions">Some of EFA’s assumptions</a> are:</p>
<ul>
<li>
<strong>Continuous variables:</strong> In our case the data is in likert scale, thus descrete. For such data, IRT based factor reduction is much more appropriate, which we will discuss in a later post. Yet, in practice, researchers use EFA with likert-scale data too if the scale is large enough.</li>
<li>
<strong>No outliers:</strong> Outlier detection is another topic for another post. We will disregard this for now.</li>
<li>
<strong>No multicollinearity:</strong> This is an assumption we can check simply with a correlation matrix. Basically, EFA expects no observed variables with high correlation. If there are pairs with high correlation, there are suggestions such as dropping one of the pair or merging them into a single variable.</li>
<li>
<strong>Sampling Adequecy:</strong> We check if the data is adequate for EFA using Kaiser-Meyer-Olkin (KMO) test for each observed variable as well as the whole model. KMO values above .60 is considered acceptable, while closer to 1 means much better adequecy.</li>
<li>
<strong>Sphericity:</strong> An assumption that is usually tested with Bartlett’s Test of Sphericity. The assumption here is that the correlation matrix cannot be an identity matrix (also referred as unit matrix). An identity matrix is a diagonal matrix with all its diagonal elements equal to 1 , and zeroes everywhere else. Bartlett’s test tests the null hypothesis that the correlation matrix is an identity matrix. If the p-value is less than .05, we reject the null hypothesis and conclude that the correlation matrix is not an identity matrix, which means the data is suitable for EFA.</li>
</ul>
<p>In this post, we will test multicollinearity, KMO and Bartlett’s Test of Sphericity.</p>
<section id="multicollinearity" class="level3"><h3 class="anchored" data-anchor-id="multicollinearity">Multicollinearity</h3>
<p>Let’s see a correlation heatmap for multicollinearity.</p>
<div class="cell" data-code_folding="false">
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;"><a href="https://personality-project.org/r/psych/">psych</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;"><a href="https://plotly-r.com">plotly</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">poly_matrix</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/psych/man/tetrachor.html">polychoric</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">df</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">rho</span></span>
<span></span>
<span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create a long format of the correlation matrix</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">poly_long</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/table.html">as.table</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">poly_matrix</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Var1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Var2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span></span>
<span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create the Plotly heatmap</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/plotly/man/plot_ly.html">plot_ly</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span></span>
<span>  data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">poly_long</span>,</span>
<span>  x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Var2</span>,</span>
<span>  y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Var1</span>,</span>
<span>  z <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Freq</span>,</span>
<span>  text <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Freq</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>, </span>
<span>  type <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"heatmap"</span>,</span>
<span>  colorscale <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span></span>
<span>    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blue"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Minimum correlation (-1)</span></span>
<span>    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>, </span>
<span>    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Maximum correlation (1)</span></span>
<span>  <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>,</span>
<span>  zmin <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Set the minimum value of the color bar</span></span>
<span>  zmax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Set the maximum value of the color bar</span></span>
<span>  showscale <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span></span>
<span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">layout</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span></span>
<span>    xaxis <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>title <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Variables"</span>, tickangle <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">45</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>,</span>
<span>    yaxis <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>title <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Variables"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>,</span>
<span>    title <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Correlation Matrix"</span>,</span>
<span>    colorbar <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>title <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Correlation"</span>, tickvals <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Customize legend ticks</span></span>
<span>  <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-0054e5698dfd2531e1d3" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-0054e5698dfd2531e1d3">{"x":{"visdat":{"18e436cc4bac":["function () ","plotlyVisDat"]},"cur_data":"18e436cc4bac","attrs":{"18e436cc4bac":{"x":{},"y":{},"z":{},"text":{},"colorscale":[["0","blue"],["0.5","white"],["1","red"]],"zmin":-1,"zmax":1,"showscale":true,"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"heatmap"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"automargin":true,"title":"Variables","tickangle":45,"type":"category","categoryorder":"array","categoryarray":["Q1","Q2","Q3","Q4","Q5","Q6","Q7","Q8","Q9","Q10","Q11","Q12","Q13","Q14","Q15","Q16","Q17","Q18","Q19","Q20","Q21","Q22","Q23","Q24","Q25","Q26","Q27","Q28","Q29","Q30","Q31","Q32","Q33","Q34","Q35","Q36","Q37","Q38","Q39","Q40","Q41","Q42","Q43","Q44"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Variables","type":"category","categoryorder":"array","categoryarray":["Q1","Q2","Q3","Q4","Q5","Q6","Q7","Q8","Q9","Q10","Q11","Q12","Q13","Q14","Q15","Q16","Q17","Q18","Q19","Q20","Q21","Q22","Q23","Q24","Q25","Q26","Q27","Q28","Q29","Q30","Q31","Q32","Q33","Q34","Q35","Q36","Q37","Q38","Q39","Q40","Q41","Q42","Q43","Q44"]},"title":"Correlation Matrix","colorbar":{"title":"Correlation","tickvals":[-1,-0.5,0,0.5,1]},"scene":{"zaxis":{"title":"Freq"}},"hovermode":"closest","showlegend":false,"legend":{"yanchor":"top","y":0.5}},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"colorbar":{"title":"Freq","ticklen":2,"len":0.5,"lenmode":"fraction","y":1,"yanchor":"top"},"colorscale":[["0","blue"],["0.5","white"],["1","red"]],"showscale":true,"x":["Q1","Q2","Q2","Q3","Q3","Q3","Q4","Q4","Q4","Q4","Q5","Q5","Q5","Q5","Q5","Q6","Q6","Q6","Q6","Q6","Q6","Q7","Q7","Q7","Q7","Q7","Q7","Q7","Q8","Q8","Q8","Q8","Q8","Q8","Q8","Q8","Q9","Q9","Q9","Q9","Q9","Q9","Q9","Q9","Q9","Q10","Q10","Q10","Q10","Q10","Q10","Q10","Q10","Q10","Q10","Q11","Q11","Q11","Q11","Q11","Q11","Q11","Q11","Q11","Q11","Q11","Q12","Q12","Q12","Q12","Q12","Q12","Q12","Q12","Q12","Q12","Q12","Q12","Q13","Q13","Q13","Q13","Q13","Q13","Q13","Q13","Q13","Q13","Q13","Q13","Q13","Q14","Q14","Q14","Q14","Q14","Q14","Q14","Q14","Q14","Q14","Q14","Q14","Q14","Q14","Q15","Q15","Q15","Q15","Q15","Q15","Q15","Q15","Q15","Q15","Q15","Q15","Q15","Q15","Q15","Q16","Q16","Q16","Q16","Q16","Q16","Q16","Q16","Q16","Q16","Q16","Q16","Q16","Q16","Q16","Q16","Q17","Q17","Q17","Q17","Q17","Q17","Q17","Q17","Q17","Q17","Q17","Q17","Q17","Q17","Q17","Q17","Q17","Q18","Q18","Q18","Q18","Q18","Q18","Q18","Q18","Q18","Q18","Q18","Q18","Q18","Q18","Q18","Q18","Q18","Q18","Q19","Q19","Q19","Q19","Q19","Q19","Q19","Q19","Q19","Q19","Q19","Q19","Q19","Q19","Q19","Q19","Q19","Q19","Q19","Q20","Q20","Q20","Q20","Q20","Q20","Q20","Q20","Q20","Q20","Q20","Q20","Q20","Q20","Q20","Q20","Q20","Q20","Q20","Q20","Q21","Q21","Q21","Q21","Q21","Q21","Q21","Q21","Q21","Q21","Q21","Q21","Q21","Q21","Q21","Q21","Q21","Q21","Q21","Q21","Q21","Q22","Q22","Q22","Q22","Q22","Q22","Q22","Q22","Q22","Q22","Q22","Q22","Q22","Q22","Q22","Q22","Q22","Q22","Q22","Q22","Q22","Q22","Q23","Q23","Q23","Q23","Q23","Q23","Q23","Q23","Q23","Q23","Q23","Q23","Q23","Q23","Q23","Q23","Q23","Q23","Q23","Q23","Q23","Q23","Q23","Q24","Q24","Q24","Q24","Q24","Q24","Q24","Q24","Q24","Q24","Q24","Q24","Q24","Q24","Q24","Q24","Q24","Q24","Q24","Q24","Q24","Q24","Q24","Q24","Q25","Q25","Q25","Q25","Q25","Q25","Q25","Q25","Q25","Q25","Q25","Q25","Q25","Q25","Q25","Q25","Q25","Q25","Q25","Q25","Q25","Q25","Q25","Q25","Q25","Q26","Q26","Q26","Q26","Q26","Q26","Q26","Q26","Q26","Q26","Q26","Q26","Q26","Q26","Q26","Q26","Q26","Q26","Q26","Q26","Q26","Q26","Q26","Q26","Q26","Q26","Q27","Q27","Q27","Q27","Q27","Q27","Q27","Q27","Q27","Q27","Q27","Q27","Q27","Q27","Q27","Q27","Q27","Q27","Q27","Q27","Q27","Q27","Q27","Q27","Q27","Q27","Q27","Q28","Q28","Q28","Q28","Q28","Q28","Q28","Q28","Q28","Q28","Q28","Q28","Q28","Q28","Q28","Q28","Q28","Q28","Q28","Q28","Q28","Q28","Q28","Q28","Q28","Q28","Q28","Q28","Q29","Q29","Q29","Q29","Q29","Q29","Q29","Q29","Q29","Q29","Q29","Q29","Q29","Q29","Q29","Q29","Q29","Q29","Q29","Q29","Q29","Q29","Q29","Q29","Q29","Q29","Q29","Q29","Q29","Q30","Q30","Q30","Q30","Q30","Q30","Q30","Q30","Q30","Q30","Q30","Q30","Q30","Q30","Q30","Q30","Q30","Q30","Q30","Q30","Q30","Q30","Q30","Q30","Q30","Q30","Q30","Q30","Q30","Q30","Q31","Q31","Q31","Q31","Q31","Q31","Q31","Q31","Q31","Q31","Q31","Q31","Q31","Q31","Q31","Q31","Q31","Q31","Q31","Q31","Q31","Q31","Q31","Q31","Q31","Q31","Q31","Q31","Q31","Q31","Q31","Q32","Q32","Q32","Q32","Q32","Q32","Q32","Q32","Q32","Q32","Q32","Q32","Q32","Q32","Q32","Q32","Q32","Q32","Q32","Q32","Q32","Q32","Q32","Q32","Q32","Q32","Q32","Q32","Q32","Q32","Q32","Q32","Q33","Q33","Q33","Q33","Q33","Q33","Q33","Q33","Q33","Q33","Q33","Q33","Q33","Q33","Q33","Q33","Q33","Q33","Q33","Q33","Q33","Q33","Q33","Q33","Q33","Q33","Q33","Q33","Q33","Q33","Q33","Q33","Q33","Q34","Q34","Q34","Q34","Q34","Q34","Q34","Q34","Q34","Q34","Q34","Q34","Q34","Q34","Q34","Q34","Q34","Q34","Q34","Q34","Q34","Q34","Q34","Q34","Q34","Q34","Q34","Q34","Q34","Q34","Q34","Q34","Q34","Q34","Q35","Q35","Q35","Q35","Q35","Q35","Q35","Q35","Q35","Q35","Q35","Q35","Q35","Q35","Q35","Q35","Q35","Q35","Q35","Q35","Q35","Q35","Q35","Q35","Q35","Q35","Q35","Q35","Q35","Q35","Q35","Q35","Q35","Q35","Q35","Q36","Q36","Q36","Q36","Q36","Q36","Q36","Q36","Q36","Q36","Q36","Q36","Q36","Q36","Q36","Q36","Q36","Q36","Q36","Q36","Q36","Q36","Q36","Q36","Q36","Q36","Q36","Q36","Q36","Q36","Q36","Q36","Q36","Q36","Q36","Q36","Q37","Q37","Q37","Q37","Q37","Q37","Q37","Q37","Q37","Q37","Q37","Q37","Q37","Q37","Q37","Q37","Q37","Q37","Q37","Q37","Q37","Q37","Q37","Q37","Q37","Q37","Q37","Q37","Q37","Q37","Q37","Q37","Q37","Q37","Q37","Q37","Q37","Q38","Q38","Q38","Q38","Q38","Q38","Q38","Q38","Q38","Q38","Q38","Q38","Q38","Q38","Q38","Q38","Q38","Q38","Q38","Q38","Q38","Q38","Q38","Q38","Q38","Q38","Q38","Q38","Q38","Q38","Q38","Q38","Q38","Q38","Q38","Q38","Q38","Q38","Q39","Q39","Q39","Q39","Q39","Q39","Q39","Q39","Q39","Q39","Q39","Q39","Q39","Q39","Q39","Q39","Q39","Q39","Q39","Q39","Q39","Q39","Q39","Q39","Q39","Q39","Q39","Q39","Q39","Q39","Q39","Q39","Q39","Q39","Q39","Q39","Q39","Q39","Q39","Q40","Q40","Q40","Q40","Q40","Q40","Q40","Q40","Q40","Q40","Q40","Q40","Q40","Q40","Q40","Q40","Q40","Q40","Q40","Q40","Q40","Q40","Q40","Q40","Q40","Q40","Q40","Q40","Q40","Q40","Q40","Q40","Q40","Q40","Q40","Q40","Q40","Q40","Q40","Q40","Q41","Q41","Q41","Q41","Q41","Q41","Q41","Q41","Q41","Q41","Q41","Q41","Q41","Q41","Q41","Q41","Q41","Q41","Q41","Q41","Q41","Q41","Q41","Q41","Q41","Q41","Q41","Q41","Q41","Q41","Q41","Q41","Q41","Q41","Q41","Q41","Q41","Q41","Q41","Q41","Q41","Q42","Q42","Q42","Q42","Q42","Q42","Q42","Q42","Q42","Q42","Q42","Q42","Q42","Q42","Q42","Q42","Q42","Q42","Q42","Q42","Q42","Q42","Q42","Q42","Q42","Q42","Q42","Q42","Q42","Q42","Q42","Q42","Q42","Q42","Q42","Q42","Q42","Q42","Q42","Q42","Q42","Q42","Q43","Q43","Q43","Q43","Q43","Q43","Q43","Q43","Q43","Q43","Q43","Q43","Q43","Q43","Q43","Q43","Q43","Q43","Q43","Q43","Q43","Q43","Q43","Q43","Q43","Q43","Q43","Q43","Q43","Q43","Q43","Q43","Q43","Q43","Q43","Q43","Q43","Q43","Q43","Q43","Q43","Q43","Q43","Q44","Q44","Q44","Q44","Q44","Q44","Q44","Q44","Q44","Q44","Q44","Q44","Q44","Q44","Q44","Q44","Q44","Q44","Q44","Q44","Q44","Q44","Q44","Q44","Q44","Q44","Q44","Q44","Q44","Q44","Q44","Q44","Q44","Q44","Q44","Q44","Q44","Q44","Q44","Q44","Q44","Q44","Q44","Q44"],"y":["Q1","Q1","Q2","Q1","Q2","Q3","Q1","Q2","Q3","Q4","Q1","Q2","Q3","Q4","Q5","Q1","Q2","Q3","Q4","Q5","Q6","Q1","Q2","Q3","Q4","Q5","Q6","Q7","Q1","Q2","Q3","Q4","Q5","Q6","Q7","Q8","Q1","Q2","Q3","Q4","Q5","Q6","Q7","Q8","Q9","Q1","Q2","Q3","Q4","Q5","Q6","Q7","Q8","Q9","Q10","Q1","Q2","Q3","Q4","Q5","Q6","Q7","Q8","Q9","Q10","Q11","Q1","Q2","Q3","Q4","Q5","Q6","Q7","Q8","Q9","Q10","Q11","Q12","Q1","Q2","Q3","Q4","Q5","Q6","Q7","Q8","Q9","Q10","Q11","Q12","Q13","Q1","Q2","Q3","Q4","Q5","Q6","Q7","Q8","Q9","Q10","Q11","Q12","Q13","Q14","Q1","Q2","Q3","Q4","Q5","Q6","Q7","Q8","Q9","Q10","Q11","Q12","Q13","Q14","Q15","Q1","Q2","Q3","Q4","Q5","Q6","Q7","Q8","Q9","Q10","Q11","Q12","Q13","Q14","Q15","Q16","Q1","Q2","Q3","Q4","Q5","Q6","Q7","Q8","Q9","Q10","Q11","Q12","Q13","Q14","Q15","Q16","Q17","Q1","Q2","Q3","Q4","Q5","Q6","Q7","Q8","Q9","Q10","Q11","Q12","Q13","Q14","Q15","Q16","Q17","Q18","Q1","Q2","Q3","Q4","Q5","Q6","Q7","Q8","Q9","Q10","Q11","Q12","Q13","Q14","Q15","Q16","Q17","Q18","Q19","Q1","Q2","Q3","Q4","Q5","Q6","Q7","Q8","Q9","Q10","Q11","Q12","Q13","Q14","Q15","Q16","Q17","Q18","Q19","Q20","Q1","Q2","Q3","Q4","Q5","Q6","Q7","Q8","Q9","Q10","Q11","Q12","Q13","Q14","Q15","Q16","Q17","Q18","Q19","Q20","Q21","Q1","Q2","Q3","Q4","Q5","Q6","Q7","Q8","Q9","Q10","Q11","Q12","Q13","Q14","Q15","Q16","Q17","Q18","Q19","Q20","Q21","Q22","Q1","Q2","Q3","Q4","Q5","Q6","Q7","Q8","Q9","Q10","Q11","Q12","Q13","Q14","Q15","Q16","Q17","Q18","Q19","Q20","Q21","Q22","Q23","Q1","Q2","Q3","Q4","Q5","Q6","Q7","Q8","Q9","Q10","Q11","Q12","Q13","Q14","Q15","Q16","Q17","Q18","Q19","Q20","Q21","Q22","Q23","Q24","Q1","Q2","Q3","Q4","Q5","Q6","Q7","Q8","Q9","Q10","Q11","Q12","Q13","Q14","Q15","Q16","Q17","Q18","Q19","Q20","Q21","Q22","Q23","Q24","Q25","Q1","Q2","Q3","Q4","Q5","Q6","Q7","Q8","Q9","Q10","Q11","Q12","Q13","Q14","Q15","Q16","Q17","Q18","Q19","Q20","Q21","Q22","Q23","Q24","Q25","Q26","Q1","Q2","Q3","Q4","Q5","Q6","Q7","Q8","Q9","Q10","Q11","Q12","Q13","Q14","Q15","Q16","Q17","Q18","Q19","Q20","Q21","Q22","Q23","Q24","Q25","Q26","Q27","Q1","Q2","Q3","Q4","Q5","Q6","Q7","Q8","Q9","Q10","Q11","Q12","Q13","Q14","Q15","Q16","Q17","Q18","Q19","Q20","Q21","Q22","Q23","Q24","Q25","Q26","Q27","Q28","Q1","Q2","Q3","Q4","Q5","Q6","Q7","Q8","Q9","Q10","Q11","Q12","Q13","Q14","Q15","Q16","Q17","Q18","Q19","Q20","Q21","Q22","Q23","Q24","Q25","Q26","Q27","Q28","Q29","Q1","Q2","Q3","Q4","Q5","Q6","Q7","Q8","Q9","Q10","Q11","Q12","Q13","Q14","Q15","Q16","Q17","Q18","Q19","Q20","Q21","Q22","Q23","Q24","Q25","Q26","Q27","Q28","Q29","Q30","Q1","Q2","Q3","Q4","Q5","Q6","Q7","Q8","Q9","Q10","Q11","Q12","Q13","Q14","Q15","Q16","Q17","Q18","Q19","Q20","Q21","Q22","Q23","Q24","Q25","Q26","Q27","Q28","Q29","Q30","Q31","Q1","Q2","Q3","Q4","Q5","Q6","Q7","Q8","Q9","Q10","Q11","Q12","Q13","Q14","Q15","Q16","Q17","Q18","Q19","Q20","Q21","Q22","Q23","Q24","Q25","Q26","Q27","Q28","Q29","Q30","Q31","Q32","Q1","Q2","Q3","Q4","Q5","Q6","Q7","Q8","Q9","Q10","Q11","Q12","Q13","Q14","Q15","Q16","Q17","Q18","Q19","Q20","Q21","Q22","Q23","Q24","Q25","Q26","Q27","Q28","Q29","Q30","Q31","Q32","Q33","Q1","Q2","Q3","Q4","Q5","Q6","Q7","Q8","Q9","Q10","Q11","Q12","Q13","Q14","Q15","Q16","Q17","Q18","Q19","Q20","Q21","Q22","Q23","Q24","Q25","Q26","Q27","Q28","Q29","Q30","Q31","Q32","Q33","Q34","Q1","Q2","Q3","Q4","Q5","Q6","Q7","Q8","Q9","Q10","Q11","Q12","Q13","Q14","Q15","Q16","Q17","Q18","Q19","Q20","Q21","Q22","Q23","Q24","Q25","Q26","Q27","Q28","Q29","Q30","Q31","Q32","Q33","Q34","Q35","Q1","Q2","Q3","Q4","Q5","Q6","Q7","Q8","Q9","Q10","Q11","Q12","Q13","Q14","Q15","Q16","Q17","Q18","Q19","Q20","Q21","Q22","Q23","Q24","Q25","Q26","Q27","Q28","Q29","Q30","Q31","Q32","Q33","Q34","Q35","Q36","Q1","Q2","Q3","Q4","Q5","Q6","Q7","Q8","Q9","Q10","Q11","Q12","Q13","Q14","Q15","Q16","Q17","Q18","Q19","Q20","Q21","Q22","Q23","Q24","Q25","Q26","Q27","Q28","Q29","Q30","Q31","Q32","Q33","Q34","Q35","Q36","Q37","Q1","Q2","Q3","Q4","Q5","Q6","Q7","Q8","Q9","Q10","Q11","Q12","Q13","Q14","Q15","Q16","Q17","Q18","Q19","Q20","Q21","Q22","Q23","Q24","Q25","Q26","Q27","Q28","Q29","Q30","Q31","Q32","Q33","Q34","Q35","Q36","Q37","Q38","Q1","Q2","Q3","Q4","Q5","Q6","Q7","Q8","Q9","Q10","Q11","Q12","Q13","Q14","Q15","Q16","Q17","Q18","Q19","Q20","Q21","Q22","Q23","Q24","Q25","Q26","Q27","Q28","Q29","Q30","Q31","Q32","Q33","Q34","Q35","Q36","Q37","Q38","Q39","Q1","Q2","Q3","Q4","Q5","Q6","Q7","Q8","Q9","Q10","Q11","Q12","Q13","Q14","Q15","Q16","Q17","Q18","Q19","Q20","Q21","Q22","Q23","Q24","Q25","Q26","Q27","Q28","Q29","Q30","Q31","Q32","Q33","Q34","Q35","Q36","Q37","Q38","Q39","Q40","Q1","Q2","Q3","Q4","Q5","Q6","Q7","Q8","Q9","Q10","Q11","Q12","Q13","Q14","Q15","Q16","Q17","Q18","Q19","Q20","Q21","Q22","Q23","Q24","Q25","Q26","Q27","Q28","Q29","Q30","Q31","Q32","Q33","Q34","Q35","Q36","Q37","Q38","Q39","Q40","Q41","Q1","Q2","Q3","Q4","Q5","Q6","Q7","Q8","Q9","Q10","Q11","Q12","Q13","Q14","Q15","Q16","Q17","Q18","Q19","Q20","Q21","Q22","Q23","Q24","Q25","Q26","Q27","Q28","Q29","Q30","Q31","Q32","Q33","Q34","Q35","Q36","Q37","Q38","Q39","Q40","Q41","Q42","Q1","Q2","Q3","Q4","Q5","Q6","Q7","Q8","Q9","Q10","Q11","Q12","Q13","Q14","Q15","Q16","Q17","Q18","Q19","Q20","Q21","Q22","Q23","Q24","Q25","Q26","Q27","Q28","Q29","Q30","Q31","Q32","Q33","Q34","Q35","Q36","Q37","Q38","Q39","Q40","Q41","Q42","Q43","Q1","Q2","Q3","Q4","Q5","Q6","Q7","Q8","Q9","Q10","Q11","Q12","Q13","Q14","Q15","Q16","Q17","Q18","Q19","Q20","Q21","Q22","Q23","Q24","Q25","Q26","Q27","Q28","Q29","Q30","Q31","Q32","Q33","Q34","Q35","Q36","Q37","Q38","Q39","Q40","Q41","Q42","Q43","Q44"],"z":[1,-0.22645790681413402,1,0.3437384695868711,-0.093258235606642273,1,-0.12022938135127732,0.37303130608072954,0.02773987582371169,1,0.24957764338750171,-0.13530382496768556,0.35071429980898106,0.036741785177344326,1,-0.091915605139234455,0.189116126207511,-0.056699353526826028,0.11820507115571524,0.012797952633148812,1,0.23364544831936301,-0.23157473497214656,0.29470966154964923,-0.11395496681944085,0.27416076169972492,-0.036644606081133207,1,-0.16500442045139141,0.21695643331506431,-0.14725371305814552,0.23384604890614133,-0.095459574070496739,0.084421242683609676,-0.091613975395213126,1,0.29093596554833734,-0.24441154129514689,0.50749025115199708,-0.14530264870936288,0.28226621298609439,-0.10303527956496886,0.36961645317370717,-0.14721784303049074,1,-0.12281658774191206,0.26939510595168881,-0.082618328278941458,0.09417036948680188,-0.0935326547469153,0.22651988284968255,-0.063955555324802391,0.13210516092466451,-0.068326538852518534,1,0.14127432097381348,-0.075127178242920839,0.18787275627474809,-0.16824211512852169,0.085440193411562712,0.070681707363145788,0.1079052881320829,-0.16834671119133163,0.20056131535519084,0.076785523775342687,1,-0.2086452390196171,0.34114549330867616,-0.18647662637660431,0.25981783934427816,-0.14429912072070902,0.092838607165684608,-0.18745035592357687,0.27855704301246392,-0.19800734820291674,0.16076656459855918,-0.16502450271111488,1,0.28224353840144234,-0.3223076742603761,0.075297451189154693,-0.26718507287121201,0.074740632115940231,-0.071349637281546446,0.098726824244055239,-0.12207587440542557,0.16786108896956281,-0.12479617635839439,-0.035331222273475515,-0.21127328733645634,1,-0.13220523182777533,0.34427023266558626,-0.090199256955695029,0.26682762317610798,-0.045575837296088967,0.11514038328245339,-0.12667071071414857,0.20681160192527026,-0.1801801284180474,0.1178764312804569,-0.081988325304069298,0.31160006498653814,-0.208371105126374,1,0.29533607167550624,-0.0053664735661278339,0.4060920046749627,-0.0077002133948702832,0.37060559467102033,-0.02260046050281277,0.28642408779359935,-0.13903712162736689,0.36529916223685699,-0.016720255735923607,0.19926441626975808,-0.14574442376362379,0.015670518380316481,0.022589350125871602,1,-0.17752808385734817,0.39655792124673089,-0.13803131774369692,0.33866822882204273,-0.053122934491382598,0.068631616901382878,-0.1543541038082912,0.26932509779192187,-0.24146803290905666,0.12754492244608864,-0.17590118006319774,0.30932375309811627,-0.266725718558183,0.39360764176542629,-0.036894728222434219,1,0.24549832535101421,-0.12415294295894949,0.39094496241551713,-0.073241553638381751,0.33520914867684976,-0.072865706803895688,0.34694473552458033,-0.11917127414679282,0.49285212273767404,-0.065043856391166527,0.13991313773017519,-0.13290538907466926,0.12629873281947335,-0.097295964969155851,0.3506941307310012,-0.14219642201600527,1,-0.070076586841133201,0.22326381113873064,0.004931549014096385,0.15978624449622189,0.00055544954456876699,0.22405994743036067,-0.048820910909115486,0.084004948574490632,-0.054589872106011399,0.18597948224171429,0.020295072820686891,0.10811638790416943,-0.084136670949114145,0.15304323817169188,0.013787717941985921,0.16766760303122216,-0.011341474843832255,1,0.21915627974277288,-0.20180697758410662,0.23678271404643556,-0.18673294900977505,0.10797439874089079,-0.068827466990810549,0.15600820213211303,-0.21138416228955587,0.29364032219420844,-0.065286700355670441,0.16535906200484471,-0.22310132056196869,0.21860058726981169,-0.21373985168054799,0.24189645357948927,-0.2523109298385755,0.24097899683154173,-0.041296501570740572,1,-0.26272631316798295,0.440109126672936,-0.20660298782485736,0.31152356251251556,-0.13515015171480849,0.26066949264424094,-0.19683611218439148,0.26910703940835012,-0.25051386431826439,0.26832500893827388,-0.10257059415403491,0.3338256998358558,-0.26929787859405302,0.34004538743876478,-0.1315597986598383,0.37112174157241234,-0.16938590830541214,0.25620217647789795,-0.2995835129791784,1,0.16214974625766448,-0.13276397589099292,0.16908168063136014,-0.1662038993436773,0.1205720631308885,-0.014307297483725069,0.12641984360593697,-0.77072959090413973,0.14435672336407579,-0.068647571149549821,0.1824516966785987,-0.23002213118982698,0.097242597683053766,-0.14433479027426063,0.17779161687256104,-0.20033827239003058,0.13849235128134618,-0.02253988257510291,0.20860775022486841,-0.19307452699190489,1,-0.16736224065457594,0.25536565621619106,-0.12351969261795244,0.34788656061229656,-0.058484383678615776,0.13194015311955057,-0.1136092193120072,0.29296055758680156,-0.17503229025826161,0.11108022275769407,-0.14180365458300467,0.27566298597123617,-0.23468360678926595,0.279857961876675,-0.10078113673974781,0.30359792593652918,-0.11153865879765486,0.15466645493894698,-0.26417002053034039,0.32561199122126022,-0.22750260724296756,1,0.11208267386202635,0.010503187515419968,0.23095921638818132,-0.020639297876019608,0.15700347166796289,0.026226878357587753,0.16629341485709706,0.00032680989880561729,0.20810196515832777,0.063290415717099494,0.10314983135593783,-0.082820358507797481,0.043379633537158367,-0.00067396280957026733,0.27871459842154028,-0.013892601248472608,0.17687373137286264,0.066921060173626659,0.16620903779286861,-0.027540704801106118,0.053356858172220002,-0.029992847811051212,1,-0.22238144575712898,0.32280736182888953,-0.10924575808181079,0.20849474093702389,-0.081764738541107704,0.14222282150055154,-0.1020055194695063,0.20226810745358453,-0.21668380000438658,0.17381071463445327,-0.026168669177386455,0.19728164327564141,-0.2778009282750053,0.19530874973171458,-0.036934479664409457,0.24053452654253274,-0.13940456538120219,0.14595669602328848,-0.18976926104536487,0.27962503874433625,-0.1572238053595684,0.1937526583453146,-0.019041565416358427,1,0.2830751348467751,-0.33699024560029245,0.32391276529948371,-0.15061126135548153,0.27777649700742552,-0.19902631487289524,0.21657736676983555,-0.12421273942004407,0.32764521437519378,-0.21993834577278687,0.046700065348588754,-0.17867240386729538,0.206478217892546,-0.14636412619053149,0.2251259464853681,-0.20544625844048217,0.34364228860364493,-0.12801280210482743,0.20449239615355214,-0.33417765520512405,0.10980518675527874,-0.16155920946809293,0.11440086756174049,-0.14440573898814887,1,-0.12037906933489582,0.30719578527634839,-0.094675373934872645,0.27636875755203066,-0.027833973868267366,0.11206602839303675,-0.11809887564847694,0.21621640504919476,-0.15674436028038025,0.12070569822275788,-0.1069719758556411,0.25591382717340072,-0.17547652484316559,0.42036477814257855,-0.072435413422604608,0.34174411989368236,-0.12263553728790288,0.15155592925849706,-0.24791927877870443,0.36127492799044003,-0.15161549150867096,0.28610492409297617,-0.020439256117355288,0.16475636899849047,-0.13049863029137357,1,0.25062290418758715,-0.094538680130541244,0.32142640446590015,-0.046607897490814718,0.30541062366768201,-0.041617759927579094,0.20317562855435398,-0.14752559434474555,0.30494418389319483,-0.064245312485307252,0.14172701778846911,-0.17745548442897921,0.10275451358928925,-0.062937683725389812,0.43137643382786667,-0.086102628410022558,0.30847018345557553,0.035353094416604863,0.25141787472080435,-0.16738040630773832,0.1687856706058154,-0.10852613393094769,0.20156634636982332,-0.092199225449175318,0.23597279230465351,-0.054738206430147776,1,-0.13236824486822815,0.33803253539533573,-0.10222228103768115,0.30125139447546406,-0.082959725846817906,0.18062880813991039,-0.12550687713672024,0.18735627050254408,-0.17667830785478333,0.27177166299001759,-0.093426994302824473,0.27997446361109485,-0.16592550913727977,0.2919163770456859,-0.083937016301072837,0.30647801740502084,-0.13254454558668974,0.22883347544836288,-0.1813049278422737,0.34713720289429206,-0.11898160886902834,0.25806764886545497,-0.014974827444231681,0.18133437233696839,-0.20509465049411216,0.34778678124244417,-0.054797263536675918,1,0.27169572805035991,-0.09358601661101805,0.43235490432220325,0.023758816600982252,0.24963733402290045,-0.05662109144504588,0.18339019084581132,-0.12995781119431266,0.29293286840794819,-0.08037236299548263,0.11320299902913344,-0.16514972502756006,0.092503543593858789,-0.076789285256911921,0.29965106589398222,-0.078278537692734754,0.25672061889227371,0.035982164551743315,0.19238262862620878,-0.17319145927387053,0.1567089560829287,-0.10245537912922578,0.17995990173667795,-0.11189199998969525,0.24798298554912787,-0.074346662969253643,0.31058404897523662,-0.063422049802083019,1,-0.17811685365331428,0.41894004197490992,-0.10791102466496443,0.26840681002947214,-0.094460565284025647,0.14264165674013679,-0.14881207414588138,0.27393597541782821,-0.16683129603217731,0.22342113323494034,-0.051976933659166634,0.28528097099288141,-0.31681718862957386,0.31345767265033481,-0.0041686488651291008,0.32497861685107265,-0.093536632307390122,0.14551382843419144,-0.19498294550994302,0.37434915180515077,-0.20242661496185305,0.28085355406948503,-0.0022791517279890047,0.29404126336441266,-0.20583403793113431,0.27936018655729339,-0.05711785950371772,0.26999709367819075,-0.07655747887170003,1,0.23163136026783235,-0.26511005403334686,0.22534655736960377,-0.14885369706882659,0.19544184498665695,-0.057544223510666376,0.20838297018565358,-0.22486404618632533,0.18371886857434813,-0.14446892298106162,0.1618349067021724,-0.31855905674879087,0.1815801080405556,-0.21659022629941263,0.20948212893697249,-0.24495204635399076,0.18488719857313926,-0.073273442727550639,0.22790929672429422,-0.2778620394060406,0.22084917613486313,-0.23060222231876107,0.061498873522615884,-0.1451678276904744,0.22040847948001718,-0.21602355817242161,0.21171294224071407,-0.19914663179329051,0.21668869143384858,-0.22002974774764589,1,-0.10561950758090867,0.35356303699808972,-0.14757734013698093,0.20669153555900677,-0.078047982030571422,0.11993713403453909,-0.14059063512526546,0.068839195733185379,-0.34063195328046225,0.026915933087242473,-0.067739946919302255,0.1979165998358435,-0.16475622247851821,0.20821504228508597,-0.032558271807278959,0.23673166959450614,-0.11399881306972255,0.12559883392668197,-0.1946203098457068,0.22070543330792078,-0.040041157353676492,0.17481976509590108,-0.13623599895041269,0.31780547023445926,-0.16250636474756333,0.14681394480978632,-0.052574625742709394,0.15858093332799697,-0.070306386669991561,0.207923310078414,-0.040758916255602615,1,0.18338505953812881,-0.28242718635736386,0.16754527687745444,-0.15619561391619885,0.15401699648391676,-0.031036700363530352,0.16526906425898305,-0.20507691054738034,0.15110830946979539,-0.10055169877904731,0.075767639275769988,-0.29134767837214548,0.23559063254813481,-0.24163052990116024,0.1571135765878135,-0.22020061486244621,0.15640993790877025,-0.066759611752061646,0.21391441913284373,-0.24895499790425502,0.21367581294573285,-0.22145855239372478,0.050587118732029902,-0.12672476824740031,0.15278226618670684,-0.22790652640741549,0.16920264351752637,-0.17777904137492914,0.17040472659188188,-0.24611640211510652,0.38544858867340004,-0.062998115327869961,1,-0.14648755080416884,0.31703672394587717,-0.12360856796405846,0.3181745185994414,-0.07574620770904758,0.090115730792366566,-0.13892583942611761,0.18389522564543412,-0.22480219545878241,0.058947166861999932,-0.15046658359045834,0.28093677194700512,-0.24380647681010509,0.28888422009069292,-0.059634466454278098,0.34280750319641917,-0.11694274861711235,0.12077937173748739,-0.2298565142137344,0.30704204046221129,-0.13596282490209402,0.36641007270804604,-0.13176399787214019,0.17050956887392751,-0.16403808427164385,0.25933829948815446,-0.076415845098214044,0.22558841679720787,-0.079563701963822953,0.27810824041223398,-0.1493915287448136,0.3152380870891282,-0.14218120448544291,1,0.35564237546108851,-0.1538079275264739,0.42379861326621487,0.04489292083362785,0.27839259421162421,-0.031580010893110126,0.25209708800191027,-0.15866355612998215,0.31448127655057295,-0.086065275585444537,0.11828885544216904,-0.18013726063482111,0.23021090734490041,-0.093561529345330643,0.29835275262968214,-0.14921557434484239,0.2962479657243911,0.00028336971201465015,0.19321912337952876,-0.19799754357267471,0.1773110532110197,-0.092695868622985914,0.15158605740211434,-0.13201274932611493,0.25606493282300963,-0.076707778010197666,0.27123069015849971,-0.082195142150665673,0.40325703357198595,-0.17136565134974827,0.27190290904523651,-0.051991803706794175,0.21444542861897289,-0.058299232258017052,1,-0.17652776705653278,0.32097421505196705,-0.11655215186106108,0.32424841395965398,-0.11202748734034032,0.058203555090844912,-0.15863846303382145,0.31301228168692863,-0.13696556611301527,0.13938400912854326,-0.15785169520212761,0.30084085987584291,-0.24899575620930295,0.27531638750183773,-0.12674391536377363,0.34938251883885196,-0.12502844644306724,0.12603397283505721,-0.23109708512916446,0.31861019012440811,-0.25365208261100108,0.33921823237786908,-0.0031800580805377747,0.21709326916110749,-0.12539925418212156,0.31382679979196387,-0.089669616465791441,0.26759289355205962,-0.073124644459430774,0.29337833840825928,-0.32148914204654988,0.11504021600570362,-0.30948110116437055,0.28552332054363427,-0.095779292897552659,1,0.24056120139069492,-0.19861813748585047,0.28470428416822385,-0.19620035884956147,0.17066975982294608,0.0065688275350307143,0.24883752968178954,-0.182715983040247,0.28189561200088692,0.028650825841028977,0.25850067843158209,-0.23158494033484264,0.13613775805416289,-0.14468052392198782,0.1676200188107759,-0.28293701880471439,0.18361850420082637,-0.027623115961139123,0.15166804444109203,-0.17891779272271247,0.18373879127070714,-0.17334299997530442,0.15324565909852936,-0.096696731831040397,0.16079013819938412,-0.12567849445140739,0.12031713034024567,-0.11711438706217776,0.16519368224595821,-0.1322618499914392,0.21058999793921152,-0.18373191830541988,0.12414695103688742,-0.18233091838718765,0.29053543640534413,-0.18093649100892717,1,-0.13533594701107313,0.312009477546901,-0.092518817031689626,0.44607998759007111,-0.019016050185204265,0.06055151972406761,-0.13205366512898767,0.30885773676072414,-0.18776213625526492,0.094454205077832143,-0.17632500770500209,0.30556583870346848,-0.2340633831037689,0.31723650921555224,-0.097547888443842851,0.38718642968125133,-0.11298980014287625,0.13377225281019342,-0.27841318486203875,0.35818737710981252,-0.25152355047669039,0.43431907246437768,-0.061247660464069258,0.21611769835380457,-0.14640944332998482,0.37961892157214294,-0.10640775910568781,0.32921203395535342,-0.0720948912592205,0.29492298663608651,-0.19719750511172768,0.19923390445343156,-0.21741359568422167,0.3853785919380322,-0.045335976708814923,0.40325248922179996,-0.15226188295007442,1,0.34464589898453635,-0.12510205765174343,0.58838577489727373,-0.033642110021245522,0.30909053397030645,-0.077529069780106694,0.26802448578465854,-0.15784209780255279,0.44235182387123184,-0.085194488055702913,0.21497181722561032,-0.1999426047574529,0.1381942130620325,-0.10252926479955977,0.41213255623268269,-0.13242244127341576,0.36026317652165718,0.017020635554829529,0.24838149356766989,-0.23037859452883025,0.18715579236231261,-0.14093760164157312,0.25917581663532152,-0.13332478024478009,0.30962841983391393,-0.10689236201609051,0.38253665826066929,-0.10267380955829847,0.5464061806573326,-0.13539375252410688,0.24854214326007171,-0.097080479308782608,0.18949836470658879,-0.13747378500335472,0.49455267956317012,-0.10271765763194537,0.25675607952066282,-0.084863074447506875,1,-0.10952269179883091,0.32510221033993797,-0.090968349777768021,0.26541624632414773,-0.054837640487921002,0.015664980636589412,-0.14188598584201118,0.2143061591532123,-0.16830971488905619,0.049353760508270936,-0.12995859919982902,0.30782707910809703,-0.21086226182313458,0.68158011786998973,-0.019663235929618765,0.40007186144221679,-0.085352448363779337,0.09046474888692918,-0.22549031718864762,0.29147281288399057,-0.16015855514200675,0.26722243132826062,-0.03701446425438143,0.18315538189875194,-0.077994271144079266,0.41386672505175237,-0.07341913752900156,0.25725179849562257,-0.071081752570456611,0.30737005588088995,-0.22562629630480188,0.19340172861974558,-0.27681575303638623,0.28685536885214719,-0.10165064032203024,0.31635956733773213,-0.20361465517594388,0.34421241986521128,-0.076909618049760375,1,0.21704153038517038,-0.20451244132276264,0.25478713216105447,-0.072975547379905525,0.19466197191962434,-0.076462716705484657,0.12904389355700566,-0.11374631686102961,0.18325101051066134,-0.14145614139251736,0.067773545880372724,-0.1536053857755624,0.18842363547552723,-0.013099026138766109,0.17917688990859501,-0.10395789763039195,0.19520671960921215,0.043460509025904003,0.13513588614213548,-0.19725122124118818,0.12418940605037629,-0.069422315442385932,0.1418029021566985,-0.12926577635436931,0.34393849986702341,-0.021184145972813331,0.20874223460308028,-0.065300946548508515,0.24676458733520065,-0.16754018636754434,0.19388044246211827,-0.075567727163190851,0.13995042205079211,-0.098198470099657681,0.26252780163656536,-0.10162970486010722,0.1397023673179163,-0.075381250275910222,0.29502932469403431,0.0066602421453822195,1,-0.12308596590707112,0.30737824306647193,-0.076053182203364128,0.3519711741727119,-0.069256661030996924,0.14289074575658647,-0.11200974393302951,0.20363888273334457,-0.14041701113361485,0.1982690183355667,-0.094006042671042511,0.27902126528759558,-0.18581886292988556,0.25851938382410083,-0.077355043304514703,0.28035526224681834,-0.10149264148282605,0.14832981042389221,-0.16944630638859606,0.31638588215449598,-0.15004378153046763,0.24832804207288608,-0.042289113692685364,0.17209224116939359,-0.2022996962722873,0.26764208039396487,-0.077835919713312163,0.34986444087661239,-0.050129497713057442,0.25929157043407303,-0.18547620033558507,0.15470458440893578,-0.2031244601389558,0.20953165138218247,-0.022461756148478472,0.25278939038325421,-0.12335044967762757,0.32683948750873665,-0.063273625529964211,0.24039383333588141,-0.090105395891163204,1,0.25333116513491583,-0.094420122392045849,0.32996705999204751,-0.044799422300166522,0.30972785376753725,-0.03966782656747115,0.2094207584777866,-0.14436025499289845,0.31344492656283651,-0.062431794813898801,0.13589162053736276,-0.18234725506091484,0.10109465426352726,-0.065884806133408122,0.44217344437647393,-0.089998663072936136,0.31316989601009276,0.030697385874128673,0.25326973078799631,-0.17398062695068883,0.16571346231078293,-0.10941695226586998,0.20611923832814993,-0.094268151439651088,0.23183662785850664,-0.070947965560338971,0.96719325166876835,-0.062787309467597627,0.32053768699841639,-0.060069722046257622,0.21236371277123384,-0.053758250056006436,0.17512186133989271,-0.076105733866903433,0.28004406376518115,-0.093761651566014181,0.1220252480134232,-0.10622343715716417,0.3993889681144937,-0.073211640097368094,0.21911624353666923,-0.064777417908996424,1,-0.19425387567722011,0.40244208382240604,-0.077412979905788257,0.38130381336404878,-0.097607474336982344,0.13400367078533235,-0.13268742768742581,0.23104524332038126,-0.17340724343958633,0.17358445952768073,-0.08880272344401248,0.28147018075539121,-0.30510428067739992,0.29486063648584732,-0.062199242153421139,0.33012707438861971,-0.14890980235307166,0.16108272781228866,-0.24087325973499432,0.35388938922795393,-0.16472246593088993,0.32843119647408037,0.0088231818672113906,0.24613819459038405,-0.21174104445079409,0.32634663681213644,-0.07811903716267049,0.32315438856778744,-0.071347461315895588,0.32448011346514083,-0.25556786283702437,0.19463015497110336,-0.30156894533531353,0.29379767124306572,-0.066482030204020923,0.39941282722113253,-0.10353152379599041,0.39502348417089445,-0.078829051752846532,0.29007018982070365,-0.12751268630357826,0.33638115065418955,-0.067544869330694285,1],"text":[1,-0.23000000000000001,1,0.34000000000000002,-0.089999999999999997,1,-0.12,0.37,0.029999999999999999,1,0.25,-0.14000000000000001,0.34999999999999998,0.040000000000000001,1,-0.089999999999999997,0.19,-0.059999999999999998,0.12,0.01,1,0.23000000000000001,-0.23000000000000001,0.28999999999999998,-0.11,0.27000000000000002,-0.040000000000000001,1,-0.17000000000000001,0.22,-0.14999999999999999,0.23000000000000001,-0.10000000000000001,0.080000000000000002,-0.089999999999999997,1,0.28999999999999998,-0.23999999999999999,0.51000000000000001,-0.14999999999999999,0.28000000000000003,-0.10000000000000001,0.37,-0.14999999999999999,1,-0.12,0.27000000000000002,-0.080000000000000002,0.089999999999999997,-0.089999999999999997,0.23000000000000001,-0.059999999999999998,0.13,-0.070000000000000007,1,0.14000000000000001,-0.080000000000000002,0.19,-0.17000000000000001,0.089999999999999997,0.070000000000000007,0.11,-0.17000000000000001,0.20000000000000001,0.080000000000000002,1,-0.20999999999999999,0.34000000000000002,-0.19,0.26000000000000001,-0.14000000000000001,0.089999999999999997,-0.19,0.28000000000000003,-0.20000000000000001,0.16,-0.17000000000000001,1,0.28000000000000003,-0.32000000000000001,0.080000000000000002,-0.27000000000000002,0.070000000000000007,-0.070000000000000007,0.10000000000000001,-0.12,0.17000000000000001,-0.12,-0.040000000000000001,-0.20999999999999999,1,-0.13,0.34000000000000002,-0.089999999999999997,0.27000000000000002,-0.050000000000000003,0.12,-0.13,0.20999999999999999,-0.17999999999999999,0.12,-0.080000000000000002,0.31,-0.20999999999999999,1,0.29999999999999999,-0.01,0.40999999999999998,-0.01,0.37,-0.02,0.28999999999999998,-0.14000000000000001,0.37,-0.02,0.20000000000000001,-0.14999999999999999,0.02,0.02,1,-0.17999999999999999,0.40000000000000002,-0.14000000000000001,0.34000000000000002,-0.050000000000000003,0.070000000000000007,-0.14999999999999999,0.27000000000000002,-0.23999999999999999,0.13,-0.17999999999999999,0.31,-0.27000000000000002,0.39000000000000001,-0.040000000000000001,1,0.25,-0.12,0.39000000000000001,-0.070000000000000007,0.34000000000000002,-0.070000000000000007,0.34999999999999998,-0.12,0.48999999999999999,-0.070000000000000007,0.14000000000000001,-0.13,0.13,-0.10000000000000001,0.34999999999999998,-0.14000000000000001,1,-0.070000000000000007,0.22,0,0.16,0,0.22,-0.050000000000000003,0.080000000000000002,-0.050000000000000003,0.19,0.02,0.11,-0.080000000000000002,0.14999999999999999,0.01,0.17000000000000001,-0.01,1,0.22,-0.20000000000000001,0.23999999999999999,-0.19,0.11,-0.070000000000000007,0.16,-0.20999999999999999,0.28999999999999998,-0.070000000000000007,0.17000000000000001,-0.22,0.22,-0.20999999999999999,0.23999999999999999,-0.25,0.23999999999999999,-0.040000000000000001,1,-0.26000000000000001,0.44,-0.20999999999999999,0.31,-0.14000000000000001,0.26000000000000001,-0.20000000000000001,0.27000000000000002,-0.25,0.27000000000000002,-0.10000000000000001,0.33000000000000002,-0.27000000000000002,0.34000000000000002,-0.13,0.37,-0.17000000000000001,0.26000000000000001,-0.29999999999999999,1,0.16,-0.13,0.17000000000000001,-0.17000000000000001,0.12,-0.01,0.13,-0.77000000000000002,0.14000000000000001,-0.070000000000000007,0.17999999999999999,-0.23000000000000001,0.10000000000000001,-0.14000000000000001,0.17999999999999999,-0.20000000000000001,0.14000000000000001,-0.02,0.20999999999999999,-0.19,1,-0.17000000000000001,0.26000000000000001,-0.12,0.34999999999999998,-0.059999999999999998,0.13,-0.11,0.28999999999999998,-0.17999999999999999,0.11,-0.14000000000000001,0.28000000000000003,-0.23000000000000001,0.28000000000000003,-0.10000000000000001,0.29999999999999999,-0.11,0.14999999999999999,-0.26000000000000001,0.33000000000000002,-0.23000000000000001,1,0.11,0.01,0.23000000000000001,-0.02,0.16,0.029999999999999999,0.17000000000000001,0,0.20999999999999999,0.059999999999999998,0.10000000000000001,-0.080000000000000002,0.040000000000000001,-0,0.28000000000000003,-0.01,0.17999999999999999,0.070000000000000007,0.17000000000000001,-0.029999999999999999,0.050000000000000003,-0.029999999999999999,1,-0.22,0.32000000000000001,-0.11,0.20999999999999999,-0.080000000000000002,0.14000000000000001,-0.10000000000000001,0.20000000000000001,-0.22,0.17000000000000001,-0.029999999999999999,0.20000000000000001,-0.28000000000000003,0.20000000000000001,-0.040000000000000001,0.23999999999999999,-0.14000000000000001,0.14999999999999999,-0.19,0.28000000000000003,-0.16,0.19,-0.02,1,0.28000000000000003,-0.34000000000000002,0.32000000000000001,-0.14999999999999999,0.28000000000000003,-0.20000000000000001,0.22,-0.12,0.33000000000000002,-0.22,0.050000000000000003,-0.17999999999999999,0.20999999999999999,-0.14999999999999999,0.23000000000000001,-0.20999999999999999,0.34000000000000002,-0.13,0.20000000000000001,-0.33000000000000002,0.11,-0.16,0.11,-0.14000000000000001,1,-0.12,0.31,-0.089999999999999997,0.28000000000000003,-0.029999999999999999,0.11,-0.12,0.22,-0.16,0.12,-0.11,0.26000000000000001,-0.17999999999999999,0.41999999999999998,-0.070000000000000007,0.34000000000000002,-0.12,0.14999999999999999,-0.25,0.35999999999999999,-0.14999999999999999,0.28999999999999998,-0.02,0.16,-0.13,1,0.25,-0.089999999999999997,0.32000000000000001,-0.050000000000000003,0.31,-0.040000000000000001,0.20000000000000001,-0.14999999999999999,0.29999999999999999,-0.059999999999999998,0.14000000000000001,-0.17999999999999999,0.10000000000000001,-0.059999999999999998,0.42999999999999999,-0.089999999999999997,0.31,0.040000000000000001,0.25,-0.17000000000000001,0.17000000000000001,-0.11,0.20000000000000001,-0.089999999999999997,0.23999999999999999,-0.050000000000000003,1,-0.13,0.34000000000000002,-0.10000000000000001,0.29999999999999999,-0.080000000000000002,0.17999999999999999,-0.13,0.19,-0.17999999999999999,0.27000000000000002,-0.089999999999999997,0.28000000000000003,-0.17000000000000001,0.28999999999999998,-0.080000000000000002,0.31,-0.13,0.23000000000000001,-0.17999999999999999,0.34999999999999998,-0.12,0.26000000000000001,-0.01,0.17999999999999999,-0.20999999999999999,0.34999999999999998,-0.050000000000000003,1,0.27000000000000002,-0.089999999999999997,0.42999999999999999,0.02,0.25,-0.059999999999999998,0.17999999999999999,-0.13,0.28999999999999998,-0.080000000000000002,0.11,-0.17000000000000001,0.089999999999999997,-0.080000000000000002,0.29999999999999999,-0.080000000000000002,0.26000000000000001,0.040000000000000001,0.19,-0.17000000000000001,0.16,-0.10000000000000001,0.17999999999999999,-0.11,0.25,-0.070000000000000007,0.31,-0.059999999999999998,1,-0.17999999999999999,0.41999999999999998,-0.11,0.27000000000000002,-0.089999999999999997,0.14000000000000001,-0.14999999999999999,0.27000000000000002,-0.17000000000000001,0.22,-0.050000000000000003,0.28999999999999998,-0.32000000000000001,0.31,-0,0.32000000000000001,-0.089999999999999997,0.14999999999999999,-0.19,0.37,-0.20000000000000001,0.28000000000000003,-0,0.28999999999999998,-0.20999999999999999,0.28000000000000003,-0.059999999999999998,0.27000000000000002,-0.080000000000000002,1,0.23000000000000001,-0.27000000000000002,0.23000000000000001,-0.14999999999999999,0.20000000000000001,-0.059999999999999998,0.20999999999999999,-0.22,0.17999999999999999,-0.14000000000000001,0.16,-0.32000000000000001,0.17999999999999999,-0.22,0.20999999999999999,-0.23999999999999999,0.17999999999999999,-0.070000000000000007,0.23000000000000001,-0.28000000000000003,0.22,-0.23000000000000001,0.059999999999999998,-0.14999999999999999,0.22,-0.22,0.20999999999999999,-0.20000000000000001,0.22,-0.22,1,-0.11,0.34999999999999998,-0.14999999999999999,0.20999999999999999,-0.080000000000000002,0.12,-0.14000000000000001,0.070000000000000007,-0.34000000000000002,0.029999999999999999,-0.070000000000000007,0.20000000000000001,-0.16,0.20999999999999999,-0.029999999999999999,0.23999999999999999,-0.11,0.13,-0.19,0.22,-0.040000000000000001,0.17000000000000001,-0.14000000000000001,0.32000000000000001,-0.16,0.14999999999999999,-0.050000000000000003,0.16,-0.070000000000000007,0.20999999999999999,-0.040000000000000001,1,0.17999999999999999,-0.28000000000000003,0.17000000000000001,-0.16,0.14999999999999999,-0.029999999999999999,0.17000000000000001,-0.20999999999999999,0.14999999999999999,-0.10000000000000001,0.080000000000000002,-0.28999999999999998,0.23999999999999999,-0.23999999999999999,0.16,-0.22,0.16,-0.070000000000000007,0.20999999999999999,-0.25,0.20999999999999999,-0.22,0.050000000000000003,-0.13,0.14999999999999999,-0.23000000000000001,0.17000000000000001,-0.17999999999999999,0.17000000000000001,-0.25,0.39000000000000001,-0.059999999999999998,1,-0.14999999999999999,0.32000000000000001,-0.12,0.32000000000000001,-0.080000000000000002,0.089999999999999997,-0.14000000000000001,0.17999999999999999,-0.22,0.059999999999999998,-0.14999999999999999,0.28000000000000003,-0.23999999999999999,0.28999999999999998,-0.059999999999999998,0.34000000000000002,-0.12,0.12,-0.23000000000000001,0.31,-0.14000000000000001,0.37,-0.13,0.17000000000000001,-0.16,0.26000000000000001,-0.080000000000000002,0.23000000000000001,-0.080000000000000002,0.28000000000000003,-0.14999999999999999,0.32000000000000001,-0.14000000000000001,1,0.35999999999999999,-0.14999999999999999,0.41999999999999998,0.040000000000000001,0.28000000000000003,-0.029999999999999999,0.25,-0.16,0.31,-0.089999999999999997,0.12,-0.17999999999999999,0.23000000000000001,-0.089999999999999997,0.29999999999999999,-0.14999999999999999,0.29999999999999999,0,0.19,-0.20000000000000001,0.17999999999999999,-0.089999999999999997,0.14999999999999999,-0.13,0.26000000000000001,-0.080000000000000002,0.27000000000000002,-0.080000000000000002,0.40000000000000002,-0.17000000000000001,0.27000000000000002,-0.050000000000000003,0.20999999999999999,-0.059999999999999998,1,-0.17999999999999999,0.32000000000000001,-0.12,0.32000000000000001,-0.11,0.059999999999999998,-0.16,0.31,-0.14000000000000001,0.14000000000000001,-0.16,0.29999999999999999,-0.25,0.28000000000000003,-0.13,0.34999999999999998,-0.13,0.13,-0.23000000000000001,0.32000000000000001,-0.25,0.34000000000000002,-0,0.22,-0.13,0.31,-0.089999999999999997,0.27000000000000002,-0.070000000000000007,0.28999999999999998,-0.32000000000000001,0.12,-0.31,0.28999999999999998,-0.10000000000000001,1,0.23999999999999999,-0.20000000000000001,0.28000000000000003,-0.20000000000000001,0.17000000000000001,0.01,0.25,-0.17999999999999999,0.28000000000000003,0.029999999999999999,0.26000000000000001,-0.23000000000000001,0.14000000000000001,-0.14000000000000001,0.17000000000000001,-0.28000000000000003,0.17999999999999999,-0.029999999999999999,0.14999999999999999,-0.17999999999999999,0.17999999999999999,-0.17000000000000001,0.14999999999999999,-0.10000000000000001,0.16,-0.13,0.12,-0.12,0.17000000000000001,-0.13,0.20999999999999999,-0.17999999999999999,0.12,-0.17999999999999999,0.28999999999999998,-0.17999999999999999,1,-0.14000000000000001,0.31,-0.089999999999999997,0.45000000000000001,-0.02,0.059999999999999998,-0.13,0.31,-0.19,0.089999999999999997,-0.17999999999999999,0.31,-0.23000000000000001,0.32000000000000001,-0.10000000000000001,0.39000000000000001,-0.11,0.13,-0.28000000000000003,0.35999999999999999,-0.25,0.42999999999999999,-0.059999999999999998,0.22,-0.14999999999999999,0.38,-0.11,0.33000000000000002,-0.070000000000000007,0.28999999999999998,-0.20000000000000001,0.20000000000000001,-0.22,0.39000000000000001,-0.050000000000000003,0.40000000000000002,-0.14999999999999999,1,0.34000000000000002,-0.13,0.58999999999999997,-0.029999999999999999,0.31,-0.080000000000000002,0.27000000000000002,-0.16,0.44,-0.089999999999999997,0.20999999999999999,-0.20000000000000001,0.14000000000000001,-0.10000000000000001,0.40999999999999998,-0.13,0.35999999999999999,0.02,0.25,-0.23000000000000001,0.19,-0.14000000000000001,0.26000000000000001,-0.13,0.31,-0.11,0.38,-0.10000000000000001,0.55000000000000004,-0.14000000000000001,0.25,-0.10000000000000001,0.19,-0.14000000000000001,0.48999999999999999,-0.10000000000000001,0.26000000000000001,-0.080000000000000002,1,-0.11,0.33000000000000002,-0.089999999999999997,0.27000000000000002,-0.050000000000000003,0.02,-0.14000000000000001,0.20999999999999999,-0.17000000000000001,0.050000000000000003,-0.13,0.31,-0.20999999999999999,0.68000000000000005,-0.02,0.40000000000000002,-0.089999999999999997,0.089999999999999997,-0.23000000000000001,0.28999999999999998,-0.16,0.27000000000000002,-0.040000000000000001,0.17999999999999999,-0.080000000000000002,0.40999999999999998,-0.070000000000000007,0.26000000000000001,-0.070000000000000007,0.31,-0.23000000000000001,0.19,-0.28000000000000003,0.28999999999999998,-0.10000000000000001,0.32000000000000001,-0.20000000000000001,0.34000000000000002,-0.080000000000000002,1,0.22,-0.20000000000000001,0.25,-0.070000000000000007,0.19,-0.080000000000000002,0.13,-0.11,0.17999999999999999,-0.14000000000000001,0.070000000000000007,-0.14999999999999999,0.19,-0.01,0.17999999999999999,-0.10000000000000001,0.20000000000000001,0.040000000000000001,0.14000000000000001,-0.20000000000000001,0.12,-0.070000000000000007,0.14000000000000001,-0.13,0.34000000000000002,-0.02,0.20999999999999999,-0.070000000000000007,0.25,-0.17000000000000001,0.19,-0.080000000000000002,0.14000000000000001,-0.10000000000000001,0.26000000000000001,-0.10000000000000001,0.14000000000000001,-0.080000000000000002,0.29999999999999999,0.01,1,-0.12,0.31,-0.080000000000000002,0.34999999999999998,-0.070000000000000007,0.14000000000000001,-0.11,0.20000000000000001,-0.14000000000000001,0.20000000000000001,-0.089999999999999997,0.28000000000000003,-0.19,0.26000000000000001,-0.080000000000000002,0.28000000000000003,-0.10000000000000001,0.14999999999999999,-0.17000000000000001,0.32000000000000001,-0.14999999999999999,0.25,-0.040000000000000001,0.17000000000000001,-0.20000000000000001,0.27000000000000002,-0.080000000000000002,0.34999999999999998,-0.050000000000000003,0.26000000000000001,-0.19,0.14999999999999999,-0.20000000000000001,0.20999999999999999,-0.02,0.25,-0.12,0.33000000000000002,-0.059999999999999998,0.23999999999999999,-0.089999999999999997,1,0.25,-0.089999999999999997,0.33000000000000002,-0.040000000000000001,0.31,-0.040000000000000001,0.20999999999999999,-0.14000000000000001,0.31,-0.059999999999999998,0.14000000000000001,-0.17999999999999999,0.10000000000000001,-0.070000000000000007,0.44,-0.089999999999999997,0.31,0.029999999999999999,0.25,-0.17000000000000001,0.17000000000000001,-0.11,0.20999999999999999,-0.089999999999999997,0.23000000000000001,-0.070000000000000007,0.96999999999999997,-0.059999999999999998,0.32000000000000001,-0.059999999999999998,0.20999999999999999,-0.050000000000000003,0.17999999999999999,-0.080000000000000002,0.28000000000000003,-0.089999999999999997,0.12,-0.11,0.40000000000000002,-0.070000000000000007,0.22,-0.059999999999999998,1,-0.19,0.40000000000000002,-0.080000000000000002,0.38,-0.10000000000000001,0.13,-0.13,0.23000000000000001,-0.17000000000000001,0.17000000000000001,-0.089999999999999997,0.28000000000000003,-0.31,0.28999999999999998,-0.059999999999999998,0.33000000000000002,-0.14999999999999999,0.16,-0.23999999999999999,0.34999999999999998,-0.16,0.33000000000000002,0.01,0.25,-0.20999999999999999,0.33000000000000002,-0.080000000000000002,0.32000000000000001,-0.070000000000000007,0.32000000000000001,-0.26000000000000001,0.19,-0.29999999999999999,0.28999999999999998,-0.070000000000000007,0.40000000000000002,-0.10000000000000001,0.40000000000000002,-0.080000000000000002,0.28999999999999998,-0.13,0.34000000000000002,-0.070000000000000007,1],"zmin":-1,"zmax":1,"type":"heatmap","xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Items with high correlation are candidates for merging or dropping. There are two cells with colors dark red or dark blue in the heatmap. Q21 and Q8 have negative high correlation (.77) and Q43 and Q27 has positive high correlation (.97). We can consider dropping one variable from each pair. Let’s see the values of these cells:</p>
<div class="cell" data-code_folding="false">
<div class="sourceCode" id="cb8" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">poly_matrix</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">21</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.7707296</code></pre>
</div>
<div class="sourceCode" id="cb10" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">poly_matrix</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">27</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">43</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9671933</code></pre>
</div>
</div>
<p>Removing one of the variables from each pair is a common practice in EFA. We will drop Q21 and Q43. Then, create the polychoric matrix again.</p>
<div class="cell" data-code_folding="false">
<div class="sourceCode" id="cb12" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">df</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">df</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Q21</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Q43</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">poly_matrix</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/psych/man/tetrachor.html">polychoric</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">df</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">rho</span></span></code></pre></div>
</div>
</section><section id="sampling-adequacy-with-kmo" class="level3"><h3 class="anchored" data-anchor-id="sampling-adequacy-with-kmo">Sampling Adequacy with KMO</h3>
<p>Now, let’s check the sampling adequacy with KMO test. We expect each varianle’s KMO value to be above .60. Also, the overall KMO value should be be above .60 too.</p>
<div class="cell" data-code_folding="false">
<div class="sourceCode" id="cb13" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/psych/man/KMO.html">KMO</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">poly_matrix</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Kaiser-Meyer-Olkin factor adequacy
Call: KMO(r = poly_matrix)
Overall MSA =  0.93
MSA for each item = 
  Q1   Q2   Q3   Q4   Q5   Q6   Q7   Q8   Q9  Q10  Q11  Q12  Q13  Q14  Q15  Q16 
0.95 0.94 0.93 0.93 0.92 0.85 0.94 0.95 0.92 0.88 0.88 0.97 0.91 0.87 0.91 0.97 
 Q17  Q18  Q19  Q20  Q22  Q23  Q24  Q25  Q26  Q27  Q28  Q29  Q30  Q31  Q32  Q33 
0.92 0.90 0.96 0.97 0.96 0.88 0.93 0.93 0.96 0.93 0.95 0.92 0.96 0.95 0.86 0.94 
 Q34  Q35  Q36  Q37  Q38  Q39  Q40  Q41  Q42  Q44 
0.95 0.93 0.96 0.91 0.95 0.91 0.87 0.92 0.96 0.96 </code></pre>
</div>
</div>
</section><section id="sphericity-with-bartletts-test" class="level3"><h3 class="anchored" data-anchor-id="sphericity-with-bartletts-test">Sphericity with Bartlett’s Test</h3>
<p>Now, let’s check the sphericity with Bartlett’s Test. We expect the p-value to be less than .05.</p>
<div class="cell" data-code_folding="false">
<div class="sourceCode" id="cb15" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/psych/man/cortest.bartlett.html">cortest.bartlett</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">poly_matrix</span>, n <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">df</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$chisq
[1] 319501.8

$p.value
[1] 0

$df
[1] 861</code></pre>
</div>
</div>
<p>As, the assumptions we tested are fulfilled, we can continue with the</p>
</section></section><section id="determine-the-number-of-factors" class="level2"><h2 class="anchored" data-anchor-id="determine-the-number-of-factors">Determine the number of factors</h2>
<p>While determining the number of factors to extract, there are many methods that can be used. See a summary of them in Zwick et.al. (1986). Some of the most common methods are:</p>
<p><strong>1. Kaiser Criterion (K1):</strong> we can use the Kaiser criterion, which suggests retaining factors with eigenvalues greater than 1.</p>
<p><strong>2. Paralell Analysis:</strong> This is a simulation-based method that compares the observed eigenvalues with the eigenvalues obtained from random data. The factors with eigenvalues greater than the random data are retained in this approach.</p>
<p><strong>3. Very Simple Structure (VSS):</strong> VSS criterion evaluates how well a simplified factor pattern reproduces the original correlation matrix. In this simplified pattern, only the highest loading for each item is kept, while all other loadings are set to zero. The VSS score, ranging from 0 to 1, measures the goodness-of-fit of the factor solution. This evaluation is conducted for solutions with varying numbers of factors, starting from one (k = 1) up to a user-defined maximum. The optimal number of factors is determined by the solution with the highest VSS score.</p>
<p><strong>4. Minimum Average Partial (MAP):</strong> This method is based on partial correlations matrix. It is very similar to Principal Component Analysis (PCA).</p>
<p>In order to implement Kaiser Criterion, we simply run the following code.</p>
<div class="cell" data-code_folding="false">
<div class="sourceCode" id="cb17" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/psych/man/VSS.scree.html">scree</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">poly_matrix</span>, pc <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="index_files/figure-html/unnamed-chunk-9-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="https://emrekaragul.com/posts/efaWithLikertData-1/index_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>The produced plot suggests 2 or 3 factors. To be more certain, we can run the parallel analysis with the same scree plot with the following code:</p>
<div class="cell" data-code_folding="false">
<div class="sourceCode" id="cb18" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/psych/man/fa.parallel.html">fa.parallel</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span></span>
<span>  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">poly_matrix</span>, </span>
<span>  n.obs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">df</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>,</span>
<span>  fa <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fa"</span>, </span>
<span>  fm <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pa"</span>, </span>
<span>  cor <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"poly"</span>,</span>
<span>  n.iter <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>,</span>
<span>  show.legend <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span> </span>
<span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Parallel analysis suggests that the number of factors =  12  and the number of components =  NA </code></pre>
</div>
<div class="sourceCode" id="cb20" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>h <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, col <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"green"</span>, lty <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> </span>
<span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"topright"</span>, </span>
<span>       legend <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Actual Data"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"K1 Criterion"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Parallel analysis"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>, </span>
<span>       col <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blue"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"green"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>, </span>
<span>       lty <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>, </span>
<span>       pch <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">24</span>, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>, </span>
<span>       bty <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"n"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="index_files/figure-html/unnamed-chunk-10-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img src="https://emrekaragul.com/posts/efaWithLikertData-1/index_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>However, parallel analysis suggests 12 factors which is not reasonable. Let’s try VSS and MAP too. These can be obtained from <code>nfactor()</code> function of <code>psych</code> package.</p>
<div class="cell" data-code_folding="false">
<div class="sourceCode" id="cb21" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">vss_complexity</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/psych/man/VSS.html">nfactors</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">poly_matrix</span>, n.obs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">df</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>, fm <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pa"</span>, cor <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"poly"</span>, SMC<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="index_files/figure-html/unnamed-chunk-11-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img src="https://emrekaragul.com/posts/efaWithLikertData-1/index_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>The output actually speaks for itself. To better understand this, let’s have a look at the plots produced with the function. The plot on the upper left corner shows the VSS fit values with the number of factors. As can be seen 2 and 3 factors are very close and they are higher than 1 factor. This is in alignment with the K1 criterion.</p>
<p>The plot on the upper right corner shows the complexity of the construct with the number of factors. Complexity increases as the number of factors increase until 12 factors. We do not want to go with a high number of factors, so this plot also supports our decision to ignore parallel analysis too.</p>
<p>The plot on the lower left corner shows the Empirical BIC values with the number of factors. BIC value decreases highest from 1 to 2 factors. But from 2 to 3, the decrease is not so eye-catching.</p>
<p>As for the plot on the lower right corner, it shows the RMR values with the number of factors. RMRs below 0.10 is acceptable while below 0.08 is desirable. Any model that has more than 1 factor has RMR below 0.08 in the plot.</p>
<p>In conclusion, we can say that 2 or 3 factors are reasonable, while the first is a little more preferable. For our final decision, we can also check the variance explained by two models. If there is not much increase from 2-factor model to 3-factor model, we can go with 2 factors.</p>
<div class="cell" data-code_folding="false">
<div class="sourceCode" id="cb22" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">two_fm</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/psych/man/fa.html">fa</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">poly_matrix</span>, n.obs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">df</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>, nfactors <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, fm <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pa"</span>, rotate <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>, cor <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"poly"</span>, SMC<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">three_fm</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/psych/man/fa.html">fa</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">poly_matrix</span>, n.obs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">df</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>, nfactors <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, fm <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pa"</span>, rotate <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>, cor <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"poly"</span>, SMC<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#Explained Variance by 2-Factor Model:</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">two_fm</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Vaccounted</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                            PA1       PA2
SS loadings           8.1762800 3.2680913
Proportion Var        0.1946733 0.0778117
Cumulative Var        0.1946733 0.2724850
Proportion Explained  0.7144368 0.2855632
Cumulative Proportion 0.7144368 1.0000000</code></pre>
</div>
<div class="sourceCode" id="cb24" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#Explained Variance by 3-Factor Model:</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">three_fm</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Vaccounted</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                            PA1       PA2        PA3
SS loadings           8.1985977 3.2818970 1.08421360
Proportion Var        0.1952047 0.0781404 0.02581461
Cumulative Var        0.1952047 0.2733451 0.29915972
Proportion Explained  0.6525100 0.2611996 0.08629039
Cumulative Proportion 0.6525100 0.9137096 1.00000000</code></pre>
</div>
</div>
<p>The variance explained cumulatively by the 2-factor model is 0.27 while the 3-factor model explains 0.30. The increase is not so high, so we can go with the 2-factor model.</p>
</section><section id="rotation" class="level2"><h2 class="anchored" data-anchor-id="rotation">Rotation</h2>
<p>To see if we need to rotate, we can check the factor loadings. If the loadings are high and clear, we can go without rotation. Let’s see the loadings for the 2-factor model.</p>
<div class="cell" data-code_folding="false">
<div class="sourceCode" id="cb26" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">factor_loadings</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">two_fm</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">loadings</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">factor_loadings</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#use the following for all variables:  print(factor_loadings)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          PA1        PA2
Q1 -0.4532517 0.25125939
Q2  0.5952802 0.25000562
Q3 -0.4598388 0.55066466
Q4  0.4588183 0.35760922
Q5 -0.3225258 0.38951608
Q6  0.2084623 0.08448999</code></pre>
</div>
</div>
<p>The loadings are not so clear. Some of the observed variables load on both factors highly and equally such as Q3, Q4, Q5 etc. We can try to rotate the factors.</p>
<p>Rotation does not change the underlying solution but redistributes the variance to simplify the interpretation of factor loadings.</p>
<p>It is typically used when you expect that each variable primarily loads on one factor, and you want to make those relationships clearer.</p>
<p>Rotation is a technique used to simplify the factor structure. It is used to make the factors more interpretable. There are two types of rotation: orthogonal and oblique. Orthogonal rotation assumes that the factors are uncorrelated, while oblique rotation allows the factors to be correlated.</p>
<p>In contemporary research, oblique rotation is more commonly used, particularly in fields like psychology, sociology, and behavioral sciences, where correlated factors are expected. While orthogonal rotation is still used in cases where independence among factors is assumed or desired, the realistic nature of oblique rotations makes them the preferred choice for most exploratory factor analysis (EFA) applications.</p>
<p>There are many rotation methods such as varimax, promax, oblimin, and quartimin.</p>
<p>Let’s rotate the factors with oblimin:</p>
<div class="cell" data-code_folding="false">
<div class="sourceCode" id="cb28" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">two_fm</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/psych/man/fa.html">fa</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">poly_matrix</span>, n.obs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">df</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>, nfactors <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, fm <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pa"</span>, rotate <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"oblimin"</span>, cor <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"poly"</span>, SMC<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span></span>
<span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">factor_loadings_rotated</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">two_fm</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">loadings</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">factor_loadings_rotated</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           PA1         PA2
Q1 -0.16698240  0.44127564
Q2  0.63696320 -0.02629649
Q3  0.04356274  0.72980540
Q4  0.60970090  0.13704242
Q5  0.03292070  0.51501188
Q6  0.22085587 -0.01212766</code></pre>
</div>
</div>
<p>The loadings are now more clear. Also, we can see that some of the variables load neither of the variables. This is a common situation in EFA. This also explains why a 3-factor model is also strong. Yet, we prefer 2-factor model so We can drop these variables one by one and re-run the analysis. To determine with which item to start, we can check the communalities of the variables.</p>
<div class="cell" data-code_folding="false">
<div class="sourceCode" id="cb30" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">factor_1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">two_fm</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">loadings</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"PA1"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">factor_2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">two_fm</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">loadings</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"PA2"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">communalities</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">two_fm</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">communality</span></span>
<span></span>
<span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># merge as a table</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">loadings</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span></span>
<span>  factor_1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">factor_1</span>,</span>
<span>  factor_2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">factor_2</span>,</span>
<span>  communalities <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">communalities</span></span>
<span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">loadings</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">loadings</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">loadings</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">communalities</span>, decreasing <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">loadings</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># use print(loadings) to see all variables</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       factor_1    factor_2 communalities
Q6   0.22085587 -0.01212766    0.05059508
Q11 -0.12298253  0.21681114    0.07876337
Q10  0.27005620 -0.03300168    0.07957850
Q18  0.32004233  0.10727368    0.09252015
Q23  0.07002200  0.35815591    0.11753590
Q32  0.33746578 -0.07831434    0.13650095
Q41 -0.06846225  0.37184011    0.15883090
Q37 -0.19601538  0.30838271    0.17122609
Q24  0.38433571 -0.07601277    0.17171431
Q8   0.38663998 -0.10503405    0.18585326</code></pre>
</div>
</div>
<section id="final-solution" class="level3"><h3 class="anchored" data-anchor-id="final-solution">Final Solution</h3>
<p>In EFA, we do not want communalities lower than .30. Also loadings lower than .30 are not considered as strong. Preferably, loadings above .40 are considered strong.</p>
<p>Dropping variables is an iterative practice. You need to drop one variable, re-run the analysis, check the loadings and communalities, and decide if you need to drop another variable. This process continues until all variables have strong loadings and communalities. Thus, I will report only the final solution here.</p>
<p>Following line of code will drop all the unwanted variables, and then re-run the 2-factor model with oblimin rotation:</p>
<div class="cell" data-code_folding="false">
<div class="sourceCode" id="cb32" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">df</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">df</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span></span>
<span>  <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Q6</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Q11</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Q10</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Q18</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Q23</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Q32</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Q37</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Q41</span>, </span>
<span>  <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Q24</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Q8</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Q13</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Q33</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Q7</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Q19</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Q31</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Q42</span>, </span>
<span>  <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Q25</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Q34</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Q28</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Q5</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Q1</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Q12</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Q27</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Q30</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Q22</span></span>
<span>  <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span></span>
<span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">poly_matrix</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/psych/man/tetrachor.html">polychoric</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">df</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">rho</span></span>
<span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">two_fm</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/psych/man/fa.html">fa</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">poly_matrix</span>, nfactors <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, fm <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pa"</span>, rotate <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"oblimin"</span>, cor <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"poly"</span>, SMC<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#Factor Loadings:</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">two_fm</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">loadings</span>, cutoff <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Loadings:
    PA1    PA2   
Q2   0.592       
Q3          0.756
Q4   0.585       
Q9          0.587
Q14  0.638       
Q15         0.558
Q16  0.610       
Q17         0.523
Q20  0.544       
Q26  0.582       
Q29         0.600
Q35         0.589
Q36  0.547       
Q38  0.626       
Q39         0.788
Q40  0.637       
Q44  0.589       

                 PA1   PA2
SS loadings    3.587 2.878
Proportion Var 0.211 0.169
Cumulative Var 0.211 0.380</code></pre>
</div>
<div class="sourceCode" id="cb34" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Communalities:</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">two_fm</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">communality</span>, cutoff <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       Q2        Q3        Q4        Q9       Q14       Q15       Q16       Q17 
0.3615579 0.5625665 0.3221763 0.4227183 0.3981835 0.3002707 0.3874601 0.2982325 
      Q20       Q26       Q29       Q35       Q36       Q38       Q39       Q40 
0.3665253 0.3399021 0.3515497 0.3474944 0.3071188 0.3870429 0.6124040 0.3960493 
      Q44 
0.3446296 </code></pre>
</div>
</div>
<p>With this, our explained cumulative variance has risen to 38%. Let’s see factor correlations and the reliability score of the scale:</p>
<div class="cell" data-code_folding="false">
<div class="sourceCode" id="cb36" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#Factor Correlations:</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">two_fm</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Phi</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      PA1   PA2
PA1  1.00 -0.24
PA2 -0.24  1.00</code></pre>
</div>
<div class="sourceCode" id="cb38" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">reliability_coef</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">psych</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/psych/man/alpha.html">alpha</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">poly_matrix</span>, check.keys<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#Ordinal Alpha:</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">reliability_coef</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"total"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"raw_alpha"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.84</code></pre>
</div>
</div>
<p>Correlation between factors is -0.24, which indicates a very low and negative correlation. The ordinal alpha coefficient is 0.84 which is considered as good. The 2-factor model with oblimin rotation is our final solution. Finally let’s draw the path diagram of the model:</p>
<div class="cell" data-code_folding="false">
<div class="sourceCode" id="cb40" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/psych/man/fa.diagram.html">fa.diagram</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span></span>
<span>  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">two_fm</span>, </span>
<span>  digits <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,</span>
<span>  main <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Final Solution for Open Sex Role Inventory"</span>,</span>
<span>  e.size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.07</span>,</span>
<span>  rsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.1</span>,</span>
<span>  cex<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.9</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="index_files/figure-html/unnamed-chunk-18-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4"><img src="https://emrekaragul.com/posts/efaWithLikertData-1/index_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>The final solution has 10 items in the first factor and 7 items in the second factor. Here are the items in each factor:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead><tr class="header">
<th>Factor 1</th>
<th>Factor 2</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Q2 I have thought about dying my hair.</td>
<td>Q3 I have thrown knives, axes or other sharp things.</td>
</tr>
<tr class="even">
<td>Q4 I give people handmade gifts.</td>
<td>Q9 I like guns.</td>
</tr>
<tr class="odd">
<td>Q14 I dance when I am alone.</td>
<td>Q15 I have thought it would be exciting to be an outlaw.</td>
</tr>
<tr class="even">
<td>Q16 When I was a child, I put on fake concerts and plays with my friends.</td>
<td>Q17 I have considered joining the military.</td>
</tr>
<tr class="odd">
<td>Q20 I sometimes feel like crying when I get angry.</td>
<td>Q29 I have burned things up with a magnifying glass.</td>
</tr>
<tr class="even">
<td>Q26 I jump up and down in excitement sometimes.</td>
<td>Q35 I have taken apart machines just to see how they work.</td>
</tr>
<tr class="odd">
<td>Q36 I take lots of pictures of my activities.</td>
<td>Q39 I have set fuels, aerosols or other chemicals on fire, just for fun.</td>
</tr>
<tr class="even">
<td>Q38 I leave nice notes for people now and then.</td>
<td></td>
</tr>
<tr class="odd">
<td>Q40 I really like dancing.</td>
<td></td>
</tr>
<tr class="even">
<td>Q44 I decorate my things (e.g.&nbsp;stickers on laptop).</td>
<td></td>
</tr>
</tbody>
</table>
<p>It is pretty easy now to interpret the factors given that this is a scale named as Open Sex Role Inventory. The first factor seems to be related to femininity while the second factor seems to be related to masculinity.</p>
<p>As a final touch, let’s see the scree plot of the genders of the participants along with their scores on the two factors; <strong>masculinity</strong> and <strong>femininity</strong>. We will use <code><a href="https://rdrr.io/pkg/psych/man/factor.scores.html">factor.scores()</a></code> to calculate participants’ scores and the <code>ggplot2</code> package for visualization:</p>
<div class="cell" data-code_folding="false">
<div class="sourceCode" id="cb41" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">OSRI_scores</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/psych/man/factor.scores.html">factor.scores</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">df</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">two_fm</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">scores</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">OSRI_scores</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Femininity"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Masculinity"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">scores</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">OSRI_scores</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">scores</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://dplyr.tidyverse.org/reference/bind_cols.html">bind_cols</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">df_with_demographics</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">gender</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">scores</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">gender</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span>  </span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>gender <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">gender</span>, labels <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Male"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Female"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>  </span>
<span></span>
<span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot the filtered data</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">scores</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Femininity</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Masculinity</span>, color <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">gender</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>legend.position <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bottom"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>color <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Gender"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="index_files/figure-html/unnamed-chunk-19-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5"><img src="https://emrekaragul.com/posts/efaWithLikertData-1/index_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section></section><section id="conclusion" class="level2"><h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<p>In this post, we have seen how to conduct an EFA with polychoric correlations and ordinal alpha coefficient. We have also seen how to check the assumptions of EFA, determine the number of factors, and rotate the factors. We have also seen how to drop variables iteratively to reach a final solution. Then, we have seen how to interpret the factors and draw the path diagram of the model. Finally, we have seen how to obtain and visualize the scores of the participants on the factors.</p>
</section><section id="further-remarks" class="level2"><h2 class="anchored" data-anchor-id="further-remarks">Further Remarks</h2>
<ul>
<li><p>The data used here is a likert scale data. Yet, EFA actually expects continuous variables. Therefore, it might be wiser to use IRT based factor reduction methods for likert scale data. We will discuss this in a later post.</p></li>
<li><p>The outliers should be checked and removed before running the EFA. Yet, we haven’t done it here. Outlier detection is another topic for another post.</p></li>
</ul>


</section> ]]></description>
  <category>dplyr</category>
  <category>ggplot2</category>
  <category>mirt</category>
  <category>psych</category>
  <guid>https://emrekaragul.com/posts/efaWithLikertData-1/</guid>
  <pubDate>Sun, 17 Nov 2024 21:00:00 GMT</pubDate>
  <media:content url="https://emrekaragul.com/posts/efaWithLikertData-1/image.png" medium="image" type="image/png" height="144" width="144"/>
</item>
<item>
  <title>Multi-Facet Rasch Models with R</title>
  <dc:creator>Ali Emre Karagül</dc:creator>
  <link>https://emrekaragul.com/posts/Multi Facet Rasch Modelling/</link>
  <description><![CDATA[ <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mailchimp Subscription Modal</title>
<link href="//cdn-images.mailchimp.com/embedcode/classic-071822.css" rel="stylesheet" type="text/css">
<style>
        /* Modal Background */
        .modal {
            display: none; /* Hidden by default */
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5); /* Dimmed background */
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        #openModalBtn {
            background-color: tomato; /* background */
            color: white; /* White text */
            border: none; /* Remove border */
            padding: 10px 20px; /* Add padding */
            font-size: 24px; /* Adjust font size */
            border-radius: 5px; /* Rounded corners */
            cursor: pointer; /* Pointer cursor on hover */
            transition: background-color 0.3s ease; /* Smooth hover effect */
            width: 100%;
            margin-bottom: 20px; /* Add space after the button */
        }

        #openModalBtn:hover {
            background-color: rgb(255, 58, 23); /* Darker on hover */
        }
        /* Modal Content */
        .modal-content {
            background-color: #fff;
            padding: 20px;
            border-radius: 8px;
            max-width: 600px;
            width: 90%;
            text-align: center;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            overflow: auto;
        }

        /* Close Button */
        .close-btn {
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 20px;
            font-weight: bold;
            color: #aaa;
            cursor: pointer;
        }

        .close-btn:hover {
            color: #000;
        }
    </style>
<!-- Trigger Button --><button id="openModalBtn">Wanna subscribe?</button>


    <!-- Modal Structure -->
    <div id="subscriptionModal" class="modal">
        <div class="modal-content">
            <span class="close-btn">×</span>
            <!-- Mailchimp Signup Form -->
            <div>
                <div id="mc_embed_signup">
                    <form action="https://emrekaragul.us21.list-manage.com/subscribe/post?u=e72720e0214b2266cab41097e&amp;id=5cddb1a68e&amp;f_id=0038dfe1f0" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate="">
                        <div id="mc_embed_signup_scroll">
                            <h2 class="anchored">Submit your e-mail to subscribe!</h2>
                            <div class="mc-field-group">
                                <label for="mce-EMAIL">Email Address <span class="asterisk">*</span></label>
                                <input type="email" value="" name="EMAIL" class="required email" id="mce-EMAIL" required=""><span id="mce-EMAIL-HELPERTEXT" class="helper_text"></span>
                            </div>
                            <div id="mce-responses" class="clear foot">
                                <div class="response" id="mce-error-response" style="display:none"></div>
                                <div class="response" id="mce-success-response" style="display:none"></div>
                            </div>
                            
                            <div class="optionalParent">
                                <div class="clear foot">
                                    <input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button">
</div>
                            </div>
                        </div>
                    </form>
                </div>
                <script type="text/javascript" src="//s3.amazonaws.com/downloads.mailchimp.com/js/mc-validate.js"></script><script type="text/javascript">
                    (function($) {
                        window.fnames = new Array();
                        window.ftypes = new Array();
                        fnames[0] = 'EMAIL';
                        ftypes[0] = 'email';
                    }(jQuery));
                    var $mcj = jQuery.noConflict(true);
                </script><!--End mc_embed_signup-->
</div>
        </div>
    </div>

    <script>
        // Get the modal, button, and close elements
        const modal = document.getElementById("subscriptionModal");
        const openModalBtn = document.getElementById("openModalBtn");
        const closeBtn = document.querySelector(".close-btn");

        // Open the modal when the button is clicked
        openModalBtn.addEventListener("click", () => {
            modal.style.display = "flex"; // Show the modal
        });

        // Close the modal when the close button is clicked
        closeBtn.addEventListener("click", () => {
            modal.style.display = "none"; // Hide the modal
        });

        // Close the modal when clicking outside of it
        window.addEventListener("click", (e) => {
            if (e.target === modal) {
                modal.style.display = "none";
            }
        });
    </script><section id="introduction" class="level2"><h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>While a basic Rasch model focuses on item difficulty and person ability, the <strong>Multi-Facet Rasch Model</strong> (MFRM) allows us to incorporate additional factors, or facets, such as:</p>
<ul>
<li><p><strong>Person Ability</strong> (e.g., the skill level of test-takers),</p></li>
<li><p><strong>Item Difficulty</strong> (e.g., how hard the test items are),</p></li>
<li><p><strong>Rater Severity</strong> (e.g., how lenient or strict raters are),</p></li>
<li><p><strong>Task or Stimulus Differences</strong> (e.g., variation in tasks given).</p></li>
</ul>
<p>MFRM is said to be IRT version of generalizability theory and it is particularly useful when assessments involve subjective judgments, like in essay grading or performance evaluation, where raters’ subjectivity can introduce bias.</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load the libraries</span></span>
<span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;"><a href="https://readr.tidyverse.org">readr</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;"><a href="https://tidyr.tidyverse.org">tidyr</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span></span>
<span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;"><a href="http://www.edmeasurementsurveys.com/TAM/Tutorials/">TAM</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;"><a href="https://wilkelab.org/cowplot/">cowplot</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">

</div>
</div>
</section><section id="understand-the-data" class="level2"><h2 class="anchored" data-anchor-id="understand-the-data">1. Understand the data</h2>
<p>For MFRM analysis, we are going to use a dataset of essay scores scored on an analytical rubric. There are four domains of the rubric: Content, Prompt Adherence, Language, and Narrativity. Let’s load the data and see the head of them. You can download the data for your own use from <a href="https://drive.google.com/file/d/1cmfJd_h68J5JpBIPX6N-iISgESAVgvlI/view?usp=drive_link">here</a>.</p>
<div class="cell">
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"MFRM_data.csv"</span>, show_col_types <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 6
    Con ProAd  Lang   Nar rater essayId
  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;
1     4     4     3     3     1       1
2     2     2     4     3     1       2
3     4     4     4     4     1       3
4     3     2     4     4     1       4
5     4     4     4     4     1       5
6     1     1     1     2     1       6</code></pre>
</div>
</div>
<p>Let’s see the structure and summary of the data too.</p>
<div class="cell">
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>spc_tbl_ [5,400 × 6] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
 $ Con    : num [1:5400] 4 2 4 3 4 1 1 2 4 3 ...
 $ ProAd  : num [1:5400] 4 2 4 2 4 1 1 2 4 3 ...
 $ Lang   : num [1:5400] 3 4 4 4 4 1 1 4 4 4 ...
 $ Nar    : num [1:5400] 3 3 4 4 4 2 1 4 4 2 ...
 $ rater  : num [1:5400] 1 1 1 1 1 1 1 1 1 1 ...
 $ essayId: num [1:5400] 1 2 3 4 5 6 7 8 9 10 ...
 - attr(*, "spec")=
  .. cols(
  ..   Con = col_double(),
  ..   ProAd = col_double(),
  ..   Lang = col_double(),
  ..   Nar = col_double(),
  ..   rater = col_double(),
  ..   essayId = col_double()
  .. )
 - attr(*, "problems")=&lt;externalptr&gt; </code></pre>
</div>
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      Con            ProAd            Lang            Nar            rater  
 Min.   :0.000   Min.   :0.000   Min.   :0.000   Min.   :0.000   Min.   :1  
 1st Qu.:1.000   1st Qu.:1.000   1st Qu.:1.000   1st Qu.:1.000   1st Qu.:1  
 Median :2.000   Median :2.000   Median :2.000   Median :2.000   Median :2  
 Mean   :1.878   Mean   :1.784   Mean   :2.062   Mean   :1.958   Mean   :2  
 3rd Qu.:3.000   3rd Qu.:3.000   3rd Qu.:3.000   3rd Qu.:3.000   3rd Qu.:3  
 Max.   :4.000   Max.   :4.000   Max.   :4.000   Max.   :4.000   Max.   :3  
    essayId      
 Min.   :   1.0  
 1st Qu.: 450.8  
 Median : 900.5  
 Mean   : 900.5  
 3rd Qu.:1350.2  
 Max.   :1800.0  </code></pre>
</div>
</div>
<p>There are 1800 rows of data. Each domain is scored between 0 and 4. Perfect as zero must exist in the ordinal data for MFRM. The data set consists of scores from three raters on four domains, so we need to account for the three key facets: <strong>person ability</strong> (the essays), <strong>item difficulty</strong> (the domains), and <strong>rater severity</strong> (the three raters).</p>
</section><section id="fit-the-model" class="level2"><h2 class="anchored" data-anchor-id="fit-the-model">2. Fit the model</h2>
<p>Now that we’ve explored our data set, it’s time to fit the Multi-Facet Rasch Model (MFRM). To do this, we’ll use the <code>TAM</code> package in R, which provides functions for fitting various Rasch models, including MFRM. The <code>formulaA</code> provided into the mfr function decides on the model. For PCM, we define interaction between item and step along with the rater facet:</p>
<div class="cell">
<div class="sourceCode" id="cb8" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">facets</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"rater"</span>, drop<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># define facet (rater)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pid</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">essayId</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># define person identifier</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">resp</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># item response data</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">formulaA</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">item</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">step</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">rater</span>   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># formula for PCM</span></span>
<span></span>
<span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">mod</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">TAM</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/TAM/man/tam.mml.html">tam.mml.mfr</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>resp<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">resp</span>, facets<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">facets</span>, formulaA<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">formulaA</span>, pid<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">essayId</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
</div>
</section><section id="model-diagnostics" class="level2"><h2 class="anchored" data-anchor-id="model-diagnostics">3. Model diagnostics</h2>
<p>Now that we’ve fitted our Multi-Facet Rasch Model (MFRM) with PCM, let’s take a closer look at the results and explore some diagnostics.</p>
<div class="cell">
<div class="sourceCode" id="cb9" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fit_stats</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">TAM</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/TAM/man/tam.fit.html">tam.fit</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">mod</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Item fit calculation based on 15 simulations
|**********|
|----------|</code></pre>
</div>
<div class="sourceCode" id="cb11" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fit_stats</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$itemfit
     parameter    Outfit   Outfit_t      Outfit_p  Outfit_pholm     Infit
1          Con 2.0591522  39.361636  0.000000e+00  0.000000e+00 2.1979266
2        ProAd 1.5301160  21.894545 2.928160e-106 2.635344e-105 1.6156500
3         Lang 2.2535201  47.334138  0.000000e+00  0.000000e+00 2.3403618
4          Nar 1.8429272  33.147291 6.196043e-241 6.815647e-240 1.9492346
5        step1 0.9494058  -3.647927  2.643645e-04  5.287290e-04 0.9369712
6        step2 0.4917571 -52.934061  0.000000e+00  0.000000e+00 0.4102024
7        step3 0.2640096 -96.962995  0.000000e+00  0.000000e+00 0.1816552
8        step4 0.9177011  -6.474657  9.502735e-11  3.801094e-10 0.5978796
9       rater1 0.2665086 -83.397247  0.000000e+00  0.000000e+00 0.2045924
10      rater2 0.2126247 -96.365947  0.000000e+00  0.000000e+00 0.1305165
11      rater3 0.3471616 -70.514947  0.000000e+00  0.000000e+00 0.1985980
12   Con:step1 0.8398256  -8.668278  4.387050e-18  2.193525e-17 0.8568111
13 ProAd:step1 0.6746766 -17.811336  5.771558e-71  4.617246e-70 0.7091680
14  Lang:step1 0.5180443 -29.210127 1.442217e-187 1.442217e-186 0.5202205
15   Nar:step1 0.6858151 -16.202919  4.808891e-59  3.366224e-58 0.7063609
16   Con:step2 0.5296627 -33.996303 2.526439e-253 3.031727e-252 0.4427496
17 ProAd:step2 0.4289933 -42.461731  0.000000e+00  0.000000e+00 0.3497186
18  Lang:step2 0.1969640 -75.560345  0.000000e+00  0.000000e+00 0.1640074
19   Nar:step2 0.3698636 -46.072478  0.000000e+00  0.000000e+00 0.3082262
20   Con:step3 0.2804214 -66.678683  0.000000e+00  0.000000e+00 0.2265406
21 ProAd:step3 0.2855422 -62.035576  0.000000e+00  0.000000e+00 0.2089630
22  Lang:step3 0.1888063 -83.889912  0.000000e+00  0.000000e+00 0.1150833
23   Nar:step3 0.2510021 -64.460639  0.000000e+00  0.000000e+00 0.1836688
24   Con:step4 0.9436611  -3.155082  1.604530e-03  1.604530e-03 0.5763329
25 ProAd:step4 0.8958462  -5.556046  2.759535e-08  8.278605e-08 0.5200940
26  Lang:step4 0.4643230 -36.676871 1.707308e-294 2.219500e-293 0.2799968
27   Nar:step4 0.7677798 -12.393932  2.818774e-35  1.691264e-34 0.4609557
       Infit_t       Infit_p   Infit_pholm
1    43.404732  0.000000e+00  0.000000e+00
2    24.924232 4.064309e-137 2.032154e-136
3    49.864878  0.000000e+00  0.000000e+00
4    36.540091 2.561982e-292 2.818181e-291
5    -4.563129  5.039684e-06  5.039684e-06
6   -64.563804  0.000000e+00  0.000000e+00
7  -117.289175  0.000000e+00  0.000000e+00
8   -36.103138 2.024933e-285 2.024933e-284
9   -96.095647  0.000000e+00  0.000000e+00
10 -117.784465  0.000000e+00  0.000000e+00
11  -98.836404  0.000000e+00  0.000000e+00
12   -7.698737  1.374172e-14  2.748343e-14
13  -15.680881  2.043984e-55  8.175938e-55
14  -29.043052 1.883337e-185 1.318336e-184
15  -15.006236  6.683443e-51  2.005033e-50
16  -42.353408  0.000000e+00  0.000000e+00
17  -51.040009  0.000000e+00  0.000000e+00
18  -81.785151  0.000000e+00  0.000000e+00
19  -52.982695  0.000000e+00  0.000000e+00
20  -75.326822  0.000000e+00  0.000000e+00
21  -73.806223  0.000000e+00  0.000000e+00
22 -101.040972  0.000000e+00  0.000000e+00
23  -75.311205  0.000000e+00  0.000000e+00
24  -27.699201 7.138532e-169 4.283119e-168
25  -30.243052 6.438903e-201 5.151122e-200
26  -56.207040  0.000000e+00  0.000000e+00
27  -33.454655 2.202305e-245 1.982075e-244

$time
[1] "2024-12-05 13:54:56 +03" "2024-12-05 13:54:56 +03"

$CALL
TAM::tam.fit(tamobj = mod)

attr(,"class")
[1] "tam.fit"</code></pre>
</div>
</div>
<ul>
<li>
<p><strong>Infit and Outfit Values:</strong></p>
<ul>
<li><p><strong>Infit and Outfit near 1:</strong> Indicates that the item fits well with the model.</p></li>
<li><p><strong>Infit/Outfit significantly &gt;1:</strong> Indicates that the item is <em>underfitting</em>, meaning there is more variability in the responses than the model expects (perhaps caused by noise or misfitting responses).</p></li>
<li><p><strong>Infit/Outfit significantly &lt;1:</strong> Indicates that the item is <em>overfitting</em>, meaning the responses are too predictable, and there’s less variability than expected by the model (possibly due to redundancy or lack of challenge).</p></li>
</ul>
<p>Let’s break down a few examples from the output:</p>
<ul>
<li>
<p><strong>Content (Con):</strong></p>
<ul>
<li><p>Outfit MNSQ: 2.05, Infit MNSQ: 2.18</p></li>
<li><p>These values are well above 1, indicating underfit. The item “Con” might be too noisy or not behaving consistently with the model.</p></li>
</ul>
</li>
<li>
<p><strong>Prompt Adherence (ProAd):</strong></p>
<ul>
<li><p>Outfit MNSQ: 1.54, Infit MNSQ: 1.63</p></li>
<li><p>These values are higher than 1 but still in the acceptable range, meaning there’s some noise, but it’s not excessive.</p></li>
</ul>
</li>
<li>
<p><strong>Language (Lang):</strong></p>
<ul>
<li><p>Outfit MNSQ: 2.26, Infit MNSQ: 2.34</p></li>
<li><p>These values suggest significant underfit, similar to “Con”, indicating that responses to this domain might be less consistent or more unpredictable than the model expects.</p></li>
</ul>
</li>
<li>
<p><strong>Steps (step1 to step4):</strong></p>
<ul>
<li><p>Some steps, such as <strong>step1</strong>, have Infit and Outfit values closer to 1 (e.g., Outfit MNSQ: 0.95, Infit MNSQ: 0.94). These are acceptable and suggest that step1 is fitting well.</p></li>
<li><p>However, <strong>step2, step3, and step4</strong> show extremely low values, especially for Outfit (e.g., <strong>step3</strong> has an Outfit MNSQ of <strong>0.26</strong>), indicating overfit, meaning these categories are too predictable and might not differentiate well between respondents.</p></li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>t-statistics and p-values:</strong></p>
<ul>
<li><p>The <strong>t-statistics (Outfit_t, Infit_t)</strong> are standardized fit statistics that test whether the Infit/Outfit values significantly differ from 1. Large positive or negative t-values indicate significant deviation from expected values.</p></li>
<li><p>The <strong>p-values (Outfit_p, Infit_p)</strong> show whether these deviations are statistically significant. Nearly all p-values are extremely low (close to 0), suggesting that most of the items are statistically misfitting according to the model.</p></li>
</ul>
</li>
<li>
<p><strong>Rater Severity:</strong></p>
<ul>
<li>
<strong>Rater1, Rater2, Rater3</strong> all have very low Infit and Outfit values (e.g., <strong>Rater1 Outfit: 0.26</strong>), which suggest that these raters may be overfitting. This could mean that they are scoring in a highly predictable way, possibly being too strict or lenient consistently.</li>
</ul>
</li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb13" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">reliability</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">mod</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">EAP.rel</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">reliability</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9716057</code></pre>
</div>
</div>
<p>The final <strong>WLE Reliability = 0.97</strong> is an excellent reliability score, meaning that the person ability estimates are very consistent. WLE reliability, similar to other reliability coefficients like Cronbach’s alpha, indicates the precision of the estimates:</p>
<p>A <strong>0.97 reliability</strong> means that 97% of the variance in the person ability estimates is due to true differences in ability rather than measurement error.</p>
<div class="cell">
<div class="sourceCode" id="cb15" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">persons.mod</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">TAM</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/TAM/man/tam.wle.html">tam.wle</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">mod</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Iteration in WLE/MLE estimation  1   | Maximal change  2.8113 
Iteration in WLE/MLE estimation  2   | Maximal change  2.8413 
Iteration in WLE/MLE estimation  3   | Maximal change  2.5741 
Iteration in WLE/MLE estimation  4   | Maximal change  2.1203 
Iteration in WLE/MLE estimation  5   | Maximal change  2.3278 
Iteration in WLE/MLE estimation  6   | Maximal change  0.4228 
Iteration in WLE/MLE estimation  7   | Maximal change  0.0637 
Iteration in WLE/MLE estimation  8   | Maximal change  0.0071 
Iteration in WLE/MLE estimation  9   | Maximal change  8e-04 
Iteration in WLE/MLE estimation  10   | Maximal change  1e-04 
----
 WLE Reliability= 0.97 </code></pre>
</div>
<div class="sourceCode" id="cb17" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>theta <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">persons.mod</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">theta</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">theta</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>binwidth <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>, fill <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"steelblue"</span>, color <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>title <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Distribution of Person Ability Estimates"</span>, x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Ability (Theta)"</span>, y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Frequency"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="index_files/figure-html/unnamed-chunk-7-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="https://emrekaragul.com/posts/Multi Facet Rasch Modelling/index_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>Also see the theta distributions in the chart. They do not look nice as this is a study run on simulated data.</p>
<div class="cell">
<div class="sourceCode" id="cb18" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">thr</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">TAM</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/TAM/man/tam.threshold.html">tam.threshold</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">mod</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">thr</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                    Cat1       Cat2       Cat3     Cat4
Con-rater1    -8.3634338 -4.8121033 -1.2173767 2.406464
Con-rater2    -4.3898621 -0.8385315  2.7560120 6.380035
Con-rater3    -0.5052795  3.0462341  6.6957092       NA
ProAd-rater1  -8.5340881 -4.4764709 -0.6612854 3.438995
ProAd-rater2  -4.5606995 -0.5028992  3.3122864 7.412567
ProAd-rater3  -0.6759338  3.3818665  7.2305603       NA
Lang-rater1  -10.0357361 -5.8611145 -1.8104553 2.433380
Lang-rater2   -6.0621643 -1.8877258  2.1631165 6.406952
Lang-rater3   -2.1775818  1.9970398  6.0768127       NA
Nar-rater1    -9.4873352 -5.3533630 -1.3221130 2.769928
Nar-rater2    -5.5137634 -1.3799744  2.6514587 6.743317
Nar-rater3    -1.6289978  2.5047913  6.5700989       NA</code></pre>
</div>
</div>
<p><strong>Ordered thresholds</strong> are crucial to ensure that the categories are functioning properly. For example, for <strong>Con-rater1</strong>, the thresholds are: -8.36, -4.81, -1.21, and 2.41</p>
<p>These thresholds are in increasing order, which indicates that the rating scale is working as intended for <strong>Con-rater1</strong>—the higher categories represent more difficult levels to achieve.</p>
<p><strong>Raters 1, 2, and 3 Comparison:</strong></p>
<ul>
<li>
<p><strong>Rater Differences:</strong> There are noticeable differences between raters in their thresholds. For example:</p>
<ul>
<li><p><strong>Con-rater1</strong> has very negative thresholds, starting at -8.36 for Cat1, while <strong>Con-rater3</strong> starts much higher, with thresholds beginning at -0.50.</p></li>
<li><p>This suggests that <strong>Rater1</strong> is much stricter or uses a harsher scale, while <strong>Rater3</strong> is more lenient, with easier transitions between categories. For instance, it is harder for essays to move from a “1” to a “2” under Rater1’s scoring compared to Rater3.</p></li>
<li><p>There are some NAs which actually I have no idea about. Peobably these inconsistancies occur due to the simulated data.</p></li>
</ul>
</li>
</ul></section><section id="visualizing-the-results" class="level2"><h2 class="anchored" data-anchor-id="visualizing-the-results">4. Visualizing the Results</h2>
<p>To make the interpretation more intuitive, we can visualize the item difficulty and rater severity using a <strong>dot plot</strong> for the difficulty estimates, which can help us compare how each domain and rater behaves. Here’s how we can generate these plots in R.</p>
<div class="cell">
<div class="sourceCode" id="cb20" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">facet_params</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">mod</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"xsi.facets"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"parameter"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">domain_params</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">facet_params</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span></span>
<span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">f1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">persons.mod</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">theta</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://ggplot2.tidyverse.org/reference/geom_dotplot.html">geom_dotplot</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>binwidth <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.1</span>, stackdir <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"down"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>  <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>name <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>, breaks <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>breaks<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.6</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>, limits<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>, </span>
<span>                     position <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"top"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>axis.title.y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>, </span>
<span>        axis.title.x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>,</span>
<span>        axis.text.x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>,</span>
<span>        axis.ticks.x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>title <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Persons"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html">coord_flip</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">f2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">mod</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">xsi.facets</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://stringr.tidyverse.org/reference/str_starts.html">str_starts</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">parameter</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"rater"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">xsi</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, label <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">parameter</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>, nudge_y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span>, size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>name <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>, breaks <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>breaks <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.5</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>, limits <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>, position <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"top"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>axis.title.y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>,</span>
<span>        axis.text.y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>,</span>
<span>        axis.ticks.y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>,</span>
<span>        axis.title.x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>title <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Raters"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html">coord_flip</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">f3</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">mod</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">xsi.facets</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">parameter</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">domain_params</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">xsi</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, label <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">parameter</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>, nudge_y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span>, size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span>    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>  <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span>    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>name <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>, breaks <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span>    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>breaks<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>, limits<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>, </span>
<span>                       position <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"top"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span>    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>axis.title.y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>,</span>
<span>          axis.text.y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>,</span>
<span>          axis.ticks.y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>,</span>
<span>          axis.title.x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span>    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>title <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Domain"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span>    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html">coord_flip</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html">plot_grid</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">f1</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">f2</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">f3</span>, nrow <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, rel_widths <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.15</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.15</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="index_files/figure-html/Wright Map-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img src="https://emrekaragul.com/posts/Multi Facet Rasch Modelling/index_files/figure-html/Wright Map-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>This final chart is developed as an alternative to <code>wrightmap</code>. Each facet can be seen easily on it. There are four grids. The first is the person thetas. We have seen this above. The second is the rater facet. The strictness of the raters are very distinctive. Actually the only real data here is rater 2 and the others were simulated using it to be stricter and lenient. So we exactly see what the data is about. The third grid is about the domains/item difficulty. Pompt Adherence is the most difficult domain. Content, Narrative and Language follows it respectively.</p>
</section><section id="conclusion" class="level2"><h2 class="anchored" data-anchor-id="conclusion">5. Conclusion</h2>
<p>In this post, we explored the <strong>Multi-Facet Rasch Model (MFRM)</strong> using simulated essay scores rated by multiple raters across four different domains: Content, Prompt Adherence, Language, and Narrativity. The model helped us account for the varying levels of item difficulty and the potential differences in rater severity. By fitting the MFRM and examining key model outputs—like <strong>Infit/Outfit statistics</strong> and <strong>thresholds</strong>—we identified areas where raters were either more lenient or more severe, and items that displayed more noise or predictability than expected.</p>
<p>The high <strong>WLE reliability</strong> of 0.97 indicates that the model provides consistent and accurate estimates of person abilities. However, the rater-specific thresholds revealed some important differences in how each rater scored the essays, with certain raters being significantly stricter or more lenient. This highlights the importance of accounting for rater bias in assessments that rely on subjective judgments, such as essay scoring.</p>
<p>Going forward, addressing these rater differences and ensuring well-functioning rating categories can further refine the assessment process. By doing so, we can ensure that the scores are fairer and more representative of true essay quality, free from the influence of individual rater biases. Overall, the MFRM proves to be a valuable tool in maintaining the validity and reliability of assessments involving subjective judgments.</p>


</section> ]]></description>
  <category>readr</category>
  <category>tidyr</category>
  <category>ggplot2</category>
  <category>dplyr</category>
  <category>tam</category>
  <category>cowplot</category>
  <guid>https://emrekaragul.com/posts/Multi Facet Rasch Modelling/</guid>
  <pubDate>Wed, 16 Oct 2024 21:00:00 GMT</pubDate>
  <media:content url="https://emrekaragul.com/posts/Multi Facet Rasch Modelling/image.png" medium="image" type="image/png" height="144" width="144"/>
</item>
<item>
  <title>Measurement Invariance</title>
  <dc:creator>Ali Emre Karagül</dc:creator>
  <link>https://emrekaragul.com/posts/Measuerement Invariance/</link>
  <description><![CDATA[ <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mailchimp Subscription Modal</title>
<link href="//cdn-images.mailchimp.com/embedcode/classic-071822.css" rel="stylesheet" type="text/css">
<style>
        /* Modal Background */
        .modal {
            display: none; /* Hidden by default */
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5); /* Dimmed background */
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        #openModalBtn {
            background-color: tomato; /* background */
            color: white; /* White text */
            border: none; /* Remove border */
            padding: 10px 20px; /* Add padding */
            font-size: 24px; /* Adjust font size */
            border-radius: 5px; /* Rounded corners */
            cursor: pointer; /* Pointer cursor on hover */
            transition: background-color 0.3s ease; /* Smooth hover effect */
            width: 100%;
            margin-bottom: 20px; /* Add space after the button */
        }

        #openModalBtn:hover {
            background-color: rgb(255, 58, 23); /* Darker on hover */
        }
        /* Modal Content */
        .modal-content {
            background-color: #fff;
            padding: 20px;
            border-radius: 8px;
            max-width: 600px;
            width: 90%;
            text-align: center;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            overflow: auto;
        }

        /* Close Button */
        .close-btn {
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 20px;
            font-weight: bold;
            color: #aaa;
            cursor: pointer;
        }

        .close-btn:hover {
            color: #000;
        }
    </style>
<!-- Trigger Button --><button id="openModalBtn">Wanna subscribe?</button>


    <!-- Modal Structure -->
    <div id="subscriptionModal" class="modal">
        <div class="modal-content">
            <span class="close-btn">×</span>
            <!-- Mailchimp Signup Form -->
            <div>
                <div id="mc_embed_signup">
                    <form action="https://emrekaragul.us21.list-manage.com/subscribe/post?u=e72720e0214b2266cab41097e&amp;id=5cddb1a68e&amp;f_id=0038dfe1f0" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate="">
                        <div id="mc_embed_signup_scroll">
                            <h2 class="anchored">Submit your e-mail to subscribe!</h2>
                            <div class="mc-field-group">
                                <label for="mce-EMAIL">Email Address <span class="asterisk">*</span></label>
                                <input type="email" value="" name="EMAIL" class="required email" id="mce-EMAIL" required=""><span id="mce-EMAIL-HELPERTEXT" class="helper_text"></span>
                            </div>
                            <div id="mce-responses" class="clear foot">
                                <div class="response" id="mce-error-response" style="display:none"></div>
                                <div class="response" id="mce-success-response" style="display:none"></div>
                            </div>
                            
                            <div class="optionalParent">
                                <div class="clear foot">
                                    <input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button">
</div>
                            </div>
                        </div>
                    </form>
                </div>
                <script type="text/javascript" src="//s3.amazonaws.com/downloads.mailchimp.com/js/mc-validate.js"></script><script type="text/javascript">
                    (function($) {
                        window.fnames = new Array();
                        window.ftypes = new Array();
                        fnames[0] = 'EMAIL';
                        ftypes[0] = 'email';
                    }(jQuery));
                    var $mcj = jQuery.noConflict(true);
                </script><!--End mc_embed_signup-->
</div>
        </div>
    </div>

    <script>
        // Get the modal, button, and close elements
        const modal = document.getElementById("subscriptionModal");
        const openModalBtn = document.getElementById("openModalBtn");
        const closeBtn = document.querySelector(".close-btn");

        // Open the modal when the button is clicked
        openModalBtn.addEventListener("click", () => {
            modal.style.display = "flex"; // Show the modal
        });

        // Close the modal when the close button is clicked
        closeBtn.addEventListener("click", () => {
            modal.style.display = "none"; // Hide the modal
        });

        // Close the modal when clicking outside of it
        window.addEventListener("click", (e) => {
            if (e.target === modal) {
                modal.style.display = "none";
            }
        });
    </script><section id="introduction" class="level2"><h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>Measurement invariance is critical because if a test is not invariant across groups, differences in test scores might reflect biases in how questions are interpreted. For instance, a math test may appear to show that boys score higher than girls, but this could be because certain items function differently for each group.</p>
<p>There are different levels of MI:</p>
<p><strong>Configural Invariance:</strong> Tests whether the overall factor structure (i.e., the number and pattern of factors) is the same across groups. It is the smallest restrictive form of invariance. It allows us to conclude that the groups conceptualize the construct in the same way.</p>
<p><strong>Metric (Weak) Invariance:</strong> Tests whether the factor loadings (the strength of the relationship between each item and the latent factor) are equal across groups. This ensures that the items are equally good indicators of the latent construct in all groups.</p>
<p><strong>Scalar (Strong) Invariance:</strong> Tests whether item intercepts are equal across groups. Scalar invariance is necessary for comparing latent means between groups.</p>
<p><strong>Strict Invariance:</strong> Tests whether item residual variances are equal across groups. It’s the strongest form of invariance, implying that the amount of measurement error is consistent across groups.</p>
<p>In the context of R, we can use structural equation modeling (SEM) to assess MI. The <code>lavaan</code> package provides a dataset (<code>HolzingerSwineford1939</code>) for several SEM analysis including MI. Let’s load the <code>lavaan</code> and <code>HolzingerSwineford1939</code> data along with the <code>semTools</code> package for visualization.</p>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># requirements</span></span>
<span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"><a href="https://lavaan.ugent.be">"lavaan"</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"><a href="https://github.com/SachaEpskamp/semPlot">"semPlot"</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># For additional tools related to SEM</span></span>
<span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"><a href="https://ggplot2.tidyverse.org">"ggplot2"</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"><a href="https://github.com/simsem/semTools/wiki">"semTools"</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
</details><div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="cell quarto-layout-cell" data-code_folding="true" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="code-with-filename">

</div>
</div>
</div>
</div>
</section><section id="understand-the-data" class="level2"><h2 class="anchored" data-anchor-id="understand-the-data">1. Understand the data</h2>
<p>Let’s load the data and see the head of them:</p>
<div class="cell" data-code_folding="true">
<div class="code-with-filename">
<details class="code-fold"><summary>Code</summary><div class="code-with-filename-file">
<pre><strong></strong></pre>
</div>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"HolzingerSwineford1939"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">HolzingerSwineford1939</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
</details>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  id sex ageyr agemo  school grade       x1   x2    x3       x4   x5        x6
1  1   1    13     1 Pasteur     7 3.333333 7.75 0.375 2.333333 5.75 1.2857143
2  2   2    13     7 Pasteur     7 5.333333 5.25 2.125 1.666667 3.00 1.2857143
3  3   2    13     1 Pasteur     7 4.500000 5.25 1.875 1.000000 1.75 0.4285714
4  4   1    13     2 Pasteur     7 5.333333 7.75 3.000 2.666667 4.50 2.4285714
5  5   2    12     2 Pasteur     7 4.833333 4.75 0.875 2.666667 4.00 2.5714286
6  6   2    14     1 Pasteur     7 5.333333 5.00 2.250 1.000000 3.00 0.8571429
        x7   x8       x9
1 3.391304 5.75 6.361111
2 3.782609 6.25 7.916667
3 3.260870 3.90 4.416667
4 3.000000 5.30 4.861111
5 3.695652 6.30 5.916667
6 4.347826 6.65 7.500000</code></pre>
</div>
</div>
<p>The <strong>Holzinger and Swineford</strong> dataset contains data on students’ cognitive abilities, including variables like <strong>sex</strong>, <strong>age</strong>, and <strong>grade</strong>. It also includes information about the school of students. It includes several cognitive test scores (variables x1 to x9) that measure different abilities, which can be used to examine latent traits. These variables and code for the model is provided in the package’s own paper. The dataset measures three latent factors:</p>
<ul>
<li><p><strong>Visual</strong> (x1, x2, x3),</p></li>
<li><p><strong>Textual</strong> (x4, x5, x6),</p></li>
<li><p><strong>Speed</strong> (x7, x8, x9).</p></li>
</ul></section><section id="fit-the-base-model" class="level2"><h2 class="anchored" data-anchor-id="fit-the-base-model">2. Fit the base model</h2>
<p>Let’s specify the CFA model.</p>
<div class="cell" data-code_folding="true">
<div class="code-with-filename">
<details class="code-fold"><summary>Code</summary><div class="code-with-filename-file">
<pre><strong></strong></pre>
</div>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">HS.model</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">' visual  =~ x1 + x2 + x3</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">              textual =~ x4 + x5 + x6</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">              speed   =~ x7 + x8 + x9 '</span></span></code></pre></div>
</details>
</div>
</div>
<p>We fit the model using the entire dataset without considering groups. This step provides a baseline understanding of how well the model fits:</p>
<div class="cell" data-code_folding="true">
<div class="code-with-filename">
<details class="code-fold"><summary>Code</summary><div class="code-with-filename-file">
<pre><strong></strong></pre>
</div>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fit</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/lavaan/man/lavaan.html">lavaan</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">HS.model</span>, data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">HolzingerSwineford1939</span>, </span>
<span>              auto.var <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, auto.fix.first <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,</span>
<span>              auto.cov.lv.x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fit</span>, fit.measures <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
</details>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 35 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        21

  Number of observations                           301

Model Test User Model:
                                                      
  Test statistic                                85.306
  Degrees of freedom                                24
  P-value (Chi-square)                           0.000

Model Test Baseline Model:

  Test statistic                               918.852
  Degrees of freedom                                36
  P-value                                        0.000

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.931
  Tucker-Lewis Index (TLI)                       0.896

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)              -3737.745
  Loglikelihood unrestricted model (H1)      -3695.092
                                                      
  Akaike (AIC)                                7517.490
  Bayesian (BIC)                              7595.339
  Sample-size adjusted Bayesian (SABIC)       7528.739

Root Mean Square Error of Approximation:

  RMSEA                                          0.092
  90 Percent confidence interval - lower         0.071
  90 Percent confidence interval - upper         0.114
  P-value H_0: RMSEA &lt;= 0.050                    0.001
  P-value H_0: RMSEA &gt;= 0.080                    0.840

Standardized Root Mean Square Residual:

  SRMR                                           0.065

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  visual =~                                           
    x1                1.000                           
    x2                0.554    0.100    5.554    0.000
    x3                0.729    0.109    6.685    0.000
  textual =~                                          
    x4                1.000                           
    x5                1.113    0.065   17.014    0.000
    x6                0.926    0.055   16.703    0.000
  speed =~                                            
    x7                1.000                           
    x8                1.180    0.165    7.152    0.000
    x9                1.082    0.151    7.155    0.000

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  visual ~~                                           
    textual           0.408    0.074    5.552    0.000
    speed             0.262    0.056    4.660    0.000
  textual ~~                                          
    speed             0.173    0.049    3.518    0.000

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .x1                0.549    0.114    4.833    0.000
   .x2                1.134    0.102   11.146    0.000
   .x3                0.844    0.091    9.317    0.000
   .x4                0.371    0.048    7.779    0.000
   .x5                0.446    0.058    7.642    0.000
   .x6                0.356    0.043    8.277    0.000
   .x7                0.799    0.081    9.823    0.000
   .x8                0.488    0.074    6.573    0.000
   .x9                0.566    0.071    8.003    0.000
    visual            0.809    0.145    5.564    0.000
    textual           0.979    0.112    8.737    0.000
    speed             0.384    0.086    4.451    0.000</code></pre>
</div>
</div>
<ul>
<li><p><strong>Chi-Square Test (85.306, df = 24, p &lt; 0.001)</strong>: The significant result indicates that the model doesn’t perfectly fit the data, but Chi-square is highly sensitive to sample size.</p></li>
<li><p><strong>CFI (0.931)</strong>: This value suggests a reasonably good fit (values above 0.90 are typically considered acceptable).</p></li>
<li><p><strong>RMSEA (0.092)</strong>: The RMSEA is below the threshold for a good fit (&lt;0.10).</p></li>
<li><p><strong>SRMR (0.065)</strong>: This is below 0.10.</p></li>
</ul>
<p>All latent variables (visual, textual, speed) show significant factor loadings for their respective observed variables (e.g., x1–x3 for visual), indicating that these items effectively measure their intended constructs.</p>
<p>Covariances between latent variables (visual, textual, speed) are significant, indicating meaningful relationships between these cognitive abilities.<br></p>
</section><section id="measurement-invariance" class="level2"><h2 class="anchored" data-anchor-id="measurement-invariance">3. Measurement Invariance</h2>
<p>Now we move on to measurement invariance.</p>
<section id="configural-invariance" class="level3"><h3 class="anchored" data-anchor-id="configural-invariance">3.1. Configural Invariance</h3>
<p>The first step is testing <strong>configural invariance</strong>, which checks whether the factor structure (i.e., the number of factors and their loadings) is the same across groups. We’ll use <strong>school</strong> as the grouping variable:</p>
<div class="cell" data-code_folding="true">
<div class="code-with-filename">
<details class="code-fold"><summary>Code</summary><div class="code-with-filename-file">
<pre><strong></strong></pre>
</div>
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fit_configural</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/lavaan/man/cfa.html">cfa</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">HS.model</span>, data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">HolzingerSwineford1939</span>, group <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"school"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fit_configural</span>, fit.measures <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
</details>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 57 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        60

  Number of observations per group:                   
    Pasteur                                        156
    Grant-White                                    145

Model Test User Model:
                                                      
  Test statistic                               115.851
  Degrees of freedom                                48
  P-value (Chi-square)                           0.000
  Test statistic for each group:
    Pasteur                                     64.309
    Grant-White                                 51.542

Model Test Baseline Model:

  Test statistic                               957.769
  Degrees of freedom                                72
  P-value                                        0.000

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.923
  Tucker-Lewis Index (TLI)                       0.885

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)              -3682.198
  Loglikelihood unrestricted model (H1)      -3624.272
                                                      
  Akaike (AIC)                                7484.395
  Bayesian (BIC)                              7706.822
  Sample-size adjusted Bayesian (SABIC)       7516.536

Root Mean Square Error of Approximation:

  RMSEA                                          0.097
  90 Percent confidence interval - lower         0.075
  90 Percent confidence interval - upper         0.120
  P-value H_0: RMSEA &lt;= 0.050                    0.001
  P-value H_0: RMSEA &gt;= 0.080                    0.897

Standardized Root Mean Square Residual:

  SRMR                                           0.068

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured


Group 1 [Pasteur]:

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  visual =~                                           
    x1                1.000                           
    x2                0.394    0.122    3.220    0.001
    x3                0.570    0.140    4.076    0.000
  textual =~                                          
    x4                1.000                           
    x5                1.183    0.102   11.613    0.000
    x6                0.875    0.077   11.421    0.000
  speed =~                                            
    x7                1.000                           
    x8                1.125    0.277    4.057    0.000
    x9                0.922    0.225    4.104    0.000

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  visual ~~                                           
    textual           0.479    0.106    4.531    0.000
    speed             0.185    0.077    2.397    0.017
  textual ~~                                          
    speed             0.182    0.069    2.628    0.009

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .x1                4.941    0.095   52.249    0.000
   .x2                5.984    0.098   60.949    0.000
   .x3                2.487    0.093   26.778    0.000
   .x4                2.823    0.092   30.689    0.000
   .x5                3.995    0.105   38.183    0.000
   .x6                1.922    0.079   24.321    0.000
   .x7                4.432    0.087   51.181    0.000
   .x8                5.563    0.078   71.214    0.000
   .x9                5.418    0.079   68.440    0.000

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .x1                0.298    0.232    1.286    0.198
   .x2                1.334    0.158    8.464    0.000
   .x3                0.989    0.136    7.271    0.000
   .x4                0.425    0.069    6.138    0.000
   .x5                0.456    0.086    5.292    0.000
   .x6                0.290    0.050    5.780    0.000
   .x7                0.820    0.125    6.580    0.000
   .x8                0.510    0.116    4.406    0.000
   .x9                0.680    0.104    6.516    0.000
    visual            1.097    0.276    3.967    0.000
    textual           0.894    0.150    5.963    0.000
    speed             0.350    0.126    2.778    0.005


Group 2 [Grant-White]:

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  visual =~                                           
    x1                1.000                           
    x2                0.736    0.155    4.760    0.000
    x3                0.925    0.166    5.583    0.000
  textual =~                                          
    x4                1.000                           
    x5                0.990    0.087   11.418    0.000
    x6                0.963    0.085   11.377    0.000
  speed =~                                            
    x7                1.000                           
    x8                1.226    0.187    6.569    0.000
    x9                1.058    0.165    6.429    0.000

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  visual ~~                                           
    textual           0.408    0.098    4.153    0.000
    speed             0.276    0.076    3.639    0.000
  textual ~~                                          
    speed             0.222    0.073    3.022    0.003

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .x1                4.930    0.095   51.696    0.000
   .x2                6.200    0.092   67.416    0.000
   .x3                1.996    0.086   23.195    0.000
   .x4                3.317    0.093   35.625    0.000
   .x5                4.712    0.096   48.986    0.000
   .x6                2.469    0.094   26.277    0.000
   .x7                3.921    0.086   45.819    0.000
   .x8                5.488    0.087   63.174    0.000
   .x9                5.327    0.085   62.571    0.000

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .x1                0.715    0.126    5.676    0.000
   .x2                0.899    0.123    7.339    0.000
   .x3                0.557    0.103    5.409    0.000
   .x4                0.315    0.065    4.870    0.000
   .x5                0.419    0.072    5.812    0.000
   .x6                0.406    0.069    5.880    0.000
   .x7                0.600    0.091    6.584    0.000
   .x8                0.401    0.094    4.249    0.000
   .x9                0.535    0.089    6.010    0.000
    visual            0.604    0.160    3.762    0.000
    textual           0.942    0.152    6.177    0.000
    speed             0.461    0.118    3.910    0.000</code></pre>
</div>
</div>
<p>The <strong>configural invariance</strong> model provides a baseline for comparing the factor structure across groups (schools: <strong>Pasteur</strong> and <strong>Grant-White</strong>).</p>
<ul>
<li>
<p><strong>Fit Indices</strong>:</p>
<ul>
<li><p>The <strong>CFI</strong> of 0.923 and <strong>TLI</strong> of 0.885 suggest a reasonably good fit but not excellent.</p></li>
<li><p>The <strong>RMSEA</strong> of 0.097 is slightly below the recommended 0.10 threshold.</p></li>
<li><p>The <strong>SRMR</strong> of 0.068 is within an acceptable range, below 0.10, indicating a good fit.</p></li>
</ul>
</li>
</ul>
<p>These results show that the overall factor structure is consistent across the two schools, but there’s room for improvement in model fit.</p>
</section><section id="metric-invariance" class="level3"><h3 class="anchored" data-anchor-id="metric-invariance">3.2. Metric Invariance</h3>
<p>Next, we would proceed to test <strong>metric invariance</strong>, where we constrain the factor loadings across groups to assess if the model behaves equivalently in both schools.</p>
<div class="cell" data-code_folding="true">
<div class="code-with-filename">
<details class="code-fold"><summary>Code</summary><div class="code-with-filename-file">
<pre><strong></strong></pre>
</div>
<div class="sourceCode" id="cb9" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fit_metric</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/lavaan/man/cfa.html">cfa</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">HS.model</span>, data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">HolzingerSwineford1939</span>, group <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"school"</span>, group.equal <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"loadings"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fit_metric</span>, fit.measures <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
</details>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 42 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        60
  Number of equality constraints                     6

  Number of observations per group:                   
    Pasteur                                        156
    Grant-White                                    145

Model Test User Model:
                                                      
  Test statistic                               124.044
  Degrees of freedom                                54
  P-value (Chi-square)                           0.000
  Test statistic for each group:
    Pasteur                                     68.825
    Grant-White                                 55.219

Model Test Baseline Model:

  Test statistic                               957.769
  Degrees of freedom                                72
  P-value                                        0.000

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.921
  Tucker-Lewis Index (TLI)                       0.895

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)              -3686.294
  Loglikelihood unrestricted model (H1)      -3624.272
                                                      
  Akaike (AIC)                                7480.587
  Bayesian (BIC)                              7680.771
  Sample-size adjusted Bayesian (SABIC)       7509.514

Root Mean Square Error of Approximation:

  RMSEA                                          0.093
  90 Percent confidence interval - lower         0.071
  90 Percent confidence interval - upper         0.114
  P-value H_0: RMSEA &lt;= 0.050                    0.001
  P-value H_0: RMSEA &gt;= 0.080                    0.845

Standardized Root Mean Square Residual:

  SRMR                                           0.072

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured


Group 1 [Pasteur]:

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  visual =~                                           
    x1                1.000                           
    x2      (.p2.)    0.599    0.100    5.979    0.000
    x3      (.p3.)    0.784    0.108    7.267    0.000
  textual =~                                          
    x4                1.000                           
    x5      (.p5.)    1.083    0.067   16.049    0.000
    x6      (.p6.)    0.912    0.058   15.785    0.000
  speed =~                                            
    x7                1.000                           
    x8      (.p8.)    1.201    0.155    7.738    0.000
    x9      (.p9.)    1.038    0.136    7.629    0.000

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  visual ~~                                           
    textual           0.416    0.097    4.271    0.000
    speed             0.169    0.064    2.643    0.008
  textual ~~                                          
    speed             0.176    0.061    2.882    0.004

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .x1                4.941    0.093   52.991    0.000
   .x2                5.984    0.100   60.096    0.000
   .x3                2.487    0.094   26.465    0.000
   .x4                2.823    0.093   30.371    0.000
   .x5                3.995    0.101   39.714    0.000
   .x6                1.922    0.081   23.711    0.000
   .x7                4.432    0.086   51.540    0.000
   .x8                5.563    0.078   71.087    0.000
   .x9                5.418    0.079   68.153    0.000

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .x1                0.551    0.137    4.010    0.000
   .x2                1.258    0.155    8.117    0.000
   .x3                0.882    0.128    6.884    0.000
   .x4                0.434    0.070    6.238    0.000
   .x5                0.508    0.082    6.229    0.000
   .x6                0.266    0.050    5.294    0.000
   .x7                0.849    0.114    7.468    0.000
   .x8                0.515    0.095    5.409    0.000
   .x9                0.658    0.096    6.865    0.000
    visual            0.805    0.171    4.714    0.000
    textual           0.913    0.137    6.651    0.000
    speed             0.305    0.078    3.920    0.000


Group 2 [Grant-White]:

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  visual =~                                           
    x1                1.000                           
    x2      (.p2.)    0.599    0.100    5.979    0.000
    x3      (.p3.)    0.784    0.108    7.267    0.000
  textual =~                                          
    x4                1.000                           
    x5      (.p5.)    1.083    0.067   16.049    0.000
    x6      (.p6.)    0.912    0.058   15.785    0.000
  speed =~                                            
    x7                1.000                           
    x8      (.p8.)    1.201    0.155    7.738    0.000
    x9      (.p9.)    1.038    0.136    7.629    0.000

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  visual ~~                                           
    textual           0.437    0.099    4.423    0.000
    speed             0.314    0.079    3.958    0.000
  textual ~~                                          
    speed             0.226    0.072    3.144    0.002

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .x1                4.930    0.097   50.763    0.000
   .x2                6.200    0.091   68.379    0.000
   .x3                1.996    0.085   23.455    0.000
   .x4                3.317    0.092   35.950    0.000
   .x5                4.712    0.100   47.173    0.000
   .x6                2.469    0.091   27.248    0.000
   .x7                3.921    0.086   45.555    0.000
   .x8                5.488    0.087   63.257    0.000
   .x9                5.327    0.085   62.786    0.000

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .x1                0.645    0.127    5.084    0.000
   .x2                0.933    0.121    7.732    0.000
   .x3                0.605    0.096    6.282    0.000
   .x4                0.329    0.062    5.279    0.000
   .x5                0.384    0.073    5.270    0.000
   .x6                0.437    0.067    6.576    0.000
   .x7                0.599    0.090    6.651    0.000
   .x8                0.406    0.089    4.541    0.000
   .x9                0.532    0.086    6.202    0.000
    visual            0.722    0.161    4.490    0.000
    textual           0.906    0.136    6.646    0.000
    speed             0.475    0.109    4.347    0.000</code></pre>
</div>
</div>
<ul>
<li><p><strong>CFI</strong> (0.921) and <strong>TLI</strong> (0.895) are still relatively good, indicating that the constrained model is acceptable.</p></li>
<li><p><strong>RMSEA</strong> (0.093) suggests an acceptable fit.</p></li>
<li><p><strong>SRMR</strong> (0.072) is still below 0.08, indicating acceptable fit.</p></li>
</ul>
<p>The comparison between the configural and metric models shows a slight decline in fit, but the invariance model still seems reasonably supported. This indicates that the factor loadings are equivalent across the two schools, allowing us to meaningfully compare relationships between items and latent factors.</p>
</section><section id="scalar-invariance" class="level3"><h3 class="anchored" data-anchor-id="scalar-invariance">3.3. Scalar Invariance</h3>
<p>Next, we would proceed with testing <strong>scalar invariance</strong>.</p>
<div class="cell" data-code_folding="true">
<div class="code-with-filename">
<details class="code-fold"><summary>Code</summary><div class="code-with-filename-file">
<pre><strong></strong></pre>
</div>
<div class="sourceCode" id="cb11" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fit_scalar</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/lavaan/man/cfa.html">cfa</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">HS.model</span>, data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">HolzingerSwineford1939</span>, group <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"school"</span>, group.equal <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"loadings"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"intercepts"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fit_scalar</span>, fit.measures <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
</details>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 60 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        63
  Number of equality constraints                    15

  Number of observations per group:                   
    Pasteur                                        156
    Grant-White                                    145

Model Test User Model:
                                                      
  Test statistic                               164.103
  Degrees of freedom                                60
  P-value (Chi-square)                           0.000
  Test statistic for each group:
    Pasteur                                     90.210
    Grant-White                                 73.892

Model Test Baseline Model:

  Test statistic                               957.769
  Degrees of freedom                                72
  P-value                                        0.000

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.882
  Tucker-Lewis Index (TLI)                       0.859

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)              -3706.323
  Loglikelihood unrestricted model (H1)      -3624.272
                                                      
  Akaike (AIC)                                7508.647
  Bayesian (BIC)                              7686.588
  Sample-size adjusted Bayesian (SABIC)       7534.359

Root Mean Square Error of Approximation:

  RMSEA                                          0.107
  90 Percent confidence interval - lower         0.088
  90 Percent confidence interval - upper         0.127
  P-value H_0: RMSEA &lt;= 0.050                    0.000
  P-value H_0: RMSEA &gt;= 0.080                    0.989

Standardized Root Mean Square Residual:

  SRMR                                           0.082

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured


Group 1 [Pasteur]:

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  visual =~                                           
    x1                1.000                           
    x2      (.p2.)    0.576    0.101    5.713    0.000
    x3      (.p3.)    0.798    0.112    7.146    0.000
  textual =~                                          
    x4                1.000                           
    x5      (.p5.)    1.120    0.066   16.965    0.000
    x6      (.p6.)    0.932    0.056   16.608    0.000
  speed =~                                            
    x7                1.000                           
    x8      (.p8.)    1.130    0.145    7.786    0.000
    x9      (.p9.)    1.009    0.132    7.667    0.000

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  visual ~~                                           
    textual           0.410    0.095    4.293    0.000
    speed             0.178    0.066    2.687    0.007
  textual ~~                                          
    speed             0.180    0.062    2.900    0.004

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .x1      (.25.)    5.001    0.090   55.760    0.000
   .x2      (.26.)    6.151    0.077   79.905    0.000
   .x3      (.27.)    2.271    0.083   27.387    0.000
   .x4      (.28.)    2.778    0.087   31.953    0.000
   .x5      (.29.)    4.035    0.096   41.858    0.000
   .x6      (.30.)    1.926    0.079   24.426    0.000
   .x7      (.31.)    4.242    0.073   57.975    0.000
   .x8      (.32.)    5.630    0.072   78.531    0.000
   .x9      (.33.)    5.465    0.069   79.016    0.000

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .x1                0.555    0.139    3.983    0.000
   .x2                1.296    0.158    8.186    0.000
   .x3                0.944    0.136    6.929    0.000
   .x4                0.445    0.069    6.430    0.000
   .x5                0.502    0.082    6.136    0.000
   .x6                0.263    0.050    5.264    0.000
   .x7                0.888    0.120    7.416    0.000
   .x8                0.541    0.095    5.706    0.000
   .x9                0.654    0.096    6.805    0.000
    visual            0.796    0.172    4.641    0.000
    textual           0.879    0.131    6.694    0.000
    speed             0.322    0.082    3.914    0.000


Group 2 [Grant-White]:

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  visual =~                                           
    x1                1.000                           
    x2      (.p2.)    0.576    0.101    5.713    0.000
    x3      (.p3.)    0.798    0.112    7.146    0.000
  textual =~                                          
    x4                1.000                           
    x5      (.p5.)    1.120    0.066   16.965    0.000
    x6      (.p6.)    0.932    0.056   16.608    0.000
  speed =~                                            
    x7                1.000                           
    x8      (.p8.)    1.130    0.145    7.786    0.000
    x9      (.p9.)    1.009    0.132    7.667    0.000

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  visual ~~                                           
    textual           0.427    0.097    4.417    0.000
    speed             0.329    0.082    4.006    0.000
  textual ~~                                          
    speed             0.236    0.073    3.224    0.001

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .x1      (.25.)    5.001    0.090   55.760    0.000
   .x2      (.26.)    6.151    0.077   79.905    0.000
   .x3      (.27.)    2.271    0.083   27.387    0.000
   .x4      (.28.)    2.778    0.087   31.953    0.000
   .x5      (.29.)    4.035    0.096   41.858    0.000
   .x6      (.30.)    1.926    0.079   24.426    0.000
   .x7      (.31.)    4.242    0.073   57.975    0.000
   .x8      (.32.)    5.630    0.072   78.531    0.000
   .x9      (.33.)    5.465    0.069   79.016    0.000
    visual           -0.148    0.122   -1.211    0.226
    textual           0.576    0.117    4.918    0.000
    speed            -0.177    0.090   -1.968    0.049

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .x1                0.654    0.128    5.094    0.000
   .x2                0.964    0.123    7.812    0.000
   .x3                0.641    0.101    6.316    0.000
   .x4                0.343    0.062    5.534    0.000
   .x5                0.376    0.073    5.133    0.000
   .x6                0.437    0.067    6.559    0.000
   .x7                0.625    0.095    6.574    0.000
   .x8                0.434    0.088    4.914    0.000
   .x9                0.522    0.086    6.102    0.000
    visual            0.708    0.160    4.417    0.000
    textual           0.870    0.131    6.659    0.000
    speed             0.505    0.115    4.379    0.000</code></pre>
</div>
</div>
<p>The <strong>scalar invariance</strong> model (which adds constraints on intercepts) shows the following:</p>
<ul>
<li><p><strong>Fit indices</strong>: The <strong>CFI</strong> has dropped to 0.882 and <strong>TLI</strong> to 0.859, indicating a lower fit compared to the metric model. <strong>RMSEA</strong> increased to 0.107, which exceeds the acceptable threshold (0.10), suggesting a less satisfactory fit.</p></li>
<li><p><strong>SRMR</strong> is now 0.082.</p></li>
</ul>
<p>Overall, the model fit deteriorates, indicating that the intercepts might not be fully invariant across the two groups.</p>
</section><section id="strict-invariance" class="level3"><h3 class="anchored" data-anchor-id="strict-invariance">3.4. Strict Invariance</h3>
<p>Finally lets test the <strong>strict invariance</strong>.</p>
<div class="cell" data-code_folding="true">
<div class="code-with-filename">
<details class="code-fold"><summary>Code</summary><div class="code-with-filename-file">
<pre><strong></strong></pre>
</div>
<div class="sourceCode" id="cb13" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fit_strict</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/lavaan/man/cfa.html">cfa</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">HS.model</span>, data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">HolzingerSwineford1939</span>, group <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"school"</span>, group.equal <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"loadings"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"intercepts"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"residuals"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fit_strict</span>, fit.measures <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
</details>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 59 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        63
  Number of equality constraints                    24

  Number of observations per group:                   
    Pasteur                                        156
    Grant-White                                    145

Model Test User Model:
                                                      
  Test statistic                               181.511
  Degrees of freedom                                69
  P-value (Chi-square)                           0.000
  Test statistic for each group:
    Pasteur                                     93.093
    Grant-White                                 88.419

Model Test Baseline Model:

  Test statistic                               957.769
  Degrees of freedom                                72
  P-value                                        0.000

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.873
  Tucker-Lewis Index (TLI)                       0.867

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)              -3715.028
  Loglikelihood unrestricted model (H1)      -3624.272
                                                      
  Akaike (AIC)                                7508.055
  Bayesian (BIC)                              7652.632
  Sample-size adjusted Bayesian (SABIC)       7528.947

Root Mean Square Error of Approximation:

  RMSEA                                          0.104
  90 Percent confidence interval - lower         0.086
  90 Percent confidence interval - upper         0.123
  P-value H_0: RMSEA &lt;= 0.050                    0.000
  P-value H_0: RMSEA &gt;= 0.080                    0.984

Standardized Root Mean Square Residual:

  SRMR                                           0.088

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured


Group 1 [Pasteur]:

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  visual =~                                           
    x1                1.000                           
    x2      (.p2.)    0.591    0.104    5.691    0.000
    x3      (.p3.)    0.837    0.116    7.182    0.000
  textual =~                                          
    x4                1.000                           
    x5      (.p5.)    1.125    0.066   17.134    0.000
    x6      (.p6.)    0.933    0.056   16.752    0.000
  speed =~                                            
    x7                1.000                           
    x8      (.p8.)    1.121    0.151    7.424    0.000
    x9      (.p9.)    1.028    0.140    7.356    0.000

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  visual ~~                                           
    textual           0.367    0.094    3.915    0.000
    speed             0.174    0.065    2.666    0.008
  textual ~~                                          
    speed             0.176    0.062    2.827    0.005

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .x1      (.25.)    5.012    0.090   55.461    0.000
   .x2      (.26.)    6.133    0.077   79.814    0.000
   .x3      (.27.)    2.314    0.083   28.037    0.000
   .x4      (.28.)    2.784    0.086   32.193    0.000
   .x5      (.29.)    4.029    0.096   41.812    0.000
   .x6      (.30.)    1.927    0.081   23.747    0.000
   .x7      (.31.)    4.271    0.073   58.428    0.000
   .x8      (.32.)    5.622    0.072   78.502    0.000
   .x9      (.33.)    5.461    0.070   78.438    0.000

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .x1      (.10.)    0.638    0.102    6.249    0.000
   .x2      (.11.)    1.130    0.102   11.124    0.000
   .x3      (.12.)    0.771    0.090    8.608    0.000
   .x4      (.13.)    0.383    0.047    8.095    0.000
   .x5      (.14.)    0.435    0.057    7.616    0.000
   .x6      (.15.)    0.354    0.042    8.341    0.000
   .x7      (.16.)    0.769    0.080    9.571    0.000
   .x8      (.17.)    0.501    0.071    7.021    0.000
   .x9      (.18.)    0.576    0.069    8.353    0.000
    visual            0.767    0.164    4.686    0.000
    textual           0.894    0.131    6.827    0.000
    speed             0.340    0.085    4.016    0.000


Group 2 [Grant-White]:

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  visual =~                                           
    x1                1.000                           
    x2      (.p2.)    0.591    0.104    5.691    0.000
    x3      (.p3.)    0.837    0.116    7.182    0.000
  textual =~                                          
    x4                1.000                           
    x5      (.p5.)    1.125    0.066   17.134    0.000
    x6      (.p6.)    0.933    0.056   16.752    0.000
  speed =~                                            
    x7                1.000                           
    x8      (.p8.)    1.121    0.151    7.424    0.000
    x9      (.p9.)    1.028    0.140    7.356    0.000

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  visual ~~                                           
    textual           0.422    0.095    4.446    0.000
    speed             0.331    0.081    4.069    0.000
  textual ~~                                          
    speed             0.236    0.074    3.194    0.001

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .x1      (.25.)    5.012    0.090   55.461    0.000
   .x2      (.26.)    6.133    0.077   79.814    0.000
   .x3      (.27.)    2.314    0.083   28.037    0.000
   .x4      (.28.)    2.784    0.086   32.193    0.000
   .x5      (.29.)    4.029    0.096   41.812    0.000
   .x6      (.30.)    1.927    0.081   23.747    0.000
   .x7      (.31.)    4.271    0.073   58.428    0.000
   .x8      (.32.)    5.622    0.072   78.502    0.000
   .x9      (.33.)    5.461    0.070   78.438    0.000
    visual           -0.157    0.120   -1.316    0.188
    textual           0.575    0.118    4.888    0.000
    speed            -0.176    0.090   -1.958    0.050

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .x1      (.10.)    0.638    0.102    6.249    0.000
   .x2      (.11.)    1.130    0.102   11.124    0.000
   .x3      (.12.)    0.771    0.090    8.608    0.000
   .x4      (.13.)    0.383    0.047    8.095    0.000
   .x5      (.14.)    0.435    0.057    7.616    0.000
   .x6      (.15.)    0.354    0.042    8.341    0.000
   .x7      (.16.)    0.769    0.080    9.571    0.000
   .x8      (.17.)    0.501    0.071    7.021    0.000
   .x9      (.18.)    0.576    0.069    8.353    0.000
    visual            0.657    0.150    4.379    0.000
    textual           0.876    0.132    6.621    0.000
    speed             0.478    0.116    4.138    0.000</code></pre>
</div>
</div>
<p><strong>Fit Statistics:</strong></p>
<ul>
<li><p><strong>Chi-square (181.511, df = 69, p &lt; 0.001):</strong> Significant, indicating that strict invariance does not hold perfectly, but Chi-square is sensitive to large sample sizes.</p></li>
<li><p><strong>CFI (0.873) and TLI (0.867):</strong> Both are below 0.90, indicating a moderate fit. These indices suggest some misfit when imposing strict invariance.</p></li>
<li><p><strong>RMSEA (0.104):</strong> Exceeds the desired threshold of 0.10, suggesting that the model fit could be improved.</p></li>
<li><p><strong>SRMR (0.088):</strong> Slightly below the 0.10 threshold.</p></li>
</ul>
<p>Strict invariance constrains residuals to be equal across groups. Although the fit is not ideal, it is common for strict invariance to show worse fit compared to less restrictive models.</p>
</section></section><section id="evaluation" class="level2"><h2 class="anchored" data-anchor-id="evaluation">4. Evaluation</h2>
<p>We can all four models with anova() function:<br></p>
<div class="cell" data-code_folding="true">
<div class="code-with-filename">
<details class="code-fold"><summary>Code</summary><div class="code-with-filename-file">
<pre><strong></strong></pre>
</div>
<div class="sourceCode" id="cb15" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fit_configural</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fit_metric</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fit_scalar</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fit_strict</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
</details>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Chi-Squared Difference Test

               Df    AIC    BIC  Chisq Chisq diff    RMSEA Df diff Pr(&gt;Chisq)
fit_configural 48 7484.4 7706.8 115.85                                       
fit_metric     54 7480.6 7680.8 124.04      8.192 0.049272       6    0.22436
fit_scalar     60 7508.6 7686.6 164.10     40.059 0.194211       6  4.435e-07
fit_strict     69 7508.1 7652.6 181.51     17.409 0.078790       9    0.04269
                  
fit_configural    
fit_metric        
fit_scalar     ***
fit_strict     *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<ol type="1">
<li><p><strong>Configural Model</strong>: This is the baseline with good fit (Chisq = 115.85).</p></li>
<li><p><strong>Metric Model</strong>: No significant difference from the configural model (p = 0.224), suggesting factor loadings are invariant across groups.</p></li>
<li><p><strong>Scalar Model</strong>: Significant difference (p &lt; 0.001), implying that intercepts are not invariant across groups, indicating a potential bias.</p></li>
<li><p><strong>Strict Model</strong>: Marginally significant difference (p = 0.043), suggesting that residual variances also vary, reducing strict invariance.</p></li>
</ol>
<p>Overall, the scalar and strict invariance do not hold as strongly as the other two.</p>
<p>Let’s investigate all models in a chart and see how the model fit metrics deteriorates after each checkpoint.</p>
<div class="cell" data-code_folding="true">
<div class="code-with-filename">
<details class="code-fold"><summary>Code</summary><div class="code-with-filename-file">
<pre><strong></strong></pre>
</div>
<div class="sourceCode" id="cb17" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fitMeasures_df</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span></span>
<span>  Model <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Configural"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Metric"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Scalar"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Strict"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>,</span>
<span>  CFI <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.923</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.921</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.882</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.873</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>,</span>
<span>  RMSEA <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.097</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.093</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.107</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.104</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>,</span>
<span>  SRMR <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.068</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.072</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.082</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.088</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot with thresholds and legends</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fitMeasures_df</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Model</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">CFI</span>, color <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CFI"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>, size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">RMSEA</span>, color <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"RMSEA"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>, size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">SRMR</span>, color <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"SRMR"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>, size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">CFI</span>, group <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, color <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CFI"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">RMSEA</span>, group <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, color <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"RMSEA"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">SRMR</span>, group <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, color <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"SRMR"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span>  </span>
<span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add threshold lines</span></span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>yintercept <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.90</span>, linetype <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dashed"</span>, color <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blue"</span>, size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># CFI threshold</span></span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>yintercept <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.10</span>, linetype <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dashed"</span>, color <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tomato"</span>, size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># RMSEA &amp; SRMR threshold</span></span>
<span>  </span>
<span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Manual legend for threshold lines</span></span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"text"</span>, x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">4.5</span>, y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.91</span>, label <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"0.90"</span>, color <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blue"</span>, size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.5</span>, hjust <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"text"</span>, x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">4.5</span>, y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.09</span>, label <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"0.10"</span>, color <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tomato"</span>, size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.5</span>, hjust <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span>  </span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Fit Measures"</span>, x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Model Type"</span>, color <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Fit Index"</span>,</span>
<span>       title <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Comparison of Fit Measures Across Invariance Models with Thresholds"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
</details>
</div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="index_files/figure-html/unnamed-chunk-10-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="https://emrekaragul.com/posts/Measuerement Invariance/index_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>As you see, configural and metric invariance is fulfilled as their CFI levels are above 0.90, and RMSEA &amp; SRMR are below 0.10. Yet, scalar and strict invariance is slightly above the thresholds for RMSEA and SRMR and below for CFI.</p>
<p>These findings suggest some modifications might be a good idea on scalar and strict invariance models. Yet, model modifications are another blog post’s issue.</p>
</section><section id="conclusion" class="level2"><h2 class="anchored" data-anchor-id="conclusion">5. Conclusion</h2>
<p>In this blog post, we explored the concept of measurement invariance and its importance in ensuring that a test measures the same construct across different sub-groups of the population. Using the lavaan package in R, we conducted a series of tests to assess different levels of MI — configural, metric, scalar, and strict invariance — on the Holzinger and Swineford dataset.</p>
</section><section id="further-analysis" class="level2"><h2 class="anchored" data-anchor-id="further-analysis">6. Further Analysis</h2>
<p>As scalar and strict invariance is not completely fulfilled, modifications might be usefull on the model for better fit.</p>
<p>We have run an analysis on school variable. Measurement invariance can also be checked using the gender variable.</p>


</section> ]]></description>
  <category>lavaan</category>
  <category>semPlot</category>
  <category>ggplot2</category>
  <category>semTools</category>
  <guid>https://emrekaragul.com/posts/Measuerement Invariance/</guid>
  <pubDate>Mon, 14 Oct 2024 21:00:00 GMT</pubDate>
  <media:content url="https://emrekaragul.com/posts/Measuerement Invariance/measurement_invariance.png" medium="image" type="image/png" height="144" width="144"/>
</item>
<item>
  <title>Automated Essay Scoring (AES) with R</title>
  <dc:creator>Ali Emre Karagül</dc:creator>
  <link>https://emrekaragul.com/posts/Automated Essay Scoring (AES) with R/</link>
  <description><![CDATA[ <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mailchimp Subscription Modal</title>
<link href="//cdn-images.mailchimp.com/embedcode/classic-071822.css" rel="stylesheet" type="text/css">
<style>
        /* Modal Background */
        .modal {
            display: none; /* Hidden by default */
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5); /* Dimmed background */
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        #openModalBtn {
            background-color: tomato; /* background */
            color: white; /* White text */
            border: none; /* Remove border */
            padding: 10px 20px; /* Add padding */
            font-size: 24px; /* Adjust font size */
            border-radius: 5px; /* Rounded corners */
            cursor: pointer; /* Pointer cursor on hover */
            transition: background-color 0.3s ease; /* Smooth hover effect */
            width: 100%;
            margin-bottom: 20px; /* Add space after the button */
        }

        #openModalBtn:hover {
            background-color: rgb(255, 58, 23); /* Darker on hover */
        }
        /* Modal Content */
        .modal-content {
            background-color: #fff;
            padding: 20px;
            border-radius: 8px;
            max-width: 600px;
            width: 90%;
            text-align: center;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            overflow: auto;
        }

        /* Close Button */
        .close-btn {
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 20px;
            font-weight: bold;
            color: #aaa;
            cursor: pointer;
        }

        .close-btn:hover {
            color: #000;
        }
    </style>
<!-- Trigger Button --><button id="openModalBtn">Wanna subscribe?</button>


    <!-- Modal Structure -->
    <div id="subscriptionModal" class="modal">
        <div class="modal-content">
            <span class="close-btn">×</span>
            <!-- Mailchimp Signup Form -->
            <div>
                <div id="mc_embed_signup">
                    <form action="https://emrekaragul.us21.list-manage.com/subscribe/post?u=e72720e0214b2266cab41097e&amp;id=5cddb1a68e&amp;f_id=0038dfe1f0" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate="">
                        <div id="mc_embed_signup_scroll">
                            <h2 class="anchored">Submit your e-mail to subscribe!</h2>
                            <div class="mc-field-group">
                                <label for="mce-EMAIL">Email Address <span class="asterisk">*</span></label>
                                <input type="email" value="" name="EMAIL" class="required email" id="mce-EMAIL" required=""><span id="mce-EMAIL-HELPERTEXT" class="helper_text"></span>
                            </div>
                            <div id="mce-responses" class="clear foot">
                                <div class="response" id="mce-error-response" style="display:none"></div>
                                <div class="response" id="mce-success-response" style="display:none"></div>
                            </div>
                            
                            <div class="optionalParent">
                                <div class="clear foot">
                                    <input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button">
</div>
                            </div>
                        </div>
                    </form>
                </div>
                <script type="text/javascript" src="//s3.amazonaws.com/downloads.mailchimp.com/js/mc-validate.js"></script><script type="text/javascript">
                    (function($) {
                        window.fnames = new Array();
                        window.ftypes = new Array();
                        fnames[0] = 'EMAIL';
                        ftypes[0] = 'email';
                    }(jQuery));
                    var $mcj = jQuery.noConflict(true);
                </script><!--End mc_embed_signup-->
</div>
        </div>
    </div>

    <script>
        // Get the modal, button, and close elements
        const modal = document.getElementById("subscriptionModal");
        const openModalBtn = document.getElementById("openModalBtn");
        const closeBtn = document.querySelector(".close-btn");

        // Open the modal when the button is clicked
        openModalBtn.addEventListener("click", () => {
            modal.style.display = "flex"; // Show the modal
        });

        // Close the modal when the close button is clicked
        closeBtn.addEventListener("click", () => {
            modal.style.display = "none"; // Hide the modal
        });

        // Close the modal when clicking outside of it
        window.addEventListener("click", (e) => {
            if (e.target === modal) {
                modal.style.display = "none";
            }
        });
    </script><section id="introduction" class="level2"><h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>In the realm of education and standardized testing, technological advancements have brought forth a significant transformation. Among the noteworthy innovations in this field is the adoption of Automated Essay Scoring (AES), an approach that leverages the capabilities of natural language processing (NLP) and machine learning. AES holds the potential to redefine the essay evaluation and grading process, offering efficiency, consistency, and accessibility in a way previously unattainable.</p>
<p>At its essence, AES relies on sophisticated algorithms to examine written text, subjecting it to a predefined set of criteria. These criteria encompass various aspects, including grammar, sentence structure, vocabulary, coherence, and the quality of argumentation. In this regard, AES algorithms function akin to meticulous digital assessors, diligently seeking out patterns and features within the text. They assess elements such as the presence of persuasive thesis statements, the adept use of supporting evidence, and the logical flow of ideas within the essay. The result of this is a numerical score that reflects the overall quality of the essay in question.</p>
<p>Today we will develop a linear regression model to predict essay scores using the famous ASAP dataset. There are eight different essay types in this dataset to explore. Here we will use the essay set 2. Before you continue, please go and read the description and the details <a href="https://www.kaggle.com/competitions/asap-aes/data">on Kaggle.</a> As we will use only one essay set, I have preapared the data as a separate csv file and if you are already familiar with the ASAP data (or you have taken a look at the Kaggle page), please download the data for our use case from <a href="https://docs.google.com/spreadsheets/d/1xi-k1cJGADOgtp85sfJ4ZBr1P-YREhx_/edit?usp=sharing&amp;ouid=109837621769671436242&amp;rtpof=true&amp;sd=true">here</a>. The packages and some of their functions that we will be using in this topic are:</p>
<div class="cell" data-code_folding="false">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Requirements</strong></pre>
</div>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"><a href="https://github.com/rstudio/rmarkdown">"rmarkdown"</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> </span>
<span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># paged_table() </span></span>
<span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"><a href="https://readxl.tidyverse.org">"readxl"</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> </span>
<span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># read_excel()</span></span>
<span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"><a href="https://tidyverse.tidyverse.org">"tidyverse"</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> </span>
<span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"><a href="http://github.com/trinker/textstem">"textstem"</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> </span>
<span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># lemmatize_strings()</span></span>
<span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"><a href="https://github.com/quanteda/stopwords">"stopwords"</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> </span>
<span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># stopwords()</span></span>
<span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"><a href="https://stringr.tidyverse.org">"stringr"</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>   </span>
<span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># str_squish()</span></span>
<span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"><a href="https://tm.r-forge.r-project.org/">"tm"</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>        </span>
<span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># remove_words()</span></span>
<span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"><a href="https://quanteda.io">"quanteda"</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>  </span>
<span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># nsentence() </span></span></code></pre></div>
</div>
</div>
</section><section id="preprocessing" class="level2"><h2 class="anchored" data-anchor-id="preprocessing">1. Preprocessing</h2>
<p>Now that you have downloaded the data, move it to your working directory and follow along while reading. Let’s load the data and see the head of them:</p>
<div class="cell" data-code_folding="false">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong></strong></pre>
</div>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">essay_set_2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"essay_set_2.xlsx"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> </span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://pkgs.rstudio.com/rmarkdown/reference/paged_table.html">paged_table</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">essay_set_2</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># paged_table() function is for a beautified table view on this page. You don't need to use it on your own trial.</span></span></code></pre></div>
</div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["essay_id"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["essay_set"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["essay"],"name":[3],"type":["chr"],"align":["left"]},{"label":["rater1_domain1"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["rater2_domain1"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["domain1_score"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["rater1_domain2"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["rater2_domain2"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["domain2_score"],"name":[9],"type":["dbl"],"align":["right"]}],"data":[{"1":"2978","2":"2","3":"Certain materials being removed from libraries such as books, music and magazines, shouldn't be removed from the libraries. It gives people a chance to understand how the real world @CAPS2.     Having certain materials such as books and music definitly should not be removed, because most books and music can show most people how bad the statement in the book @CAPS2 or how bad the lyrics are in a song, and help that person to avoid that type of thing that the book or song @CAPS2 saying to the reader or listener. People should give every type of music at least a try and not always doubt what they hear about what people say about that type of music. I always hear about people saying how bad the band @PERSON1 A.M. @CAPS2, just because in the lyrics it talks about drugs and how much cursing each song has. Really the band @CAPS2 talking about one mans life and how he turns his life from being a drug addict to having the best life someone could ever live. People always doubted him and never gave his music a chance. Another example would be @PERSON1's book, '@CAPS1 @CAPS2 @CAPS3 @CAPS4' for it talks about drug addicts, homeless people, people who have been born with disfigured arms or even someone who lost there legs, and telling how beautiful each and everyone of them really are. His book taught me a few things and made me think different about people. It doesn't matter how they look or how they talk, no matter what, that person @CAPS2 beautiful.     As far as movies and magazines has gone within the last few years, I think that the also shouldn't be taken from libraries. I think @CAPS1 for the same reason of how I feel about the books and music. Of course we see previews of movies and think that they @MONTH1 not be good, but libraries shouldn't keep leave them out. Movies @CAPS2 a great way to learn how to treat others and how to act around other people when you don't know how to act. If you act differently around people that you've never been around before, then you could feel embarassed or maybe even get @CAPS4. Movies can help people learn about the real world by seeing how to do those type of things as we get older. Same goes with the magazines, they also help people see what not to do or to help them understand the consequences of something that shouldn't be done. Knowing what to do from a magazine could possible save your life or perhaps maybe even someone elses life.     I don't understand why some libraries would want to banned certain materials to help people understand the things that happen in someone elses life and to help them not make the same mistakes as that person once did.","4":"4","5":"4","6":"4","7":"4","8":"4","9":"4"},{"1":"2979","2":"2","3":"Write a persuasive essay to a newspaper reflecting your views on censorship in libraries. Do you believe that certain should be removed i think so be no that yes i think should no person that in chager the book, music, movies, magazines, ect., that be no agure      why do i think if you need that please  think i no thank you please if  i need why do we if know that if i failure the this test i who need to graduate please the children allow to home please yes.          Why do we need to be a prafece person please why do we need to do this why write this assgiment because you mean to be the best teaches ever and ever facebook is my password is @PERSON1  @NUM1 that why i need my myspace is the same thingh but different at same time please know that i need to know i really  i need to my e-mail address is  @EMAIL1 that is my e-mail please work m","4":"1","5":"2","6":"1","7":"1","8":"2","9":"1"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>The nine columns are:</p>
<ul>
<li><p><strong>essay_id:</strong> a unique identifier for the record.</p></li>
<li><p><strong>essay_set:</strong> That is set to 2 for all records in this dataset as we are working on essay set 2. We will get rid of this soon.</p></li>
<li><p><strong>essay:</strong> The text of the essay written by a real person.</p></li>
<li><p>There are also 6 more columns that include <strong>rater1_domain1, rater2_domain1, domain1_score, rater1_domain2, rater2_domain2,</strong> and <strong>domain2_score.</strong></p></li>
</ul>
<p>Lets see a sample essay which is randomly selected:<strong><br></strong></p>
<div class="cell" data-code_folding="false">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong></strong></pre>
</div>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1234</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">random_essay</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">essay_set_2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://pkgs.rstudio.com/rmarkdown/reference/paged_table.html">paged_table</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">essay_set_2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">random_essay</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
</div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["essay"],"name":[1],"type":["chr"],"align":["left"]}],"data":[{"1":"A lot of @CAPS3 today are censored because of the content in books, music, movies, and Magazines. I think that it all can be fixed if you have certain sections, @CAPS1 @CAPS2, and my views on the censorship of @CAPS3. Here's my idea to fix the problem.      I understand that books and other material @MONTH1 offend certain people, but it might not offend others. Thats why I think @CAPS3 should have a room for things that might offend certain people. The sign should say what content it has so the people can stay away from the room. There could be seperate rooms for children. It has nothing but children's books, movies, music, and magazines. Its a great idea because your child would'nt be open to the bad content.      This brings me to my next topic. You must be a certain @CAPS1 to enter the 'bad content' room. I dont think the library staff or their parents want a five-year old boy checking out a book that deals with sex, drugs, and alcohol. The library could get in a lot of trouble. The @CAPS1 @CAPS2 could be @NUM1 years of @CAPS1 to enter the room. That seems fair enough. Your old enough to be able to handle the content.      I dont get offended easily, so I can read just about anything. Like I suggested previously in the article, the bad content should be moved to a room so that people dont mistakenly come across it. I like reading about anything and everything, so I would love to read things and spark my attention. Books like that usually deal with bad things. I'm okay with that, but I understand that others are not.      Seperate rooms, @CAPS1 limits, and my views are all good ideas. Maybe a library will come across my article and do what I have said. I think that will be very affective. I hope to start seeing that in the future"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>We will use the <strong>essay</strong> and <strong>rater1_domain1</strong> columns for our analysis as we are just doing a research for demonstration purposes (of course, when you are working on a real life research case, there are many things that you have to take into consideration). The <strong>essay</strong> column is the text of the essay written by a real person and the <strong>rater1_domain1</strong> column is the score given to the essay by the first rater. We will rename these columns as <strong>response</strong> and <strong>score</strong> respectively. We will also create a new column called <strong>doc_id</strong> which will be a unique identifier for each essay in our case study.</p>
<div class="cell" data-code_folding="false">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong></strong></pre>
</div>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">set</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">essay_set_2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">essay</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">rater1_domain1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>response <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">essay</span>, score <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">rater1_domain1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">set</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">doc_id</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"doc"</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">set</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
</div>
</div>
<p>When you scrutinize the essays, you will see that there are some <span class="citation" data-cites="words">@words</span> in the text. These are the words that are replaced with private information about the students such as names, places or dates etc. Also, there are some non-alphabetic characters and capital letters. In order to make the essays ready to analysis, we will convert all the text to lowercase and remove the non-alphabetic characters. We will also remove the <a href="https://en.wikipedia.org/wiki/Stop_word">stopwords</a> and lemmatize the text.</p>
<div class="cell" data-code_folding="false">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong></strong></pre>
</div>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">set</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">processedResponse</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"@\\w+ *"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">set</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">response</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#remove @words</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">set</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">processedResponse</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"[^a-zA-Z]"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" "</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">set</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">processedResponse</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#remove non-alphabetic characters</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">set</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">processedResponse</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/chartr.html">tolower</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">set</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">processedResponse</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#convert to lowercase</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">set</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">processedResponse</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/textstem/man/lemmatize_strings.html">lemmatize_strings</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">set</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">processedResponse</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#lemmatize</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">en_stopwords</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stopwords</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/stopwords/man/stopwords.html">stopwords</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"en"</span>, source <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"stopwords-iso"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#get stopwords</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">set</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">processedResponse</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/tm/man/removeWords.html">removeWords</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">set</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">processedResponse</span>, words <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">en_stopwords</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#remove stopwords</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">set</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">processedResponse</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://stringr.tidyverse.org/reference/str_trim.html">str_squish</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">set</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">processedResponse</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#remove extra whitespaces</span></span></code></pre></div>
</div>
</div>
<p>Here how the new processed text looks like (the one we have seen above):</p>
<div class="cell" data-code_folding="false">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong></strong></pre>
</div>
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sample_essay</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/merge.html">merge</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">set</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">random_essay</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">set</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">random_essay</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://pkgs.rstudio.com/rmarkdown/reference/paged_table.html">paged_table</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sample_essay</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
</div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["processedResponse"],"name":[1],"type":["chr"],"align":["left"]},{"label":["response"],"name":[2],"type":["chr"],"align":["left"]}],"data":[{"1":"lot censor content book music movie magazine view censorship understand book material offend people offend offend people sign content people stay seperate child child book movie music magazine child bad content bring topic enter bad content library staff parent boy check book deal sex drug alcohol library lot trouble enter fair handle content offend easily read article bad content people mistakenly read love read spark attention book deal bad understand seperate limit view library article affective hope start future","2":"A lot of @CAPS3 today are censored because of the content in books, music, movies, and Magazines. I think that it all can be fixed if you have certain sections, @CAPS1 @CAPS2, and my views on the censorship of @CAPS3. Here's my idea to fix the problem.      I understand that books and other material @MONTH1 offend certain people, but it might not offend others. Thats why I think @CAPS3 should have a room for things that might offend certain people. The sign should say what content it has so the people can stay away from the room. There could be seperate rooms for children. It has nothing but children's books, movies, music, and magazines. Its a great idea because your child would'nt be open to the bad content.      This brings me to my next topic. You must be a certain @CAPS1 to enter the 'bad content' room. I dont think the library staff or their parents want a five-year old boy checking out a book that deals with sex, drugs, and alcohol. The library could get in a lot of trouble. The @CAPS1 @CAPS2 could be @NUM1 years of @CAPS1 to enter the room. That seems fair enough. Your old enough to be able to handle the content.      I dont get offended easily, so I can read just about anything. Like I suggested previously in the article, the bad content should be moved to a room so that people dont mistakenly come across it. I like reading about anything and everything, so I would love to read things and spark my attention. Books like that usually deal with bad things. I'm okay with that, but I understand that others are not.      Seperate rooms, @CAPS1 limits, and my views are all good ideas. Maybe a library will come across my article and do what I have said. I think that will be very affective. I hope to start seeing that in the future"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section><section id="feature-extraction" class="level2"><h2 class="anchored" data-anchor-id="feature-extraction">2. Feature Extraction</h2>
<p>Feature extraction is a critical component of Automated Essay Scoring (AES), serving as the foundation upon which the system’s evaluation process is built. In AES, feature extraction procedures involve the identification and analysis of various linguistic and structural elements within the essay. These elements may include but are not limited to word frequency, sentence length, syntactic complexity, vocabulary richness, and the presence of specific content-related markers like thesis statements or evidence citations. The goal of feature extraction is to distill the complex nature of written language into a set of quantifiable, machine-readable attributes that can be used by the AES algorithms to assess the quality and coherence of the essay. Through a combination of natural language processing and statistical analysis, feature extraction empowers AES systems to objectively evaluate essays, providing educators and test administrators with consistent, efficient, and data-driven grading outcomes.</p>
<p>For the sake of simplicity of demonstration, we will extract the following features: <strong>number of sentences</strong>, <strong>number of paragraphs</strong> and <strong>number of contextual words</strong>.</p>
<div class="cell" data-code_folding="false">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong></strong></pre>
</div>
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">set</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">n_sentence</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://quanteda.io/reference/nsentence.html">nsentence</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">set</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">response</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> </span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">set</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">n_paragraph</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://stringr.tidyverse.org/reference/str_count.html">str_count</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">set</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">response</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"     "</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> </span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">set</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">n_contextWords</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/lengths.html">lengths</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/strsplit.html">strsplit</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">set</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">processedResponse</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">' '</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">set</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 7
  response  score doc_id processedResponse n_sentence n_paragraph n_contextWords
  &lt;chr&gt;     &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;                  &lt;int&gt;       &lt;dbl&gt;          &lt;int&gt;
1 Certain …     4 doc1   material remove …         20           4            126
2 Write a …     1 doc2   write persuasive…          3           4             33
3 Do you t…     2 doc3   library remove m…         15           3             59
4 In @DATE…     4 doc4   offensive opinio…         31           5            111
5 In life …     4 doc5   life offensive s…         35          11            131
6 A lot of…     4 doc6   lot censor conte…         25           5             79</code></pre>
</div>
</div>
<p>As stated before, there might be many other features that can be extracted from the essays. We will continue our study with these 3 features even if they are not enough for a real life research.</p>
<p>Before we start building a machine learning model, we need to divide our dataset as training and test data.</p>
<div class="cell" data-code_folding="false">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong></strong></pre>
</div>
<div class="sourceCode" id="cb9" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">dataset</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">set</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">train_indices</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">dataset</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">dataset</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 70% for training</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">train_data</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">dataset</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">train_indices</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">test_data</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">dataset</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">train_indices</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span></span></code></pre></div>
</div>
</div>
</section><section id="linear-regression-model-lr" class="level2"><h2 class="anchored" data-anchor-id="linear-regression-model-lr">3. Linear Regression Model (LR)</h2>
<section id="what-is-linear-regression" class="level3"><h3 class="anchored" data-anchor-id="what-is-linear-regression">What is Linear Regression?</h3>
<p>Linear regression is a statistical model that examines the linear relationship between two (Simple Linear Regression ) or more (Multiple Linear Regression) variables — a dependent variable and independent variable(s). Linear relationship basically means that when one (or more) independent variables increases (or decreases), the dependent variable increases (or decreases) too. Linear regression models are used to show or predict the relationship between two variables or factors. The factor that is being predicted (the factor that the equation solves for) is called the dependent variable. The factors that are used to predict the value of the dependent variable are called the independent variables. The results of a LR model can be evaluated using statistical metrics such as <strong>Mean Squared Error (MSE)</strong>, <strong>Root Mean Squared Error (RMSE)</strong> and <strong>R-squared</strong>.</p>
<p>In our case, the dependent variable is the <strong>score</strong> and the independent variables are <strong>n_sentence</strong>, <strong>n_paragraph</strong> and <strong>n_contextWords</strong>.</p>
<div class="cell" data-code_folding="false">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Linear Model 1</strong></pre>
</div>
<div class="sourceCode" id="cb10" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">formula</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/stats/formula.html">as.formula</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"score ~ n_sentence + n_paragraph + n_contextWords"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model_1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">formula</span>, data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">train_data</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Print the summary of the model</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model_1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = formula, data = train_data)

Residuals:
     Min       1Q   Median       3Q      Max 
-2.52359 -0.36412  0.00356  0.40190  1.93435 

Coefficients:
                Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)    2.1864591  0.0418320  52.268  &lt; 2e-16 ***
n_sentence     0.0224310  0.0027105   8.276 3.23e-16 ***
n_paragraph    0.0023062  0.0034157   0.675      0.5    
n_contextWords 0.0076319  0.0005822  13.109  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.5595 on 1256 degrees of freedom
Multiple R-squared:  0.4701,    Adjusted R-squared:  0.4688 
F-statistic: 371.4 on 3 and 1256 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
</section><section id="performance-of-the-model-1" class="level3"><h3 class="anchored" data-anchor-id="performance-of-the-model-1">Performance of the Model 1</h3>
<p>Let’s investigate the output from the model one by one.</p>
<ol type="1">
<li>
<p><strong>Residuals:</strong> This section provides statistics about the residuals, which are the differences between the observed values and the predicted values by the model.</p>
<ul>
<li><p><strong>Min:</strong> The minimum residual value is -2.51929.</p></li>
<li><p><strong>1Q:</strong> The first quartile (25th percentile) of the residuals is -0.34048.</p></li>
<li><p><strong>Median:</strong> The median of the residuals is 0.00576.</p></li>
<li><p><strong>3Q:</strong> The third quartile (75th percentile) of the residuals is 0.37803.</p></li>
<li><p><strong>Max:</strong> The maximum residual value is 1.95369.</p></li>
</ul>
</li>
<li><p><strong>Coefficients:</strong> This section provides information about the coefficients of the linear regression model. Each row corresponds to a predictor variable (independent variable) in the model.</p></li>
<li><p><strong>Estimate:</strong> This is the estimated coefficient for each predictor. <strong>Std. Error:</strong> It represents the standard error of the coefficient estimate. <strong>t value:</strong> The t-value is a measure of how many standard errors the coefficient estimate is away from zero. <strong>Pr(&gt;|t|):</strong> This is the p-value associated with the t-value, which tells you whether the coefficient is statistically significant. In our model, we have three predictor variables: n_sentence, n_paragraph, and n_contextWords. The Estimate column represents the estimated coefficients for each of these predictors. The *** symbols indicate that these coefficients are highly statistically significant. In other words, the number of paragraph is not significantly valuable for the model while the number of sentences and the number of contextual words are highly significant.</p></li>
<li><p><strong>Multiple R-squared:</strong> This is a measure of how well the model fits the data. It tells you the proportion of the variance in the dependent variable that is explained by the independent variables. In our case, R-squared is approximately 0.4737, which means that about 47.37% of the variance in the dependent variable is explained by our predictors.</p></li>
<li><p><strong>Adjusted R-squared:</strong> This is a version of R-squared that adjusts for the number of predictors in the model. It is a slightly more conservative measure of goodness of fit.</p></li>
<li><p><strong>F-statistic:</strong> This is a measure of the overall significance of the model. It tests whether at least one of the predictor variables is significantly related to the dependent variable. A high F-statistic and a very low p-value (which is the case here) indicate that the model is significant.</p></li>
<li><p><strong>p-value:</strong> The p-value associated with the F-statistic. In this case, it’s extremely small, indicating that the overall model is highly significant.</p></li>
</ol></section><section id="comparison-of-model-1-and-model-2" class="level3"><h3 class="anchored" data-anchor-id="comparison-of-model-1-and-model-2">Comparison of Model 1 and Model 2</h3>
<p>Let’s build another model without the feature <strong>n_paragraph</strong> and compare the results.</p>
<div class="cell" data-code_folding="false">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Linear Model 2</strong></pre>
</div>
<div class="sourceCode" id="cb12" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">formula_2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/stats/formula.html">as.formula</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"score ~ n_sentence + n_contextWords"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model_2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">formula_2</span>, data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">train_data</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Print the summary of the model</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model_2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = formula_2, data = train_data)

Residuals:
     Min       1Q   Median       3Q      Max 
-2.51924 -0.36470  0.00476  0.39940  1.93587 

Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)    2.195033   0.039849  55.083   &lt;2e-16 ***
n_sentence     0.022599   0.002698   8.375   &lt;2e-16 ***
n_contextWords 0.007637   0.000582  13.123   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.5594 on 1257 degrees of freedom
Multiple R-squared:  0.4699,    Adjusted R-squared:  0.4691 
F-statistic: 557.1 on 2 and 1257 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p><strong>Residual standard error:</strong> The residual standard error is very close in both models, indicating that they have similar predictive accuracy. <strong>Multiple R-squared:</strong> The R-squared values are also very close. Model 2 has a slightly lower R-squared, but the difference is minimal. <strong>F-statistic:</strong> Model 2 has a higher F-statistic compared to Model 1, indicating that the predictors collectively have more explanatory power in Model 2.</p>
<p>In summary, both models are quite similar in terms of their coefficient estimates and predictive accuracy. Model 2 has a slightly higher F-statistic. Personally I agree with the model. The number of paragraphs should not be a predictor while estimating the score. The number of sentences and the number of contextual words are much more important.</p>
</section><section id="evaluation-of-model-2-with-the-test-dataset" class="level3"><h3 class="anchored" data-anchor-id="evaluation-of-model-2-with-the-test-dataset">Evaluation of Model 2 with the Test Dataset</h3>
<p>As we would like to continue with the second model, we can use the <code><a href="https://rdrr.io/r/stats/predict.html">predict()</a></code> to make predictions on the test data. The <code><a href="https://rdrr.io/r/stats/predict.html">predict()</a></code> function takes the model and the new data set as arguments. It returns a vector of predictions, which we will save in a new column in the test data set to make comparisons in the next stage. Now, let’s use the <code><a href="https://rdrr.io/r/base/mean.html">mean()</a></code> and <code><a href="https://rdrr.io/r/base/MathFun.html">sqrt()</a></code> functions to calculate the MSE and RMSE of the model. We can also use the <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code> function to get the R-squared value of the model.</p>
<div class="cell" data-code_folding="false">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong></strong></pre>
</div>
<div class="sourceCode" id="cb14" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Make predictions on the test data</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">predictions</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model_2</span>, newdata <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">test_data</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Evaluate the model</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">mse</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">test_data</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">score</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">predictions</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">rmse</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">mse</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">r_squared</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model_2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">r.squared</span></span>
<span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Printing evaluation metrics beautifully :D</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Mean Squared Error (MSE): "</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"%.2f"</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">mse</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"\n"</span>,</span>
<span>            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Root Mean Squared Error (RMSE): "</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"%.2f"</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">rmse</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"\n"</span>,</span>
<span>            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"R-squared (R²): "</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"%.2f"</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">r_squared</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"\n"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Mean Squared Error (MSE): 0.30
Root Mean Squared Error (RMSE): 0.54
R-squared (R²): 0.47</code></pre>
</div>
</div>
<ul>
<li><p><strong>MSE (Mean Squared Error):</strong> MSE is a measure of the average squared difference between the observed (actual) values and the predicted values by the model. It’s a measure of the model’s accuracy, with lower values indicating a better fit.</p></li>
<li><p><strong>RMSE (Root Mean Squared Error):</strong> RMSE is the square root of the MSE and provides a measure of the average error in the same units as the dependent variable. It’s a commonly used metric to quantify the prediction error of the model.</p></li>
<li><p><strong>R-squared (R²):</strong> R-squared is a measure of how well the independent variables explain the variability in the dependent variable. It ranges from 0 to 1, with higher values indicating a better fit. In the output, the R-squared is approximately 0.4736732, which means that about 47.37% of the variance in the dependent variable is explained by the independent variables in the model.</p></li>
</ul></section><section id="predictions-of-the-test-dataset" class="level3"><h3 class="anchored" data-anchor-id="predictions-of-the-test-dataset">Predictions of the Test Dataset</h3>
<p>Let’s take a look at the predictions of the test data. We can use the <code><a href="https://rdrr.io/r/utils/head.html">head()</a></code> function to print the first 10 predictions.</p>
<div class="cell" data-code_folding="false">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong></strong></pre>
</div>
<div class="sourceCode" id="cb16" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#merge predictions to test data:</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">test_data</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">predictions</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">predictions</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">test_data</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>,<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"score"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"predictions"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 2
   score predictions
   &lt;dbl&gt;       &lt;dbl&gt;
 1     4           4
 2     1           3
 3     2           3
 4     4           4
 5     5           4
 6     2           4
 7     4           3
 8     3           3
 9     3           3
10     3           2</code></pre>
</div>
</div>
<p>But looking at the raw data would never be enough to get some insights. Let’s also print the confusion matrix to get a better overall picture. The <strong>confusion matrix</strong> is a table that is often used to describe the performance of a classification model on a set of test data for which the true values are known. It allows the visualization of the performance of an algorithm. The confusion matrix shows the ways in which the model is confused when it makes predictions. It gives us insight not only into the errors being made by a classifier but more importantly the types of errors that are being made.</p>
<div class="cell" data-code_folding="false">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong></strong></pre>
</div>
<div class="sourceCode" id="cb18" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create the confusion matrix and print it</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">confusion_matrix</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">test_data</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">predictions</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">test_data</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">score</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">confusion_matrix</span></span></code></pre></div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   
      1   2   3   4   5   6
  2   7  13   1   0   0   0
  3   2  35 186  85   1   0
  4   0   1  30 148  14   0
  5   0   0   0   7   8   0
  6   0   0   0   0   1   1</code></pre>
</div>
</div>
<p>In this context, the confusion matrix helps us understand the model’s performance in grading essays. It indicates which score points are frequently confused with others, providing insights into where the model might need improvement. For instance, score points 3 and 4 appear to be frequently confused with each other. Yet, I believe that is not a big deal. Confusing a high score such as 6 with a lower score such as 2 would be a catastrophe in AES context, but here we don’t even have one such a case. Besides confusion matrix, one can calculate performance metrics such as accuracy, precision, recall, and F1-score to get a more comprehensive assessment of the model’s grading performance.</p>
</section></section><section id="conclusion" class="level2"><h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<p>Our exploration into AES has shed light on the impressive potential of this technology in revolutionizing the evaluation of written content. Our application of a Linear Regression model, even when considering a limited set of extracted features such as the number of words, sentences, and paragraphs, demonstrated the robustness of this approach. It is evident that by harnessing machine learning algorithms, we can achieve consistent and objective grading, streamlining the assessment process for educators and administrators.</p>
<p>However, it’s important to note that Linear Regression is just one of the many models available for AES. The field of automated essay scoring continues to evolve, and researchers are exploring a range of models and techniques to enhance accuracy and broaden the scope of assessment. Some alternatives to LR include Support Vector Machines (SVM), Random Forests, Neural Networks, and Natural Language Processing models like Recurrent Neural Networks (RNNs) or Transformers, such as BERT and GPT-3. These models bring their unique strengths and capabilities to the table, offering a diverse array of tools for essay evaluation.</p>
<p>As AES advances, the synergy of these models with increasingly sophisticated feature extraction procedures promises to further elevate the quality and reliability of automated essay scoring. With this, we look to a future where technology and human expertise collaborate seamlessly to offer more efficient, accurate, and comprehensive assessment in the realm of written expression.</p>


</section> ]]></description>
  <category>readxl</category>
  <category>textstem</category>
  <category>stopwords</category>
  <category>stringr</category>
  <category>quanteda</category>
  <category>tm</category>
  <category>tidyverse</category>
  <guid>https://emrekaragul.com/posts/Automated Essay Scoring (AES) with R/</guid>
  <pubDate>Sun, 22 Oct 2023 21:00:00 GMT</pubDate>
  <media:content url="https://emrekaragul.com/posts/Automated Essay Scoring (AES) with R/image.png" medium="image" type="image/png" height="144" width="144"/>
</item>
<item>
  <title>Top 5 Data Sources</title>
  <dc:creator>Ali Emre Karagül</dc:creator>
  <link>https://emrekaragul.com/posts/Top 5 Data Sources/</link>
  <description><![CDATA[ 






    <meta charset="UTF-8">

    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Mailchimp Subscription Modal</title>

    <link href="//cdn-images.mailchimp.com/embedcode/classic-071822.css" rel="stylesheet" type="text/css">

    <style>

        /* Modal Background */

        .modal {

            display: none; /* Hidden by default */

            position: fixed;

            top: 0;

            left: 0;

            width: 100%;

            height: 100%;

            background-color: rgba(0, 0, 0, 0.5); /* Dimmed background */

            z-index: 1000;

            justify-content: center;

            align-items: center;

        }

        #openModalBtn {

            background-color: tomato; /* background */

            color: white; /* White text */

            border: none; /* Remove border */

            padding: 10px 20px; /* Add padding */

            font-size: 24px; /* Adjust font size */

            border-radius: 5px; /* Rounded corners */

            cursor: pointer; /* Pointer cursor on hover */

            transition: background-color 0.3s ease; /* Smooth hover effect */

            width: 100%;

            margin-bottom: 20px; /* Add space after the button */

        }



        #openModalBtn:hover {

            background-color: rgb(255, 58, 23); /* Darker on hover */

        }

        /* Modal Content */

        .modal-content {

            background-color: #fff;

            padding: 20px;

            border-radius: 8px;

            max-width: 600px;

            width: 90%;

            text-align: center;

            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);

            overflow: auto;

        }



        /* Close Button */

        .close-btn {

            position: absolute;

            top: 15px;

            right: 15px;

            font-size: 20px;

            font-weight: bold;

            color: #aaa;

            cursor: pointer;

        }



        .close-btn:hover {

            color: #000;

        }

    </style>





    <!-- Trigger Button -->

    <button id="openModalBtn">Wanna subscribe?</button>





    <!-- Modal Structure -->

    <div id="subscriptionModal" class="modal">

        <div class="modal-content">

            <span class="close-btn">×</span>

            <!-- Mailchimp Signup Form -->

            <div>

                <div id="mc_embed_signup">

                    <form action="https://emrekaragul.us21.list-manage.com/subscribe/post?u=e72720e0214b2266cab41097e&amp;id=5cddb1a68e&amp;f_id=0038dfe1f0" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate="">

                        <div id="mc_embed_signup_scroll">

                            <h2 class="anchored">Submit your e-mail to subscribe!</h2>

                            <div class="mc-field-group">

                                <label for="mce-EMAIL">Email Address <span class="asterisk">*</span></label>

                                <input type="email" value="" name="EMAIL" class="required email" id="mce-EMAIL" required="">

                                <span id="mce-EMAIL-HELPERTEXT" class="helper_text"></span>

                            </div>

                            <div id="mce-responses" class="clear foot">

                                <div class="response" id="mce-error-response" style="display:none"></div>

                                <div class="response" id="mce-success-response" style="display:none"></div>

                            </div>

                            

                            <div class="optionalParent">

                                <div class="clear foot">

                                    <input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button">

                                </div>

                            </div>

                        </div>

                    </form>

                </div>

                <script type="text/javascript" src="//s3.amazonaws.com/downloads.mailchimp.com/js/mc-validate.js"></script>

                <script type="text/javascript">

                    (function($) {

                        window.fnames = new Array();

                        window.ftypes = new Array();

                        fnames[0] = 'EMAIL';

                        ftypes[0] = 'email';

                    }(jQuery));

                    var $mcj = jQuery.noConflict(true);

                </script>

                <!--End mc_embed_signup-->

            </div>

        </div>

    </div>



    <script>

        // Get the modal, button, and close elements

        const modal = document.getElementById("subscriptionModal");

        const openModalBtn = document.getElementById("openModalBtn");

        const closeBtn = document.querySelector(".close-btn");



        // Open the modal when the button is clicked

        openModalBtn.addEventListener("click", () => {

            modal.style.display = "flex"; // Show the modal

        });



        // Close the modal when the close button is clicked

        closeBtn.addEventListener("click", () => {

            modal.style.display = "none"; // Hide the modal

        });



        // Close the modal when clicking outside of it

        window.addEventListener("click", (e) => {

            if (e.target === modal) {

                modal.style.display = "none";

            }

        });

    </script>










<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>In the world of data analysis, having access to quality data sources can make all the difference. Whether you’re a researcher, a business owner, or just someone who loves playing with numbers, finding the right data can help you uncover insights and make better decisions. With so many data sources available online, it can be hard to know where to start. In this blog post, I’ll be sharing my top 5 favorite data sources, each of which I’ve found to be reliable, user-friendly, and full of valuable information. From the Cloud Google Marketplace to the Bureau of Labor Statistics, these data sources offer a wealth of insights that I hope you’ll find as useful and inspiring as I have. So without further ado, let’s dive in!</p>
</section>
<section id="cloud-google-marketplace" class="level2">
<h2 class="anchored" data-anchor-id="cloud-google-marketplace">1. <a href="https://console.cloud.google.com/marketplace/browse?filter=solution-type:dataset&amp;pli=1" title="Cloud Google Marketplace">Cloud Google Marketplace</a></h2>
<p>The Cloud Google Marketplace is a collection of datasets, APIs, and applications that are hosted on the Google Cloud Platform. The marketplace offers a wide range of data sources from different industries, including finance, healthcare, and transportation. Some of the popular datasets available on the Cloud Google Marketplace include:</p>
<ul>
<li><p>COVID-19 Open Research Dataset (CORD-19)</p></li>
<li><p>New York City Taxi and Limousine Commission (TLC) Trip Data</p></li>
<li><p>Chicago Crime Data</p></li>
<li><p>OpenFDA Drug Label API</p></li>
<li><p>US Census Bureau Data</p></li>
</ul>
<p>The platform offers an intuitive interface that allows users to search for datasets, preview data, and access documentation. The marketplace also provides access to cloud-based tools for data exploration, visualization, and analysis.</p>
</section>
<section id="drought.gov" class="level2">
<h2 class="anchored" data-anchor-id="drought.gov">2. <a href="https://www.drought.gov/data-maps-tools" title="Drought.gov data maps tools">Drought.gov</a></h2>
<p>Drought.gov is a comprehensive resource for drought-related data, maps, and tools in the United States. The website provides a variety of data sources, including:</p>
<ul>
<li><p>Drought Monitor</p></li>
<li><p>Soil Moisture Active Passive (SMAP) data</p></li>
<li><p>Evaporative Demand Drought Index (EDDI)</p></li>
<li><p>U.S. Drought Atlas</p></li>
</ul>
<p>The website offers easy access to a wide range of data, including both historical and real-time data. Additionally, the site provides a number of interactive maps and visualizations that make it easy to explore the data and gain insights.</p>
</section>
<section id="unicef-statistical-tables" class="level2">
<h2 class="anchored" data-anchor-id="unicef-statistical-tables">3. <a href="https://data.unicef.org/resources/dataset/sowc-2019-statistical-tables/" title="UNICEF Statistical Tables">UNICEF Statistical Tables</a></h2>
<p>UNICEF Statistical Tables is a data source that provides a wide range of data on child welfare and development across the globe. The data is collected from various sources, including national surveys and administrative records. Some of the data available on the UNICEF Statistical Tables includes:</p>
<ul>
<li><p>Child mortality rates</p></li>
<li><p>Nutrition indicators</p></li>
<li><p>Education indicators</p></li>
<li><p>Child protection indicators</p></li>
</ul>
<p>The platform offers a user-friendly interface that allows users to browse data by country, indicator, or year. For instance, policymakers looking to design effective policies to improve child welfare in their countries could use data from UNICEF Statistical Tables to identify areas where interventions are most needed, such as high child mortality rates or low school enrollment rates.</p>
</section>
<section id="openpolicing.stanford.edu" class="level2">
<h2 class="anchored" data-anchor-id="openpolicing.stanford.edu">4. <a href="https://openpolicing.stanford.edu/data/" title="Stanford's data bank">OpenPolicing.Stanford.edu</a></h2>
<p>OpenPolicing.Stanford.edu is a data source that provides access to millions of records of police stops and searches across the United States. The data is collected from various law enforcement agencies and compiled into a standardized format for analysis. The platform also provides tools for exploring the data, including interactive maps and dashboards. As this source of data contains pretty complicate information, you should definitely check the <a href="before you delve into this data," title="git-hub link">Read Me File</a> before you delve into it.</p>
<p>The platform provides detailed data on police stops and searches, including the race and ethnicity of the individuals involved, the reason for the stop, and the outcome of the encounter.</p>
<p>One example of how this data could be used is to identify patterns of racial bias in policing. By analyzing the data on police stops and searches, researchers can identify whether certain racial or ethnic groups are more likely to be stopped or searched than others, and whether these disparities are driven by legitimate factors (such as crime rates) or by bias.</p>
</section>
<section id="bureau-of-labor-statistics-bls-tables" class="level2">
<h2 class="anchored" data-anchor-id="bureau-of-labor-statistics-bls-tables">5. <a href="https://www.bls.gov/cps/tables.htm" title="BLS Tables">Bureau of Labor Statistics (BLS) Tables</a></h2>
<p>The Bureau of Labor Statistics (BLS) Tables is a data source that provides access to a wide range of data on the U.S. labor market. The platform offers a wealth of data, including:</p>
<ul>
<li><p>Unemployment rates</p></li>
<li><p>Employment by industry and occupation</p></li>
<li><p>Labor force participation rates</p></li>
<li><p>Average wages and salaries</p></li>
<li><p>Job openings and hires</p></li>
</ul>
<p>The platform provides a variety of tools for data exploration and analysis, including charts, tables, and interactive visualizations. For example, if you’re a policymaker looking to design policies that promote job growth and reduce unemployment, you could use BLS Tables data to identify which industries are experiencing job growth, which occupations are in high demand, and which regions have the highest unemployment rates.</p>
</section>
<section id="an-easter-egg-openpsychometrics.org" class="level2">
<h2 class="anchored" data-anchor-id="an-easter-egg-openpsychometrics.org">An Easter Egg: <a href="https://openpsychometrics.org/" title="Open Psychometrics">OpenPsychometrics.org</a></h2>
<p>As a surprise addition to my list of favorite data sources, I would like to introduce OpenPsychometrics.org. I came across with this website during a Ph.D.&nbsp;course on Item Response Theory carried by Associate Professor Ergül Demir. This website provides access to a collection of free psychological tests and assessments, which can be used for a wide range of purposes, from self-reflection to academic research.</p>
<p>Some of the psychological tests available on the site include:</p>
<ul>
<li><p>The Big Five personality traits</p></li>
<li><p>Emotional intelligence</p></li>
<li><p>Cognitive abilities</p></li>
<li><p>Moral reasoning</p></li>
</ul>
<p>As someone who is interested in both data science and psychology, I have found OpenPsychometrics.org to be an incredibly interesting and valuable resource. The website offers a wide range of psychological tests that can help individuals gain insights into their own personality traits, cognitive abilities, and emotional intelligence. Additionally, researchers can use the site to conduct studies on these topics and collect data for analysis.</p>
<p>In conclusion, OpenPsychometrics.org is a valuable resource for anyone interested in psychology, personal development, or academic research. The platform offers a variety of free psychological tests that can help individuals gain insights into themselves, as well as collect data for research purposes.</p>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<p>These are just a few of my favorite data sources that have proven to be invaluable for my work as a researcher. Each of these data sources provides a unique perspective on different aspects of the world, from labor markets to child welfare to police behavior. By combining and analyzing data from these sources, we can gain a more comprehensive understanding of the world around us and make better-informed decisions.</p>


</section>

 ]]></description>
  <guid>https://emrekaragul.com/posts/Top 5 Data Sources/</guid>
  <pubDate>Sun, 26 Mar 2023 21:00:00 GMT</pubDate>
  <media:content url="https://emrekaragul.com/posts/Top 5 Data Sources/image.png" medium="image" type="image/png" height="144" width="144"/>
</item>
<item>
  <title>Item difficulty &amp; discrimination: Exploring the psychometric properties using R</title>
  <dc:creator>Ali Emre Karagül</dc:creator>
  <link>https://emrekaragul.com/posts/Exploring the psychometric properties using R/</link>
  <description><![CDATA[ <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mailchimp Subscription Modal</title>
<link href="//cdn-images.mailchimp.com/embedcode/classic-071822.css" rel="stylesheet" type="text/css">
<style>
        /* Modal Background */
        .modal {
            display: none; /* Hidden by default */
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5); /* Dimmed background */
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        #openModalBtn {
            background-color: tomato; /* background */
            color: white; /* White text */
            border: none; /* Remove border */
            padding: 10px 20px; /* Add padding */
            font-size: 24px; /* Adjust font size */
            border-radius: 5px; /* Rounded corners */
            cursor: pointer; /* Pointer cursor on hover */
            transition: background-color 0.3s ease; /* Smooth hover effect */
            width: 100%;
            margin-bottom: 20px; /* Add space after the button */
        }

        #openModalBtn:hover {
            background-color: rgb(255, 58, 23); /* Darker on hover */
        }
        /* Modal Content */
        .modal-content {
            background-color: #fff;
            padding: 20px;
            border-radius: 8px;
            max-width: 600px;
            width: 90%;
            text-align: center;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            overflow: auto;
        }

        /* Close Button */
        .close-btn {
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 20px;
            font-weight: bold;
            color: #aaa;
            cursor: pointer;
        }

        .close-btn:hover {
            color: #000;
        }
    </style>
<!-- Trigger Button --><button id="openModalBtn">Wanna subscribe?</button>


    <!-- Modal Structure -->
    <div id="subscriptionModal" class="modal">
        <div class="modal-content">
            <span class="close-btn">×</span>
            <!-- Mailchimp Signup Form -->
            <div>
                <div id="mc_embed_signup">
                    <form action="https://emrekaragul.us21.list-manage.com/subscribe/post?u=e72720e0214b2266cab41097e&amp;id=5cddb1a68e&amp;f_id=0038dfe1f0" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate="">
                        <div id="mc_embed_signup_scroll">
                            <h2 class="anchored">Submit your e-mail to subscribe!</h2>
                            <div class="mc-field-group">
                                <label for="mce-EMAIL">Email Address <span class="asterisk">*</span></label>
                                <input type="email" value="" name="EMAIL" class="required email" id="mce-EMAIL" required=""><span id="mce-EMAIL-HELPERTEXT" class="helper_text"></span>
                            </div>
                            <div id="mce-responses" class="clear foot">
                                <div class="response" id="mce-error-response" style="display:none"></div>
                                <div class="response" id="mce-success-response" style="display:none"></div>
                            </div>
                            
                            <div class="optionalParent">
                                <div class="clear foot">
                                    <input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button">
</div>
                            </div>
                        </div>
                    </form>
                </div>
                <script type="text/javascript" src="//s3.amazonaws.com/downloads.mailchimp.com/js/mc-validate.js"></script><script type="text/javascript">
                    (function($) {
                        window.fnames = new Array();
                        window.ftypes = new Array();
                        fnames[0] = 'EMAIL';
                        ftypes[0] = 'email';
                    }(jQuery));
                    var $mcj = jQuery.noConflict(true);
                </script><!--End mc_embed_signup-->
</div>
        </div>
    </div>

    <script>
        // Get the modal, button, and close elements
        const modal = document.getElementById("subscriptionModal");
        const openModalBtn = document.getElementById("openModalBtn");
        const closeBtn = document.querySelector(".close-btn");

        // Open the modal when the button is clicked
        openModalBtn.addEventListener("click", () => {
            modal.style.display = "flex"; // Show the modal
        });

        // Close the modal when the close button is clicked
        closeBtn.addEventListener("click", () => {
            modal.style.display = "none"; // Hide the modal
        });

        // Close the modal when clicking outside of it
        window.addEventListener("click", (e) => {
            if (e.target === modal) {
                modal.style.display = "none";
            }
        });
    </script><section id="introduction" class="level2"><h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>Developing and validating psychological measures requires examining their psychometric properties, including their reliability and validity. One aspect of a measure’s validity is its item difficulty, which refers to how easy or difficult each individual item is for respondents to answer correctly. Another important aspect is item discrimination, which measures the extent to which each item distinguishes between participants who have high or low levels of the construct being measured.</p>
<p>Understanding item difficulty and item discrimination is crucial for several reasons. First, items that are too easy or too difficult can limit the variability of responses, making it harder to discriminate between participants who have different levels of the construct being measured. Second, items with low discrimination may not effectively differentiate between participants with different levels of the construct, leading to decreased validity.</p>
<p>In this blog post, we’ll explore how to calculate item difficulty and item discrimination in R using <a href="https://drive.google.com/file/d/1Roi2GScsgL_p1j3n0wgO5R8M9LdNlrkZ/view?usp=sharing">an example dataset</a>. We’ll explain what each of these psychometric properties are, why they’re important, and how to interpret the results. We’ll also discuss some limitations and considerations when examining these properties. So let’s get started!</p>
<p>The dataset is generated via <a href="https://erguldemir.shinyapps.io/ED_GenerateIRTdata/">this web application</a> based on Item Response Theory 2-Parameter Logistic Model. The dataset consists of randomly generated 40 items with a sample size of 500. The a-parameters of the items vary between 0.8 and 1.3 while b-parameters vary between -3 and 3. The c and d parameters are fixed to 0 and 1 respectively for all items.</p>
<p>Here are the package(s) we use in this post:</p>
<div class="cell" data-code_folding="false">
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;"><a href="https://www.r-project.org">multilevel</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;"><a href="https://www.ShinyItemAnalysis.org">ShinyItemAnalysis</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
</div>
</section><section id="item-difficulty" class="level2"><h2 class="anchored" data-anchor-id="item-difficulty">Item Difficulty</h2>
<p>Item difficulty is a psychometric property that measures how easy or difficult an item is for respondents to answer correctly. Examining item difficulty is important because it can help identify items that are too easy or too difficult, which can limit the variability of responses and make it harder to discriminate between participants who have different levels of the construct being measured.</p>
<p>The proportion of correct responses for each item is calculated and reported as the item difficulty value. This calculation can be done manually using spreadsheet software or programmatically using statistical software such as R or SPSS. R has many packages and functions out there that we can use to calculate item difficulties. Yet we will calculate them simply with <code><a href="https://rdrr.io/r/base/colSums.html">colMeans()</a></code> function.</p>
<p>Let’s start by introducing the dataset to R environment.</p>
<div class="cell" data-code_folding="false">
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">my_data</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data for post about item difficulty and discrimination.csv"</span>,sep<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">";"</span>, header <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">my_data</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> </span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  i1 i2 i3 i4 i5 i6 i7 i8 i9 i10 i11 i12 i13 i14 i15 i16 i17 i18 i19 i20 i21
1  0  1  1  1  0  0  1  0  0   1   1   0   1   1   1   1   0   0   0   0   0
2  0  1  1  1  0  0  1  0  0   1   0   0   1   0   1   1   1   1   0   1   0
3  0  1  1  1  0  0  1  1  1   1   1   0   1   1   1   1   1   1   1   1   0
4  1  1  0  0  0  0  0  0  0   1   0   0   1   1   0   1   1   0   0   0   0
5  0  1  1  1  0  0  0  0  1   1   1   1   1   1   1   1   1   1   0   0   0
6  0  1  1  1  1  1  1  1  1   1   1   1   1   1   0   1   1   0   0   0   1
  i22 i23 i24 i25 i26 i27 i28 i29 i30 i31 i32 i33 i34 i35 i36 i37 i38 i39 i40
1   0   0   1   1   1   0   1   0   0   0   1   0   1   0   1   0   1   1   0
2   0   0   1   1   1   0   0   0   0   0   0   1   1   0   1   0   0   1   1
3   0   0   1   1   1   0   1   0   0   0   1   1   1   1   1   0   1   1   1
4   0   0   0   1   1   0   1   0   0   0   0   0   1   0   0   0   0   1   1
5   0   0   1   1   1   1   0   0   0   0   1   1   1   1   1   0   0   1   1
6   0   0   1   1   1   0   1   1   0   0   1   1   1   1   1   1   1   1   1</code></pre>
</div>
</div>
<p>Now let’s get the item difficulties:</p>
<div class="cell" data-code_folding="false">
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calculate item difficulty</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">item_difficulty</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/colSums.html">colMeans</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">my_data</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">item_difficulty</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   i1    i2    i3    i4    i5    i6    i7    i8    i9   i10   i11   i12   i13 
0.212 0.918 0.910 0.782 0.112 0.394 0.742 0.400 0.862 0.870 0.774 0.386 0.882 
  i14   i15   i16   i17   i18   i19   i20   i21   i22   i23   i24   i25   i26 
0.682 0.594 0.928 0.722 0.384 0.174 0.346 0.512 0.176 0.100 0.682 0.900 0.882 
  i27   i28   i29   i30   i31   i32   i33   i34   i35   i36   i37   i38   i39 
0.264 0.536 0.148 0.044 0.046 0.918 0.638 0.946 0.610 0.800 0.146 0.566 0.928 
  i40 
0.952 </code></pre>
</div>
</div>
<p>Interpreting the results of item difficulty is straightforward. Items with higher difficulty values indicate that they were easier for participants to answer correctly, while items with lower difficulty values were more difficult. In our example dataset, the output shows that item 40 had the highest difficulty value of 0.952, meaning that 95.2% of participants answered this item correctly. Item 30, on the other hand, had the lowest difficulty value of 0.044, meaning that only 4.4% of participants answered this item correctly.</p>
<p>It’s important to note that each construct should be evaluated within its own concept while interpreting item difficulties. Yet, for achievement tests, a generic classification might be defined as <strong>“easy” if the index is 0.85 or above; “moderate” if it is between 0.41 and 0.84; and “hard” if it is 0.40 or below</strong>. Also, item difficulty is not the only factor to consider when evaluating the quality of a measure. Items that are too easy or too difficult may still be valid and reliable, depending on the construct being measured and the purpose of the measure. However, examining item difficulty can provide valuable insights into the psychometric properties of the measure and inform decisions about item selection and revision.</p>
</section><section id="item-discrimination" class="level2"><h2 class="anchored" data-anchor-id="item-discrimination">Item Discrimination</h2>
<p>Item discrimination is another important psychometric property that measures the extent to which each item differentiates between participants who have high or low levels of the construct being measured. It indicates how well an item distinguishes between participants with different levels of the construct.</p>
<p>It’s important to note that (just like item difficulties) each construct should be evaluated within its own concept while interpreting item discriminations. Yet, for achievement tests, a generic classification might be defined as <strong>“good” if the index is above 0.30; “fair” if it is between 0.10 and 0.30; and “poor” if it is below</strong> <strong>0.10.</strong></p>
<p>To obtain a value for item discrimination, there are several statistical approaches that we can utilize. Here we will discuss (1) correlation between item and total score with the item, (2) correlation between item and total score without the item, and (3) upper-lower groups index.</p>
<section id="correlation-between-item-and-total-score-with-the-item" class="level3"><h3 class="anchored" data-anchor-id="correlation-between-item-and-total-score-with-the-item">1. Correlation between item and total score with the item</h3>
<p>This approach is based on calculating the point-biserial correlation coefficient (rpb) between each item and the total score of the measure. The total score is calculated by summing the scores of all items. The rpb ranges from -1 to 1, with values closer to 1 indicating higher discrimination.</p>
<p>Let’s first calculate the total score for each participant in our example dataset. Then, use a for loop to calculate rpb coefficients for each item:</p>
<div class="cell" data-code_folding="false">
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#get the total score for each participant</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">total_score</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/colSums.html">rowSums</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">my_data</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span></span>
<span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#There are 40 items in the test:</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">item_discrimination1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">40</span>  </span>
<span></span>
<span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#calculate rpb for each item:</span></span>
<span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">i</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">40</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>        </span>
<span>  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">item_discrimination1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">i</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">total_score</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">my_data</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>,<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">i</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>  </span>
<span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">item_discrimination1</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 0.3984 0.2162 0.2308 0.4485 0.3019 0.4847 0.4148 0.4548 0.2796 0.3335
[11] 0.4498 0.5138 0.2735 0.4336 0.4423 0.1956 0.4288 0.4133 0.3297 0.4214
[21] 0.4909 0.3174 0.3222 0.4098 0.3312 0.3464 0.3737 0.4876 0.2481 0.2257
[31] 0.1783 0.3536 0.4094 0.2837 0.3893 0.3888 0.3962 0.5025 0.2866 0.1906</code></pre>
</div>
</div>
</section><section id="correlation-between-item-and-total-score-without-the-item" class="level3"><h3 class="anchored" data-anchor-id="correlation-between-item-and-total-score-without-the-item">2. Correlation between item and total score without the item</h3>
<p>This approach is very similar to the first one. The only difference is that when we calculate the correlation between an item and the total score, we do not include the item. This type of an approach will result in slightly reduced index values when compared to the first approach. Therefore, it is usually a more-preferred approach by test developers (we would love to stay in the safe-zone).</p>
<p>The package <code>multilevel</code> has a specific function for this index. The <code>item.total()</code> function takes only the dataset as input and provides us with a dataframe with four columns: item name, discrimination index, a reliability index without the item and the sample size. Yet, we only need the discrimination index. Here how we get it:</p>
<div class="cell" data-code_folding="false">
<div class="sourceCode" id="cb8" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">item_discrimination2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">multilevel</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">item.total</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">my_data</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">item_discrimination2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Item.Total</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 0.3365024 0.1703597 0.1832279 0.3887597 0.2511883 0.4160659 0.3493047
 [8] 0.3837360 0.2232991 0.2803945 0.3892913 0.4477891 0.2207879 0.3648121
[15] 0.3701690 0.1521115 0.3624807 0.3399690 0.2694241 0.3503333 0.4211616
[22] 0.2564267 0.2746220 0.3395723 0.2838892 0.2959223 0.3053936 0.4177549
[29] 0.1892085 0.1916937 0.1429237 0.3110586 0.3368093 0.2471547 0.3143658
[36] 0.3277659 0.3428951 0.4342855 0.2447900 0.1546114</code></pre>
</div>
</div>
</section><section id="upper-lower-groups-index" class="level3"><h3 class="anchored" data-anchor-id="upper-lower-groups-index">3. Upper-lower groups index</h3>
<p>Personally, I feel that this approach is the most meaningfully-related approach in terms of “discrimination”. That’s because while calculating it, we divide the whole group into sub-groups (usually three groups) according to their total scores. Then, we calculate the discrimination index for an item by comparing these groups’ responses to that item. This definition feels more like a discrimination index to my illiterate ears.</p>
<p>In R environment, <code>ShinyItemAnalysis</code> package has a specific function for this index. The <code>gDiscrim()</code> function has several arguements such as <code>Data</code>(the data set), <code>k</code> (the number of sub groups and 3 is default), <code>l</code> and <code>u</code> (numeric values to define the lower and upper groups and the defaults are 1 and 3 consecutively). There are other arguments that should be checked on the manual before using the function.</p>
<p>We simply use the function as:</p>
<div class="cell" data-code_folding="false">
<div class="sourceCode" id="cb10" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">item_discrimination3</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ShinyItemAnalysis</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gDiscrim</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">my_data</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">item_discrimination3</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        i1         i2         i3         i4         i5         i6         i7 
0.35177700 0.11253051 0.12801251 0.42537370 0.20042709 0.57908786 0.40470561 
        i8         i9        i10        i11        i12        i13        i14 
0.56204240 0.19718578 0.26586333 0.43982611 0.56566504 0.21888347 0.50640635 
       i15        i16        i17        i18        i19        i20        i21 
0.49603417 0.11253051 0.45530811 0.44428768 0.26346095 0.46442190 0.56829622 
       i22        i23        i24        i25        i26        i27        i28 
0.26449054 0.20145668 0.43875839 0.20908328 0.25709274 0.36420836 0.59567572 
       i29        i30        i31        i32        i33        i34        i35 
0.17720409 0.08419768 0.07748627 0.19100824 0.45732916 0.12957596 0.41599298 
       i36        i37        i38        i39        i40 
0.37633466 0.29804759 0.54766626 0.13163514 0.09601891 </code></pre>
</div>
</div>
<p>Note that if you change the number of subgroups, you should be careful while interpreting the results.</p>
<p>No matter what statistical approach you use to estimate discrimination indexes, it’s also important to note that item discrimination can be influenced by factors such as the sample size, the range of scores, and the homogeneity of the sample. Therefore, it’s recommended to examine item discrimination in conjunction with other psychometric properties such as item difficulty and reliability.</p>
</section></section><section id="a-package-of-personal-preferrance" class="level2"><h2 class="anchored" data-anchor-id="a-package-of-personal-preferrance">A Package of Personal Preferrance</h2>
<p>While we can calculate both difficulty and discrimination indexes manually or by using different functions from different packages, my totally-subjective opinion is that <code>ItemAnalysis()</code> function from the <code>ShinyItemAnalysis</code> package gives a well-groomed output for many item statistics. The following code snippet simply provides us with many indexes including difficulty and three types of discrimination indexes:</p>
<div class="cell" data-code_folding="false">
<div class="sourceCode" id="cb12" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#round is for rounding the values in the results.</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">item_stats</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ShinyItemAnalysis</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ItemAnalysis</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">my_data</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#to see all the output in a table:</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">knitr</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">item_stats</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 2%">
<col style="width: 6%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 5%">
<col style="width: 4%">
<col style="width: 5%">
<col style="width: 4%">
<col style="width: 5%">
<col style="width: 8%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 8%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 6%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 4%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">Difficulty</th>
<th style="text-align: right;">Mean</th>
<th style="text-align: right;">SD</th>
<th style="text-align: right;">Cut.score</th>
<th style="text-align: right;">obs.min</th>
<th style="text-align: right;">Min.score</th>
<th style="text-align: right;">obs.max</th>
<th style="text-align: right;">Max.score</th>
<th style="text-align: right;">Prop.max.score</th>
<th style="text-align: right;">RIR</th>
<th style="text-align: right;">RIT</th>
<th style="text-align: right;">Corr.criterion</th>
<th style="text-align: right;">ULI</th>
<th style="text-align: right;">gULI</th>
<th style="text-align: right;">Alpha.drop</th>
<th style="text-align: right;">Index.rel</th>
<th style="text-align: right;">Index.val</th>
<th style="text-align: right;">Perc.miss</th>
<th style="text-align: right;">Perc.nr</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">i1</td>
<td style="text-align: right;">0.21</td>
<td style="text-align: right;">0.21</td>
<td style="text-align: right;">0.41</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.21</td>
<td style="text-align: right;">0.34</td>
<td style="text-align: right;">0.40</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.35</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.83</td>
<td style="text-align: right;">0.16</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">i2</td>
<td style="text-align: right;">0.92</td>
<td style="text-align: right;">0.92</td>
<td style="text-align: right;">0.27</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.92</td>
<td style="text-align: right;">0.17</td>
<td style="text-align: right;">0.22</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.11</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.84</td>
<td style="text-align: right;">0.06</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">i3</td>
<td style="text-align: right;">0.91</td>
<td style="text-align: right;">0.91</td>
<td style="text-align: right;">0.29</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.91</td>
<td style="text-align: right;">0.18</td>
<td style="text-align: right;">0.23</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.13</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.84</td>
<td style="text-align: right;">0.07</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">i4</td>
<td style="text-align: right;">0.78</td>
<td style="text-align: right;">0.78</td>
<td style="text-align: right;">0.41</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.78</td>
<td style="text-align: right;">0.39</td>
<td style="text-align: right;">0.45</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.43</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.83</td>
<td style="text-align: right;">0.19</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">i5</td>
<td style="text-align: right;">0.11</td>
<td style="text-align: right;">0.11</td>
<td style="text-align: right;">0.32</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.11</td>
<td style="text-align: right;">0.25</td>
<td style="text-align: right;">0.30</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.20</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.84</td>
<td style="text-align: right;">0.10</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">i6</td>
<td style="text-align: right;">0.39</td>
<td style="text-align: right;">0.39</td>
<td style="text-align: right;">0.49</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.39</td>
<td style="text-align: right;">0.42</td>
<td style="text-align: right;">0.48</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.58</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.83</td>
<td style="text-align: right;">0.24</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">i7</td>
<td style="text-align: right;">0.74</td>
<td style="text-align: right;">0.74</td>
<td style="text-align: right;">0.44</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.74</td>
<td style="text-align: right;">0.35</td>
<td style="text-align: right;">0.41</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.40</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.83</td>
<td style="text-align: right;">0.18</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">i8</td>
<td style="text-align: right;">0.40</td>
<td style="text-align: right;">0.40</td>
<td style="text-align: right;">0.49</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.40</td>
<td style="text-align: right;">0.38</td>
<td style="text-align: right;">0.45</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.56</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.83</td>
<td style="text-align: right;">0.22</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">i9</td>
<td style="text-align: right;">0.86</td>
<td style="text-align: right;">0.86</td>
<td style="text-align: right;">0.35</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.86</td>
<td style="text-align: right;">0.22</td>
<td style="text-align: right;">0.28</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.20</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.84</td>
<td style="text-align: right;">0.10</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">i10</td>
<td style="text-align: right;">0.87</td>
<td style="text-align: right;">0.87</td>
<td style="text-align: right;">0.34</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.87</td>
<td style="text-align: right;">0.28</td>
<td style="text-align: right;">0.33</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.27</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.83</td>
<td style="text-align: right;">0.11</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">i11</td>
<td style="text-align: right;">0.77</td>
<td style="text-align: right;">0.77</td>
<td style="text-align: right;">0.42</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.77</td>
<td style="text-align: right;">0.39</td>
<td style="text-align: right;">0.45</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.44</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.83</td>
<td style="text-align: right;">0.19</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">i12</td>
<td style="text-align: right;">0.39</td>
<td style="text-align: right;">0.39</td>
<td style="text-align: right;">0.49</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.39</td>
<td style="text-align: right;">0.45</td>
<td style="text-align: right;">0.51</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.57</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.83</td>
<td style="text-align: right;">0.25</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">i13</td>
<td style="text-align: right;">0.88</td>
<td style="text-align: right;">0.88</td>
<td style="text-align: right;">0.32</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.88</td>
<td style="text-align: right;">0.22</td>
<td style="text-align: right;">0.27</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.22</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.84</td>
<td style="text-align: right;">0.09</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">i14</td>
<td style="text-align: right;">0.68</td>
<td style="text-align: right;">0.68</td>
<td style="text-align: right;">0.47</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.68</td>
<td style="text-align: right;">0.36</td>
<td style="text-align: right;">0.43</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.51</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.83</td>
<td style="text-align: right;">0.20</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">i15</td>
<td style="text-align: right;">0.59</td>
<td style="text-align: right;">0.59</td>
<td style="text-align: right;">0.49</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.59</td>
<td style="text-align: right;">0.37</td>
<td style="text-align: right;">0.44</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.83</td>
<td style="text-align: right;">0.22</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">i16</td>
<td style="text-align: right;">0.93</td>
<td style="text-align: right;">0.93</td>
<td style="text-align: right;">0.26</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.93</td>
<td style="text-align: right;">0.15</td>
<td style="text-align: right;">0.20</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.11</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.84</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">i17</td>
<td style="text-align: right;">0.72</td>
<td style="text-align: right;">0.72</td>
<td style="text-align: right;">0.45</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.72</td>
<td style="text-align: right;">0.36</td>
<td style="text-align: right;">0.43</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.46</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.83</td>
<td style="text-align: right;">0.19</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">i18</td>
<td style="text-align: right;">0.38</td>
<td style="text-align: right;">0.38</td>
<td style="text-align: right;">0.49</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.38</td>
<td style="text-align: right;">0.34</td>
<td style="text-align: right;">0.41</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.44</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.83</td>
<td style="text-align: right;">0.20</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">i19</td>
<td style="text-align: right;">0.17</td>
<td style="text-align: right;">0.17</td>
<td style="text-align: right;">0.38</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.17</td>
<td style="text-align: right;">0.27</td>
<td style="text-align: right;">0.33</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.26</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.84</td>
<td style="text-align: right;">0.13</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">i20</td>
<td style="text-align: right;">0.35</td>
<td style="text-align: right;">0.35</td>
<td style="text-align: right;">0.48</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.35</td>
<td style="text-align: right;">0.35</td>
<td style="text-align: right;">0.42</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.46</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.83</td>
<td style="text-align: right;">0.20</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">i21</td>
<td style="text-align: right;">0.51</td>
<td style="text-align: right;">0.51</td>
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.51</td>
<td style="text-align: right;">0.42</td>
<td style="text-align: right;">0.49</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.57</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.83</td>
<td style="text-align: right;">0.25</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">i22</td>
<td style="text-align: right;">0.18</td>
<td style="text-align: right;">0.18</td>
<td style="text-align: right;">0.38</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.18</td>
<td style="text-align: right;">0.26</td>
<td style="text-align: right;">0.32</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.26</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.84</td>
<td style="text-align: right;">0.12</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">i23</td>
<td style="text-align: right;">0.10</td>
<td style="text-align: right;">0.10</td>
<td style="text-align: right;">0.30</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.10</td>
<td style="text-align: right;">0.27</td>
<td style="text-align: right;">0.32</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.20</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.84</td>
<td style="text-align: right;">0.10</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">i24</td>
<td style="text-align: right;">0.68</td>
<td style="text-align: right;">0.68</td>
<td style="text-align: right;">0.47</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.68</td>
<td style="text-align: right;">0.34</td>
<td style="text-align: right;">0.41</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.44</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.83</td>
<td style="text-align: right;">0.19</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">i25</td>
<td style="text-align: right;">0.90</td>
<td style="text-align: right;">0.90</td>
<td style="text-align: right;">0.30</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.90</td>
<td style="text-align: right;">0.28</td>
<td style="text-align: right;">0.33</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.21</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.83</td>
<td style="text-align: right;">0.10</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">i26</td>
<td style="text-align: right;">0.88</td>
<td style="text-align: right;">0.88</td>
<td style="text-align: right;">0.32</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.88</td>
<td style="text-align: right;">0.30</td>
<td style="text-align: right;">0.35</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.26</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.83</td>
<td style="text-align: right;">0.11</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">i27</td>
<td style="text-align: right;">0.26</td>
<td style="text-align: right;">0.26</td>
<td style="text-align: right;">0.44</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.26</td>
<td style="text-align: right;">0.31</td>
<td style="text-align: right;">0.37</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.36</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.83</td>
<td style="text-align: right;">0.16</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">i28</td>
<td style="text-align: right;">0.54</td>
<td style="text-align: right;">0.54</td>
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.54</td>
<td style="text-align: right;">0.42</td>
<td style="text-align: right;">0.49</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.60</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.83</td>
<td style="text-align: right;">0.24</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">i29</td>
<td style="text-align: right;">0.15</td>
<td style="text-align: right;">0.15</td>
<td style="text-align: right;">0.36</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.15</td>
<td style="text-align: right;">0.19</td>
<td style="text-align: right;">0.25</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.18</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.84</td>
<td style="text-align: right;">0.09</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">i30</td>
<td style="text-align: right;">0.04</td>
<td style="text-align: right;">0.04</td>
<td style="text-align: right;">0.21</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.04</td>
<td style="text-align: right;">0.19</td>
<td style="text-align: right;">0.23</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.08</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.84</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">i31</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">0.21</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">0.14</td>
<td style="text-align: right;">0.18</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.08</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.84</td>
<td style="text-align: right;">0.04</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">i32</td>
<td style="text-align: right;">0.92</td>
<td style="text-align: right;">0.92</td>
<td style="text-align: right;">0.27</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.92</td>
<td style="text-align: right;">0.31</td>
<td style="text-align: right;">0.35</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.19</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.83</td>
<td style="text-align: right;">0.10</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">i33</td>
<td style="text-align: right;">0.64</td>
<td style="text-align: right;">0.64</td>
<td style="text-align: right;">0.48</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.64</td>
<td style="text-align: right;">0.34</td>
<td style="text-align: right;">0.41</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.46</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.83</td>
<td style="text-align: right;">0.20</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">i34</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">0.23</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">0.25</td>
<td style="text-align: right;">0.28</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.13</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.84</td>
<td style="text-align: right;">0.06</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">i35</td>
<td style="text-align: right;">0.61</td>
<td style="text-align: right;">0.61</td>
<td style="text-align: right;">0.49</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.61</td>
<td style="text-align: right;">0.31</td>
<td style="text-align: right;">0.39</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.42</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.83</td>
<td style="text-align: right;">0.19</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">i36</td>
<td style="text-align: right;">0.80</td>
<td style="text-align: right;">0.80</td>
<td style="text-align: right;">0.40</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.80</td>
<td style="text-align: right;">0.33</td>
<td style="text-align: right;">0.39</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.38</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.83</td>
<td style="text-align: right;">0.16</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">i37</td>
<td style="text-align: right;">0.15</td>
<td style="text-align: right;">0.15</td>
<td style="text-align: right;">0.35</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.15</td>
<td style="text-align: right;">0.34</td>
<td style="text-align: right;">0.40</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.30</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.83</td>
<td style="text-align: right;">0.14</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">i38</td>
<td style="text-align: right;">0.57</td>
<td style="text-align: right;">0.57</td>
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.57</td>
<td style="text-align: right;">0.43</td>
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.55</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.83</td>
<td style="text-align: right;">0.25</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">i39</td>
<td style="text-align: right;">0.93</td>
<td style="text-align: right;">0.93</td>
<td style="text-align: right;">0.26</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.93</td>
<td style="text-align: right;">0.24</td>
<td style="text-align: right;">0.29</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.13</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.84</td>
<td style="text-align: right;">0.07</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">i40</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">0.21</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">0.15</td>
<td style="text-align: right;">0.19</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.10</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.84</td>
<td style="text-align: right;">0.04</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>The same package also provides us with a nice visualization function (<code>DDplot</code>) for item difficulty and discrimination of any approach stated above. It takes <code>discrim</code> argument that can be defined as <code>RIT</code> (the first approach), <code>RIR</code> (the second approach above) or <code>ULI</code> (the third approach). Also, you can define a threshold value to draw a line on the plot via the <code>thr</code> argument. Here is a sample usage for our case:</p>
<div class="cell" data-code_folding="false">
<div class="sourceCode" id="cb13" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">DDplot</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">my_data</span>, discrim <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ULI'</span>, k <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, l <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, u <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, thr<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="index_files/figure-html/unnamed-chunk-8-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="https://emrekaragul.com/posts/Exploring the psychometric properties using R/index_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>It can be seen that items 30, 31 and 40 from our simulated dataset are below our 0.1 threshold value in terms of discrimination. Interestingly, items 30 and 31 are the most difficult items while item 40 is the easiest one. What a weirdo… :D</p>
</section><section id="conclusion" class="level2"><h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<p>Examining item difficulty and item discrimination are important aspects of evaluating the psychometric properties of a measure. Item difficulty measures how easy or difficult each individual item is for respondents to answer correctly, while item discrimination measures the extent to which each item differentiates between participants who have high or low levels of the construct being measured.</p>
<p>In this blog post, we explored how to calculate item difficulty and item discrimination in R using an example dataset. We explained what each of these psychometric properties are, why they’re important, and how to interpret the results. We also discussed some limitations and considerations when examining these properties.</p>
<p>Overall, understanding and evaluating the psychometric properties of a measure can help ensure its reliability and validity, and inform decisions about item selection and revision.</p>


</section> ]]></description>
  <category>ShinyItemAnalysis</category>
  <category>multilevel</category>
  <guid>https://emrekaragul.com/posts/Exploring the psychometric properties using R/</guid>
  <pubDate>Fri, 03 Mar 2023 21:00:00 GMT</pubDate>
  <media:content url="https://emrekaragul.com/posts/Exploring the psychometric properties using R/image.png" medium="image" type="image/png" height="144" width="144"/>
</item>
<item>
  <title>Web scraping with Rvest package</title>
  <dc:creator>Ali Emre Karagül</dc:creator>
  <link>https://emrekaragul.com/posts/Web scraping with Rvest/</link>
  <description><![CDATA[ <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mailchimp Subscription Modal</title>
<link href="//cdn-images.mailchimp.com/embedcode/classic-071822.css" rel="stylesheet" type="text/css">
<style>
        /* Modal Background */
        .modal {
            display: none; /* Hidden by default */
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5); /* Dimmed background */
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        #openModalBtn {
            background-color: tomato; /* background */
            color: white; /* White text */
            border: none; /* Remove border */
            padding: 10px 20px; /* Add padding */
            font-size: 24px; /* Adjust font size */
            border-radius: 5px; /* Rounded corners */
            cursor: pointer; /* Pointer cursor on hover */
            transition: background-color 0.3s ease; /* Smooth hover effect */
            width: 100%;
            margin-bottom: 20px; /* Add space after the button */
        }

        #openModalBtn:hover {
            background-color: rgb(255, 58, 23); /* Darker on hover */
        }
        /* Modal Content */
        .modal-content {
            background-color: #fff;
            padding: 20px;
            border-radius: 8px;
            max-width: 600px;
            width: 90%;
            text-align: center;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            overflow: auto;
        }

        /* Close Button */
        .close-btn {
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 20px;
            font-weight: bold;
            color: #aaa;
            cursor: pointer;
        }

        .close-btn:hover {
            color: #000;
        }
    </style>
<!-- Trigger Button --><button id="openModalBtn">Wanna subscribe?</button>


    <!-- Modal Structure -->
    <div id="subscriptionModal" class="modal">
        <div class="modal-content">
            <span class="close-btn">×</span>
            <!-- Mailchimp Signup Form -->
            <div>
                <div id="mc_embed_signup">
                    <form action="https://emrekaragul.us21.list-manage.com/subscribe/post?u=e72720e0214b2266cab41097e&amp;id=5cddb1a68e&amp;f_id=0038dfe1f0" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate="">
                        <div id="mc_embed_signup_scroll">
                            <h2 class="anchored">Submit your e-mail to subscribe!</h2>
                            <div class="mc-field-group">
                                <label for="mce-EMAIL">Email Address <span class="asterisk">*</span></label>
                                <input type="email" value="" name="EMAIL" class="required email" id="mce-EMAIL" required=""><span id="mce-EMAIL-HELPERTEXT" class="helper_text"></span>
                            </div>
                            <div id="mce-responses" class="clear foot">
                                <div class="response" id="mce-error-response" style="display:none"></div>
                                <div class="response" id="mce-success-response" style="display:none"></div>
                            </div>
                            
                            <div class="optionalParent">
                                <div class="clear foot">
                                    <input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button">
</div>
                            </div>
                        </div>
                    </form>
                </div>
                <script type="text/javascript" src="//s3.amazonaws.com/downloads.mailchimp.com/js/mc-validate.js"></script><script type="text/javascript">
                    (function($) {
                        window.fnames = new Array();
                        window.ftypes = new Array();
                        fnames[0] = 'EMAIL';
                        ftypes[0] = 'email';
                    }(jQuery));
                    var $mcj = jQuery.noConflict(true);
                </script><!--End mc_embed_signup-->
</div>
        </div>
    </div>

    <script>
        // Get the modal, button, and close elements
        const modal = document.getElementById("subscriptionModal");
        const openModalBtn = document.getElementById("openModalBtn");
        const closeBtn = document.querySelector(".close-btn");

        // Open the modal when the button is clicked
        openModalBtn.addEventListener("click", () => {
            modal.style.display = "flex"; // Show the modal
        });

        // Close the modal when the close button is clicked
        closeBtn.addEventListener("click", () => {
            modal.style.display = "none"; // Hide the modal
        });

        // Close the modal when clicking outside of it
        window.addEventListener("click", (e) => {
            if (e.target === modal) {
                modal.style.display = "none";
            }
        });
    </script><section id="introduction" class="level2"><h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p><strong>In this post, we will delve into harvesting a web page, <a href="https://eksisozluk2023.com/">Ekşi Sözlük</a>. This process won’t include the automation of the process. Yet, <a href="https://aliemrekaragul.shinyapps.io/eksi-kazaR/">a completed web application</a> for harvesting Ekşi Sözlük is available.</strong></p>
<p>Ekşi Sözlük is a reddit-like satirical web site where users share their ideas on certain topics in Turkish. Our target topic is “veri bilimi” (a.k.a. data science in English). The R packages that we use in this post are as follows:</p>
<div class="cell" data-code_folding="false">
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;"><a href="https://rvest.tidyverse.org/">rvest</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;"><a href="https://tm.r-forge.r-project.org/">tm</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;"><a href="https://github.com/quanteda/stopwords">stopwords</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;"><a href="http://blog.fellstat.com/?cat=11">wordcloud</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;"><a href="https://github.com/lchiffon/wordcloud2">wordcloud2</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
</div>
</section><section id="processing" class="level2"><h2 class="anchored" data-anchor-id="processing">Processing</h2>
<p>“Rvest” is a package for web scraping and harvesting which was developed by Hadley Wickham. He has stated that he was inspired by a few of the python libraries such as “beautiful soup” and “RoboBrowser”.</p>
<p>First things first; we start by introducing the webpage that we want to harvest.</p>
<div class="cell">
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">html</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="http://xml2.r-lib.org/reference/read_xml.html">read_html</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://eksisozluk1923.com/veri-bilimi--3426406"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
</div>
<p>Rvest allows us to collect any type of HTML tag from the current page. Let’s suppose we would like to collect all the links in a topic page. First, go to the page and press F12 to open the “devtools” tab. Then turn inspect mode on. Hover on an item and check the node name for a random link. This process is shown below.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><a href="images/image-1666293050.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="https://emrekaragul.com/posts/Web scraping with Rvest/images/image-1666293050.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="1045"></a></p>
</figure>
</div>
<p>Then we use the functions <code><a href="https://rvest.tidyverse.org/reference/rename.html">html_nodes()</a></code> on the node name and <code><a href="https://rvest.tidyverse.org/reference/html_attr.html">html_attr()</a></code> on “href” HTML tags. This will get all the href attributes with the node name “a.url” on the given link and turn them into a list:</p>
<div class="cell">
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">links</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">html</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rvest.tidyverse.org/reference/rename.html">html_nodes</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"a.url"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>  <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rvest.tidyverse.org/reference/html_attr.html">html_attr</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"href"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">links</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "http://e-k.in/introduction-to-data-science/"                                                     
[2] "https://www.edx.org/course/introduction-big-data-apache-spark-uc-berkeleyx-cs100-1x#.VMK0q3v-t3U"</code></pre>
</div>
</div>
<p>If we would like to collect all the entries on the given page, we will need the <code>div</code> attribute name for entries (also shown below).</p>
<p><a href="images/image-37950438.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img src="https://emrekaragul.com/posts/Web scraping with Rvest/images/image-37950438.png" class="img-fluid"></a></p>
<p>Now, we will use the function <code><a href="https://rvest.tidyverse.org/reference/html_text.html">html_text()</a></code> to collect the entries in these <code>div</code> attributes. There are about 10 entries some of which are quite long. Therefore, let me print only the first three entries via the <code><a href="https://rdrr.io/r/utils/head.html">head()</a></code> function.</p>
<div class="cell">
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">entries</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">html</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rvest.tidyverse.org/reference/rename.html">html_nodes</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".content"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rvest.tidyverse.org/reference/html_text.html">html_text</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>    </span>
<span></span>
<span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#Let's see the first three entries:</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">entries</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "\r\n    internette milyonlarca veri var. bu milyonlarca veriyi işleyen milyonlarca uygulama var. işte bu uygulamalar sayesinde var olan veriyi kullanıp yeni veri uygulamaları yaratma işine veri bilimi denir.\r\n  "
[2] "\r\n    istatistik ile cok alakali bilim. (bkz: veri madenciligi)\r\n  "                                                                                                                                              
[3] "\r\n    bana veri olmadan çalışan bir adet bilim türü gösterildiği anda varlığını ve özgünlüğünü kabul edeceğim ilim kategorisi.yoksa şununla yarışır bence:(bkz: deney bilimi) *"                                    </code></pre>
</div>
</div>
<p>Now that you have all the entries in a page, it is easy to carry out a text analysis with it. Let’s simply create a word cloud. Here we’ll use the <code>wordcloud</code> and <code>tm</code> packages. Functions in <code>tm</code> package works on a corpus type input. Hence, we change our entry list to a corpus using <code><a href="https://rdrr.io/pkg/tm/man/Corpus.html">Corpus()</a></code> and <code><a href="https://rdrr.io/pkg/tm/man/VectorSource.html">VectorSource()</a></code> functions.</p>
<div class="cell">
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#turn entries into corpus</span></span>
<span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">entries</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/tm/man/Corpus.html">Corpus</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/tm/man/VectorSource.html">VectorSource</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">entries</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
</div>
<p>As we do not want unnecessary items in our word cloud, we will get rid of numbers, punctuation marks and spaces with <code><a href="https://rdrr.io/pkg/tm/man/removeNumbers.html">removeNumbers()</a></code>, <code><a href="https://rdrr.io/pkg/tm/man/removePunctuation.html">removePunctuation()</a></code>, and <code><a href="https://rdrr.io/pkg/tm/man/stripWhitespace.html">stripWhitespace()</a></code>.</p>
<p>Also all letters will be transformed into lower case characters. We use <code><a href="https://rdrr.io/pkg/tm/man/tm_map.html">tm_map()</a></code> function to apply all the above mentioned functions on the corpus items.</p>
<div class="cell">
<div class="sourceCode" id="cb8" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#apply several functions such as remove punctuation or numbers etc.</span></span>
<span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">entries</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">entries</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/tm/man/tm_map.html">tm_map</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">removeNumbers</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/tm/man/tm_map.html">tm_map</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">removePunctuation</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/tm/man/tm_map.html">tm_map</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">stripWhitespace</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">entries</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/tm/man/tm_map.html">tm_map</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">entries</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/tm/man/content_transformer.html">content_transformer</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">tolower</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
</div>
<p>Of course we would like to remove all the words that do not contribute to the context such as linkers, conjunctions, articles etc. For that, we can use the package <code>stopwords</code>. Turkish stopwords are defined in it and if you like you can add some other words to remove from your corpus via the <code><a href="https://rdrr.io/r/base/append.html">append()</a></code> function. We need to <code><a href="https://rdrr.io/r/base/unlist.html">unlist()</a></code> our corpus to apply <code><a href="https://rdrr.io/pkg/tm/man/removeWords.html">removeWords()</a></code> on it.</p>
<div class="cell">
<div class="sourceCode" id="cb9" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">tr_stopwords</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stopwords</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/stopwords/man/stopwords.html">stopwords</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tr"</span>, source <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"stopwords-iso"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>    </span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">tr_stopwords</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/append.html">append</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">tr_stopwords</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bkz"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"var"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"vardir"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"icin"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"iste"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"işte"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"rn"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"crn"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">entries</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">entries</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">entries</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/tm/man/removeWords.html">removeWords</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">entries</span>, words<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">tr_stopwords</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
</div>
<p>Actually, right now our corpus is ready, filled with all the meaningful words in the entries. However, to create a word cloud we need it as a frequency table. That’s because a word’s frequency will be used while determining its colour and size. To get a frequency table, we need a term matrix first. Following lines of codes will do the magic in this regard:</p>
<div class="cell">
<div class="sourceCode" id="cb10" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#turn into a matrix</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">term_matrix</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/tm/man/matrix.html">TermDocumentMatrix</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">entries</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span></span>
<span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#frequency table:</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">word_freqs</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/colSums.html">rowSums</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">term_matrix</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>,decreasing<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> </span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">word_freqs</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>word<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">word_freqs</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>,freq<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">word_freqs</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
</div>
<p>We will use two different packages for creating our word clouds. Initially, the classic word cloud takes the column names in the frequency table as <code>words</code> and <code>freq</code> arguments. Other arguments are also defined next to them as notes:</p>
<div class="cell">
<div class="sourceCode" id="cb11" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wordcloud</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/wordcloud/man/wordcloud.html">wordcloud</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>words <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">word_freqs</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">word</span>, </span>
<span>                     freq <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">word_freqs</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">freq</span>, </span>
<span>                     min.freq <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## freqs lower than that wonW't be in the cloud</span></span>
<span>                     max.words<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">200</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Total number of words in the cloud</span></span>
<span>                     random.order<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## words will be ordered according to their freqs.</span></span>
<span>                     rot.per<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.35</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## rotation degree</span></span>
<span>                     colors<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html">brewer.pal</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Dark2"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## some custimization for colors</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="index_files/figure-html/unnamed-chunk-9-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img src="https://emrekaragul.com/posts/Web scraping with Rvest/index_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>The second option is a more modern alternative. It is developed based on the JS framework with the same name. It gives you the opportunity to hover over the words and see their frequencies. Also, you can decide on a <code>shape</code> among several options such as <code>'circle'</code>, <code>'diamond'</code>, <code>'triangle-forward'</code>, <code>'triangle'</code>, <code>'pentagon'</code>, and <code>'star'</code>. Yet, some of these features won’t be available if you want your cloud in .png format. That is because <code>wordcloud2</code> package provides us with clouds in HTML format which makes it easier for web page embedding but harder for saving on your local disk as .png or any other format.</p>
<div class="cell">
<div class="sourceCode" id="cb12" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wordcloud2</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/wordcloud2/man/wordcloud2.html">wordcloud2</a></span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">word_freqs</span>, </span>
<span>                  size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## this is basically zooming in the cloud. default is 1</span></span>
<span>                  shape <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"star"</span>, </span>
<span>                  color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'random-light'</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## another option is 'random-dark'</span></span>
<span>                  backgroundColor<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## another option is 'white'</span></span></code></pre></div>
<div class="cell-output-display">
<div class="wordcloud2 html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-d4928a5953f7a0ab617f" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-d4928a5953f7a0ab617f">{"x":{"word":["data","veri","veriyi","big","bilim","isin","bilimi","milyonlarca","scientist","istatistik","analiz","analyst","etmek","farklı","artik","nasil","ornek","sirketin","web","anlatabilen","cikaran","haberdar","icra","ilanini","karar","kisminin","title","veriyle","denir","internette","işine","işleyen","kullanıp","sayesinde","uygulama","uygulamalar","uygulamaları","yaratma","yeni","alakali","cok","madenciligi","adet","anda","bencebkz","deney","edeceğim","gösterildiği","ilim","kabul","kategorisiyoksa","olmadan","türü","varlığını","yarışır","çalışan","özgünlüğünü","şununla","problemi","temel","uygulamadaki","ölçeklenebilirliktir","anlamlı","anlaşılacağı","arasında","bileşimi","bilgiler","bilimcileri","diyelim","diyorlar","facebook","gavurlar","gelen","gelin","gereken","getirmesi","günümüzde","hacimli","hale","isimden","işin","kavramın","kavramının","konsept","konvansiyonel","kulağımıza","mecralarada","metodlar","onlara","resarch","rol","rollerinin","scientistler","scientistlerin","tahmin","tutulacağını","uzmanlarına","verilerin","yakın","yaygınlaşması","yüksek","zamanda","zor","zorlaştığı","çalışanları","çalışmalarında","çıkan","öne","özellikle","üretildiği","üretilen","üstleniyor","üstünde","adam","adini","alalim","alicaksin","analizleri","ariyor","bakarak","begendi","begenen","bilimci","birilerini","birsey","bugune","buyugu","cevirebilme","datayi","demek","deselerdi","duydugum","eldeki","elimizdeki","elinde","giderse","giyim","gordugunuz","hayatimda","ilerde","inanmazdimsirketlerin","isi","isler","isleyecek","kadarki","kafasindaki","kampanya","katalogu","kentuckyde","kullanici","kullanimlara","loglari","mantik","nufuslu","olacagi","ongorulere","ongoruye","patlamaysa","satilan","sayilir","sehirdeki","sekil","seyler","siten","sitesinde","tarafa","teklifi","ureticisinden","urun","urune","urunlere","valla","verimli","yapiyor","yapmayalim","yonetimi","güzel","hakkında","httpekinintroductiontodatascience","içeren","yazı","örnek","baksınhttpswwwedxorg…erkeleyxcsxvmkqvtu","başlayacak","berkeley","edxorg","ilgilenenler","kursu","veriyormuş","üniversitesi","analizi","ardından","belirleyip","dalıdır","edilen","edilmesini","etki","içerisinden","metotlar","mevcut","sağlayan","tahminsel","talep","tiplerinin","veriler","yapan","çıktıya","acik","adi","akil","alakasi","alan","alaninda","algoritma","anlamda","anlayabilen","anlayip","arac","artificial","asil","ayrilirken","bakmayin","baska","baslanacak","bilgi","bilgisi","bunlari","buyuk","calisabilen","calisirken","calismak","cevirebilecek","ciddiye","dedim","deniyor","dili","diyalog","durumunda","edebilip","eger","endustriyel","ettim","evcillestirme","farkinda","firsata","gelistirebilen","genel","gerekli","gidilecek","gidiyorum","gittigi","gormez","gorur","hakkinda","hiza","hrlarinda","icerigi","iceriyorsa","ihtiyaci","ikna","ilgi","ilgilendiren","inanilmaz","intelligence","islemini","islerin","karisikligi","karmasasi","kavram","kisiis","kolunu","konferanslari","konulmasiyla","kullanabilen","kullanilacak","kusura","learning","lik","machine","olankisilere","oldugunu","oldugunun","olmadigi","onemli","ortaya","ozellikle","paket","platformlardan","populer","pozisyon","problemin","programlama","sahibi","science","sciencela","sey","simdi","sirket","sirkete","sirkette","sonuclara","sonuclari","surekli","surprizlere","surprizleri","takip","temizleme","ustunde","uygulamalarindan","verebilen","vericileri","veriye","visualization","yapilacaklari","yayinlari","yazilimcilara","yazilimcilarla","yenilemek","yenilikleri","yetisebilmek","yonlendirebilen","yonteme","yorumlayabilen","zorunda"],"freq":[13,12,6,5,4,4,3,3,3,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],"fontFamily":"Segoe UI","fontWeight":"bold","color":"random-light","minSize":0,"weightFactor":5.53846153846154,"backgroundColor":"black","gridSize":0,"minRotation":-0.785398163397448,"maxRotation":0.785398163397448,"shuffle":true,"rotateRatio":0.4,"shape":"star","ellipticity":0.65,"figBase64":null,"hover":null},"evals":[],"jsHooks":{"render":[{"code":"function(el,x){\n                        console.log(123);\n                        if(!iii){\n                          window.location.reload();\n                          iii = False;\n\n                        }\n  }","data":null}]}}</script>
</div>
</div>
</section><section id="conclusion" class="level2"><h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<p>There are many ways to use <code>Rvest</code> and scrap a website. We tried one of them in this post. In the end you can do many things with your output such as content analysis, clustering, sentimental analysis or even survival analysis. Here, in this post, we do not bare any pragmatic purposes so focused on creating something fun and eye-catching: word clouds. Also, scraping depends highly on your computer’s processor and the number of pages you want to scrap. If you want to automate this process, it may take some time to complete. You can find <a href="https://aliemrekaragul.shinyapps.io/eksi-kazaR/">my Rshiny web application</a> automating specifically the steps discussed here.</p>
<p>Although we haven’t mentioned here, <code>Rvest</code> works in alignment with the <code>polite</code> package. It allows you to scrap a web page in a polite way with permissions and greetings. The motto of the package <code>polite</code> sums it all for itself: <em>Be responsible when scraping data from websites by following polite principles: introduce yourself, ask for permission, take slowly and never ask twice.</em></p>


</section> ]]></description>
  <category>Rvest</category>
  <category>Wordcloud</category>
  <category>dplyr</category>
  <category>tm</category>
  <category>stopwords</category>
  <category>wordcloud2</category>
  <guid>https://emrekaragul.com/posts/Web scraping with Rvest/</guid>
  <pubDate>Thu, 05 Jan 2023 21:00:00 GMT</pubDate>
  <media:content url="https://emrekaragul.com/posts/Web scraping with Rvest/image.png" medium="image" type="image/png" height="132" width="144"/>
</item>
<item>
  <title>Visualisation of My Personal Google Data (2): My exercise routine</title>
  <dc:creator>Ali Emre Karagül</dc:creator>
  <link>https://emrekaragul.com/posts/Visualisation of My Personal Google Data (2)/</link>
  <description><![CDATA[ <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mailchimp Subscription Modal</title>
<link href="//cdn-images.mailchimp.com/embedcode/classic-071822.css" rel="stylesheet" type="text/css">
<style>
        /* Modal Background */
        .modal {
            display: none; /* Hidden by default */
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5); /* Dimmed background */
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        #openModalBtn {
            background-color: tomato; /* background */
            color: white; /* White text */
            border: none; /* Remove border */
            padding: 10px 20px; /* Add padding */
            font-size: 24px; /* Adjust font size */
            border-radius: 5px; /* Rounded corners */
            cursor: pointer; /* Pointer cursor on hover */
            transition: background-color 0.3s ease; /* Smooth hover effect */
            width: 100%;
            margin-bottom: 20px; /* Add space after the button */
        }

        #openModalBtn:hover {
            background-color: rgb(255, 58, 23); /* Darker on hover */
        }
        /* Modal Content */
        .modal-content {
            background-color: #fff;
            padding: 20px;
            border-radius: 8px;
            max-width: 600px;
            width: 90%;
            text-align: center;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            overflow: auto;
        }

        /* Close Button */
        .close-btn {
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 20px;
            font-weight: bold;
            color: #aaa;
            cursor: pointer;
        }

        .close-btn:hover {
            color: #000;
        }
    </style>
<!-- Trigger Button --><button id="openModalBtn">Wanna subscribe?</button>


    <!-- Modal Structure -->
    <div id="subscriptionModal" class="modal">
        <div class="modal-content">
            <span class="close-btn">×</span>
            <!-- Mailchimp Signup Form -->
            <div>
                <div id="mc_embed_signup">
                    <form action="https://emrekaragul.us21.list-manage.com/subscribe/post?u=e72720e0214b2266cab41097e&amp;id=5cddb1a68e&amp;f_id=0038dfe1f0" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate="">
                        <div id="mc_embed_signup_scroll">
                            <h2 class="anchored">Submit your e-mail to subscribe!</h2>
                            <div class="mc-field-group">
                                <label for="mce-EMAIL">Email Address <span class="asterisk">*</span></label>
                                <input type="email" value="" name="EMAIL" class="required email" id="mce-EMAIL" required=""><span id="mce-EMAIL-HELPERTEXT" class="helper_text"></span>
                            </div>
                            <div id="mce-responses" class="clear foot">
                                <div class="response" id="mce-error-response" style="display:none"></div>
                                <div class="response" id="mce-success-response" style="display:none"></div>
                            </div>
                            
                            <div class="optionalParent">
                                <div class="clear foot">
                                    <input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button">
</div>
                            </div>
                        </div>
                    </form>
                </div>
                <script type="text/javascript" src="//s3.amazonaws.com/downloads.mailchimp.com/js/mc-validate.js"></script><script type="text/javascript">
                    (function($) {
                        window.fnames = new Array();
                        window.ftypes = new Array();
                        fnames[0] = 'EMAIL';
                        ftypes[0] = 'email';
                    }(jQuery));
                    var $mcj = jQuery.noConflict(true);
                </script><!--End mc_embed_signup-->
</div>
        </div>
    </div>

    <script>
        // Get the modal, button, and close elements
        const modal = document.getElementById("subscriptionModal");
        const openModalBtn = document.getElementById("openModalBtn");
        const closeBtn = document.querySelector(".close-btn");

        // Open the modal when the button is clicked
        openModalBtn.addEventListener("click", () => {
            modal.style.display = "flex"; // Show the modal
        });

        // Close the modal when the close button is clicked
        closeBtn.addEventListener("click", () => {
            modal.style.display = "none"; // Hide the modal
        });

        // Close the modal when clicking outside of it
        window.addEventListener("click", (e) => {
            if (e.target === modal) {
                modal.style.display = "none";
            }
        });
    </script><section id="introduction-to-the-series-visualisation-of-my-personal-google-data" class="level2"><h2 class="anchored" data-anchor-id="introduction-to-the-series-visualisation-of-my-personal-google-data">Introduction to the series: “Visualisation of My Personal Google Data”</h2>
<p>If you give permission to Google to store your location data, they will keep them in their databases forever. You can also allow them to store it for a while and then ask them delete it. They will directly do so.</p>
<p>What makes this study a fun project is its being very personal. I decided to analyze my personal data in August, 2022. Therefore, I granted many new permissions to Google along with many previously granted permissions. They keep them in various formats including .csv, .json, .mbox etc. When you query for your personal data, they provide it within a couple of days depending on the size of the data you queried.</p>
<p>Usually, I provide the readers with the data in my posts. However, in this series, the data are very personal and so I will not.</p>
</section><section id="introduction-my-exercise-routine" class="level2"><h2 class="anchored" data-anchor-id="introduction-my-exercise-routine">Introduction: “My exercise routine”</h2>
<p>In this part of the series, we will investigate my personal location data. We will visualize the spots I visited within a period of time. This way, I personally will gain insights about how boring my days are :)</p>
<p>The R packages that we use in this post are as follows:</p>
<div class="cell" data-code_folding="false">
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"><a href="https://personality-project.org/r/psych/">"psych"</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"><a href="https://dplyr.tidyverse.org">"dplyr"</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"><a href="https://plotly-r.com">"plotly"</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
</div>
</section><section id="understand-the-data-pre-processing" class="level2"><h2 class="anchored" data-anchor-id="understand-the-data-pre-processing">Understand the Data &amp; Pre-processing</h2>
<p>Let’s start the procedure by reading the data into R. The <code><a href="https://rdrr.io/r/utils/head.html">head()</a></code> function provides us with the first six observations of the data frame. There are 16 variables some of which are filled with many many <code>NA</code>s. such as <code>Biking.duration..ms.</code> The reason for that is pretty simple; I do not ride around. The variables are mostly numeric, yet <code>Date</code>gives us information about the date of the observation. The variable <code>Running.duration..ms.</code> has many <code>NA</code>s too. But it also has some observations because I run only a few days a week. I will use this variable to filter my data later.</p>
<div class="cell">
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">daily_metrics</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Daily activity metrics.csv"</span>,sep<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">","</span>, header <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">daily_metrics</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> </span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        Date Move.Minutes.count Calories..kcal. Distance..m. Heart.Points
1 2021-05-16                 77        687.6241     4090.742           40
2 2021-05-17                 79       2016.4717     3978.947           13
3 2021-05-18                 31       1752.2711     2267.061           21
4 2021-05-19                140       2201.5012     9714.473           74
5 2021-05-20                 50       1842.7984     2618.885           16
6 2021-05-21                 63       1902.6128     4571.006           43
  Heart.Minutes Average.speed..m.s. Max.speed..m.s. Min.speed..m.s. Step.count
1            40           0.9532187        1.017549       0.8888889       7654
2            13           0.3553377        1.328190       0.2391036       6161
3            21           0.4802522        1.643308       0.2550294       3450
4            74           0.5155224        1.711053       0.2550294      14000
5            16           0.3804749        1.516558       0.2588491       4078
6            43           0.5348663        1.492037       0.2656556       6768
  Average.weight..kg. Max.weight..kg. Min.weight..kg. Biking.duration..ms.
1                  80              80              80                   NA
2                  NA              NA              NA                   NA
3                  NA              NA              NA                   NA
4                  NA              NA              NA                   NA
5                  NA              NA              NA                   NA
6                  NA              NA              NA                   NA
  Walking.duration..ms. Running.duration..ms.
1               4664026                    NA
2               4692410                424601
3               1610096                    NA
4               8268890                 93935
5               2994689                    NA
6               3909532                    NA</code></pre>
</div>
</div>
<p>As the data contains some variables with decimal numbers, I would love to round them to increase meaningfulness. The <code>mutate_if</code> function combined with <code>is.numeric</code> gives me the opportunity to pick only the numeric variables to round.</p>
<div class="cell">
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">daily_metrics</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">daily_metrics</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://dplyr.tidyverse.org/reference/mutate_all.html">mutate_if</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">is.numeric</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">round</span>, digits<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
</div>
<p>So far so good. Now I want to select the variables that I want to visualize in my project and filter my data accordingly. Let’s see the variable names:</p>
<div class="cell">
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">daily_metrics</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Date"                  "Move.Minutes.count"    "Calories..kcal."      
 [4] "Distance..m."          "Heart.Points"          "Heart.Minutes"        
 [7] "Average.speed..m.s."   "Max.speed..m.s."       "Min.speed..m.s."      
[10] "Step.count"            "Average.weight..kg."   "Max.weight..kg."      
[13] "Min.weight..kg."       "Biking.duration..ms."  "Walking.duration..ms."
[16] "Running.duration..ms."</code></pre>
</div>
</div>
<p>In this project, I will use following variables: <code>date</code>, <code>Move.Minutes.count</code>,<code>Calories..kcal.</code>,<code>Distance..m.</code>,<code>Average.speed..m.s.</code>,<code>Biking.duration..ms.</code>,<code>Step.caoun</code> and <code>walking.duration.ms.</code>. Let’s use <code>subset</code> function to get rid of the unnecessary part of the data.</p>
<div class="cell">
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">daily_metrics</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">daily_metrics</span>, select <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#idk why so randomly ordered numbers</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">daily_metrics</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        Date Move.Minutes.count Calories..kcal. Distance..m.
1 2021-05-16                 77          687.62      4090.74
2 2021-05-17                 79         2016.47      3978.95
3 2021-05-18                 31         1752.27      2267.06
4 2021-05-19                140         2201.50      9714.47
5 2021-05-20                 50         1842.80      2618.88
6 2021-05-21                 63         1902.61      4571.01
  Average.speed..m.s. Step.count Walking.duration..ms. Running.duration..ms.
1                0.95       7654               4664026                    NA
2                0.36       6161               4692410                424601
3                0.48       3450               1610096                    NA
4                0.52      14000               8268890                 93935
5                0.38       4078               2994689                    NA
6                0.53       6768               3909532                    NA</code></pre>
</div>
</div>
<p>As mentioned before, I would like to work on the days that I run. That’s why I will also get rid of observations that do not contain any running data and then my data will be ready for the visualization.</p>
<p>Finally, let’s get the scatter plots of whatever we have left to see a bigger picture. There are some outliers; you will easily recognize some bubles sitting alone in their plots. However, they don’t look like they need further investigation.</p>
<div class="cell">
<div class="sourceCode" id="cb9" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data_for_plotting</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">daily_metrics</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">daily_metrics</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Running.duration..ms.</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data_for_plotting</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="index_files/figure-html/unnamed-chunk-6-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="https://emrekaragul.com/posts/Visualisation of My Personal Google Data (2)/index_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section><section id="data-visualization" class="level2"><h2 class="anchored" data-anchor-id="data-visualization">Data Visualization</h2>
<p><code>plotly</code> is an amazing alternative to <code>ggplot2.</code> Today we will work on this package with our data. Our first chart contains information about the <strong>number of steps I took each day that I ran from May 2021 to November 2022.</strong></p>
<div class="cell">
<div class="sourceCode" id="cb10" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fig</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plotly</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/plotly/man/plot_ly.html">plot_ly</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>data<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data_for_plotting</span>, type <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"scatter"</span>, mode<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lines+markers"</span>,  </span>
<span>                     y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data_for_plotting</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Step.count</span>, x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Date</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fig</span></span></code></pre></div>
<div class="cell-output-display">
<div id="htmlwidget-413b695442e45f4206c8" style="width:100%;height:464px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-413b695442e45f4206c8">{"x":{"visdat":{"272c7d551835":["function () ","plotlyVisDat"]},"cur_data":"272c7d551835","attrs":{"272c7d551835":{"mode":"lines+markers","y":[6161,14000,3724,5939,1851,5839,1910,3557,8339,3303,3538,7909,12416,3984,10415,9901,8232,5217,8078,11405,6746,8791,16264,13129,7985,10774,12680,12357,12834,12315,6691,11218,7257,16395,11486,12290,12526,10955,10262,8425,10873,11782,6497,11060,10380,14294,9672,10604,12680,9556,9029,5594,6653,3337,3584,5226,11807,2332,3186,1635,14466,2150,6672,2607,2985,3368,3616,10011,4791,3199,3483,2070,3083,4205,3860,3206,6801,5183,2626,7272,1279,5847,3412,8175,5671,6731,3465,4833,6490,2945,2834,5298,3971,3635,3597,3598,9176,9820,5216,2787,9395,7356,6294,2761,4263,10897,3394,7179,9390,7314,8289,3730,7027,8814,7501,6070,5393,6100],"x":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"automargin":true,"title":"Date","type":"category","categoryorder":"array","categoryarray":["2021-05-17","2021-05-19","2021-05-22","2021-05-23","2021-05-31","2021-06-10","2021-06-11","2021-06-13","2021-06-18","2021-06-20","2021-06-27","2021-07-04","2021-07-08","2021-07-09","2021-07-10","2021-07-11","2021-07-12","2021-07-27","2021-07-31","2021-08-04","2021-08-09","2021-08-11","2021-08-12","2021-08-13","2021-08-14","2021-08-15","2021-08-18","2021-08-19","2021-08-20","2021-08-23","2021-08-25","2021-08-26","2021-08-27","2021-08-28","2021-08-30","2021-09-01","2021-09-02","2021-09-03","2021-09-05","2021-09-06","2021-09-07","2021-09-08","2021-09-09","2021-09-12","2021-09-13","2021-09-14","2021-09-16","2021-09-17","2021-09-18","2021-09-21","2021-09-22","2021-09-24","2021-09-26","2021-09-29","2021-09-30","2021-10-02","2021-10-05","2021-10-06","2021-10-08","2021-10-11","2021-10-12","2021-10-16","2021-10-18","2021-10-19","2021-10-28","2021-11-04","2021-11-18","2021-11-19","2021-12-03","2021-12-06","2021-12-13","2022-01-07","2022-01-10","2022-02-05","2022-02-25","2022-02-28","2022-03-04","2022-03-07","2022-03-08","2022-03-09","2022-03-13","2022-03-19","2022-04-19","2022-04-23","2022-04-27","2022-05-01","2022-05-02","2022-05-29","2022-06-05","2022-06-09","2022-06-13","2022-06-14","2022-06-20","2022-06-21","2022-06-23","2022-07-01","2022-07-05","2022-07-09","2022-07-10","2022-07-16","2022-07-25","2022-07-26","2022-07-27","2022-07-28","2022-08-03","2022-08-06","2022-08-15","2022-08-16","2022-08-19","2022-08-25","2022-09-11","2022-09-14","2022-10-01","2022-10-14","2022-10-21","2022-10-25","2022-10-26","2022-11-01"]},"yaxis":{"domain":[0,1],"automargin":true,"title":[]},"hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"mode":"lines+markers","y":[6161,14000,3724,5939,1851,5839,1910,3557,8339,3303,3538,7909,12416,3984,10415,9901,8232,5217,8078,11405,6746,8791,16264,13129,7985,10774,12680,12357,12834,12315,6691,11218,7257,16395,11486,12290,12526,10955,10262,8425,10873,11782,6497,11060,10380,14294,9672,10604,12680,9556,9029,5594,6653,3337,3584,5226,11807,2332,3186,1635,14466,2150,6672,2607,2985,3368,3616,10011,4791,3199,3483,2070,3083,4205,3860,3206,6801,5183,2626,7272,1279,5847,3412,8175,5671,6731,3465,4833,6490,2945,2834,5298,3971,3635,3597,3598,9176,9820,5216,2787,9395,7356,6294,2761,4263,10897,3394,7179,9390,7314,8289,3730,7027,8814,7501,6070,5393,6100],"x":["2021-05-17","2021-05-19","2021-05-22","2021-05-23","2021-05-31","2021-06-10","2021-06-11","2021-06-13","2021-06-18","2021-06-20","2021-06-27","2021-07-04","2021-07-08","2021-07-09","2021-07-10","2021-07-11","2021-07-12","2021-07-27","2021-07-31","2021-08-04","2021-08-09","2021-08-11","2021-08-12","2021-08-13","2021-08-14","2021-08-15","2021-08-18","2021-08-19","2021-08-20","2021-08-23","2021-08-25","2021-08-26","2021-08-27","2021-08-28","2021-08-30","2021-09-01","2021-09-02","2021-09-03","2021-09-05","2021-09-06","2021-09-07","2021-09-08","2021-09-09","2021-09-12","2021-09-13","2021-09-14","2021-09-16","2021-09-17","2021-09-18","2021-09-21","2021-09-22","2021-09-24","2021-09-26","2021-09-29","2021-09-30","2021-10-02","2021-10-05","2021-10-06","2021-10-08","2021-10-11","2021-10-12","2021-10-16","2021-10-18","2021-10-19","2021-10-28","2021-11-04","2021-11-18","2021-11-19","2021-12-03","2021-12-06","2021-12-13","2022-01-07","2022-01-10","2022-02-05","2022-02-25","2022-02-28","2022-03-04","2022-03-07","2022-03-08","2022-03-09","2022-03-13","2022-03-19","2022-04-19","2022-04-23","2022-04-27","2022-05-01","2022-05-02","2022-05-29","2022-06-05","2022-06-09","2022-06-13","2022-06-14","2022-06-20","2022-06-21","2022-06-23","2022-07-01","2022-07-05","2022-07-09","2022-07-10","2022-07-16","2022-07-25","2022-07-26","2022-07-27","2022-07-28","2022-08-03","2022-08-06","2022-08-15","2022-08-16","2022-08-19","2022-08-25","2022-09-11","2022-09-14","2022-10-01","2022-10-14","2022-10-21","2022-10-25","2022-10-26","2022-11-01"],"type":"scatter","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>When you hover over the chart you might see the date and the number of steps that I took. For instance on 12th and 28th of August, I took more than 16k steps.</p>
<p>Now let’s add two dimensions to our chart: <strong>the duration of walking and running in a day</strong> using the <code>addtrace</code> function. Also <code>layout</code> function helps us name our plot.</p>
<div class="cell">
<div class="sourceCode" id="cb11" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">########################</span></span>
<span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># walking VS runing duration bars</span></span>
<span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#########################</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ay</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span></span>
<span>  tickfont <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>color <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>,</span>
<span>  overlaying <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y"</span>,</span>
<span>  side<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"right"</span>,</span>
<span>  title<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;b&gt; secondary&lt;/b&gt; y axis"</span></span>
<span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span></span>
<span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fig</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plotly</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/plotly/man/plot_ly.html">plot_ly</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fig</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fig</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/plotly/man/add_trace.html">add_trace</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>type <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bar"</span>,  </span>
<span>            y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data_for_plotting</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Walking.duration..ms.</span>,</span>
<span>            x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data_for_plotting</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Date</span>, </span>
<span>            name<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"walking duration (ms)"</span></span>
<span>  <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fig</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fig</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/plotly/man/add_trace.html">add_trace</a></span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>type <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"scatter"</span>, mode<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lines+markers"</span> , <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#yaxis="y2",</span></span>
<span>                         y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data_for_plotting</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Running.duration..ms.</span>, </span>
<span>                         x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data_for_plotting</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Date</span> , </span>
<span>                         name<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"running duration (ms)"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span></span>
<span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fig</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fig</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">layout</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span></span>
<span>  title<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"two axis"</span>,</span>
<span>  yaxis2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ay</span>,</span>
<span>  xaxis <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span> title<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Days"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>,</span>
<span>  yaxis <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span> title<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Time I moved in miliseconds"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fig</span></span></code></pre></div>
<div class="cell-output-display">
<div id="htmlwidget-72331dbd5ee6067d1340" style="width:100%;height:464px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-72331dbd5ee6067d1340">{"x":{"visdat":{"272c5bc41806":["function () ","plotlyVisDat"]},"cur_data":"272c5bc41806","attrs":{"272c5bc41806":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar","y":[4692410,8268890,280798,2238747,964934,3067374,495389,2023040,4544250,2041530,2393305,3972956,8566168,2732452,8515802,7129666,5477568,2818776,4782628,6687952,3825091,4619238,10143314,6254518,3705681,5218066,6432516,5771661,7615276,6893382,8470907,5125686,3648907,9157310,5674376,6059686,6347626,4217324,4939693,3691972,3750853,6731734,2112152,4670228,4545966,9400721,4943733,5867037,8883824,5089200,4831997,3555188,2667542,1543437,1731255,2204164,5277837,729656,1371836,2255180,7053267,1272187,3193064,1483114,1647310,2236062,1617829,6392618,3532027,2021415,1509249,1431150,1120502,3948706,1955771,2053053,4805669,3170148,1424340,5029735,276405,2520564,1789845,3459248,3971789,2241081,2286224,1939966,4020597,1797704,1811276,2587427,4343071,2091342,1616315,1907439,8343499,6110434,3500841,1962309,3521952,3217021,2793114,1303925,2297871,7704899,2960016,4360562,7055385,4753016,5978143,2807534,4318857,6991533,4973203,3612277,3509518,3751170],"x":["2021-05-17","2021-05-19","2021-05-22","2021-05-23","2021-05-31","2021-06-10","2021-06-11","2021-06-13","2021-06-18","2021-06-20","2021-06-27","2021-07-04","2021-07-08","2021-07-09","2021-07-10","2021-07-11","2021-07-12","2021-07-27","2021-07-31","2021-08-04","2021-08-09","2021-08-11","2021-08-12","2021-08-13","2021-08-14","2021-08-15","2021-08-18","2021-08-19","2021-08-20","2021-08-23","2021-08-25","2021-08-26","2021-08-27","2021-08-28","2021-08-30","2021-09-01","2021-09-02","2021-09-03","2021-09-05","2021-09-06","2021-09-07","2021-09-08","2021-09-09","2021-09-12","2021-09-13","2021-09-14","2021-09-16","2021-09-17","2021-09-18","2021-09-21","2021-09-22","2021-09-24","2021-09-26","2021-09-29","2021-09-30","2021-10-02","2021-10-05","2021-10-06","2021-10-08","2021-10-11","2021-10-12","2021-10-16","2021-10-18","2021-10-19","2021-10-28","2021-11-04","2021-11-18","2021-11-19","2021-12-03","2021-12-06","2021-12-13","2022-01-07","2022-01-10","2022-02-05","2022-02-25","2022-02-28","2022-03-04","2022-03-07","2022-03-08","2022-03-09","2022-03-13","2022-03-19","2022-04-19","2022-04-23","2022-04-27","2022-05-01","2022-05-02","2022-05-29","2022-06-05","2022-06-09","2022-06-13","2022-06-14","2022-06-20","2022-06-21","2022-06-23","2022-07-01","2022-07-05","2022-07-09","2022-07-10","2022-07-16","2022-07-25","2022-07-26","2022-07-27","2022-07-28","2022-08-03","2022-08-06","2022-08-15","2022-08-16","2022-08-19","2022-08-25","2022-09-11","2022-09-14","2022-10-01","2022-10-14","2022-10-21","2022-10-25","2022-10-26","2022-11-01"],"name":"walking duration (ms)","inherit":true},"272c5bc41806.1":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","mode":"lines+markers","y":[424601,93935,1672131,1453615,60805,90896,77057,90432,60721,212319,90538,167538,181778,91152,152897,94011,2210676,243017,65449,121078,156732,583661,121518,855175,743917,1133995,1906950,860852,1120919,1048265,186485,1429868,1059961,789246,773492,1401775,874125,1813725,788884,726249,1515266,907409,1004206,1371745,1731522,221527,1428964,1547525,90835,670931,1148892,60269,621585,85017,30106,665674,789509,60263,60281,150592,1281511,60755,725901,89803,193396,156749,136501,122331,64328,145667,211762,81477,91307,90290,166399,77116,161714,104718,262065,174854,73443,172056,133172,976833,60171,1899077,137960,151820,90486,120996,208589,30340,154557,121434,60770,96517,91179,60264,85316,67072,2830944,638888,545250,60273,138238,514960,212153,212605,212650,181763,60572,90579,211911,31165,138206,150760,96518,60612],"x":["2021-05-17","2021-05-19","2021-05-22","2021-05-23","2021-05-31","2021-06-10","2021-06-11","2021-06-13","2021-06-18","2021-06-20","2021-06-27","2021-07-04","2021-07-08","2021-07-09","2021-07-10","2021-07-11","2021-07-12","2021-07-27","2021-07-31","2021-08-04","2021-08-09","2021-08-11","2021-08-12","2021-08-13","2021-08-14","2021-08-15","2021-08-18","2021-08-19","2021-08-20","2021-08-23","2021-08-25","2021-08-26","2021-08-27","2021-08-28","2021-08-30","2021-09-01","2021-09-02","2021-09-03","2021-09-05","2021-09-06","2021-09-07","2021-09-08","2021-09-09","2021-09-12","2021-09-13","2021-09-14","2021-09-16","2021-09-17","2021-09-18","2021-09-21","2021-09-22","2021-09-24","2021-09-26","2021-09-29","2021-09-30","2021-10-02","2021-10-05","2021-10-06","2021-10-08","2021-10-11","2021-10-12","2021-10-16","2021-10-18","2021-10-19","2021-10-28","2021-11-04","2021-11-18","2021-11-19","2021-12-03","2021-12-06","2021-12-13","2022-01-07","2022-01-10","2022-02-05","2022-02-25","2022-02-28","2022-03-04","2022-03-07","2022-03-08","2022-03-09","2022-03-13","2022-03-19","2022-04-19","2022-04-23","2022-04-27","2022-05-01","2022-05-02","2022-05-29","2022-06-05","2022-06-09","2022-06-13","2022-06-14","2022-06-20","2022-06-21","2022-06-23","2022-07-01","2022-07-05","2022-07-09","2022-07-10","2022-07-16","2022-07-25","2022-07-26","2022-07-27","2022-07-28","2022-08-03","2022-08-06","2022-08-15","2022-08-16","2022-08-19","2022-08-25","2022-09-11","2022-09-14","2022-10-01","2022-10-14","2022-10-21","2022-10-25","2022-10-26","2022-11-01"],"name":"running duration (ms)","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"two axis","yaxis2":{"tickfont":{"color":"red"},"overlaying":"y","side":"right","title":"<b> secondary<\/b> y axis"},"xaxis":{"domain":[0,1],"automargin":true,"title":"Days","type":"category","categoryorder":"array","categoryarray":["2021-05-17","2021-05-19","2021-05-22","2021-05-23","2021-05-31","2021-06-10","2021-06-11","2021-06-13","2021-06-18","2021-06-20","2021-06-27","2021-07-04","2021-07-08","2021-07-09","2021-07-10","2021-07-11","2021-07-12","2021-07-27","2021-07-31","2021-08-04","2021-08-09","2021-08-11","2021-08-12","2021-08-13","2021-08-14","2021-08-15","2021-08-18","2021-08-19","2021-08-20","2021-08-23","2021-08-25","2021-08-26","2021-08-27","2021-08-28","2021-08-30","2021-09-01","2021-09-02","2021-09-03","2021-09-05","2021-09-06","2021-09-07","2021-09-08","2021-09-09","2021-09-12","2021-09-13","2021-09-14","2021-09-16","2021-09-17","2021-09-18","2021-09-21","2021-09-22","2021-09-24","2021-09-26","2021-09-29","2021-09-30","2021-10-02","2021-10-05","2021-10-06","2021-10-08","2021-10-11","2021-10-12","2021-10-16","2021-10-18","2021-10-19","2021-10-28","2021-11-04","2021-11-18","2021-11-19","2021-12-03","2021-12-06","2021-12-13","2022-01-07","2022-01-10","2022-02-05","2022-02-25","2022-02-28","2022-03-04","2022-03-07","2022-03-08","2022-03-09","2022-03-13","2022-03-19","2022-04-19","2022-04-23","2022-04-27","2022-05-01","2022-05-02","2022-05-29","2022-06-05","2022-06-09","2022-06-13","2022-06-14","2022-06-20","2022-06-21","2022-06-23","2022-07-01","2022-07-05","2022-07-09","2022-07-10","2022-07-16","2022-07-25","2022-07-26","2022-07-27","2022-07-28","2022-08-03","2022-08-06","2022-08-15","2022-08-16","2022-08-19","2022-08-25","2022-09-11","2022-09-14","2022-10-01","2022-10-14","2022-10-21","2022-10-25","2022-10-26","2022-11-01"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Time I moved in miliseconds"},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"type":"bar","y":[4692410,8268890,280798,2238747,964934,3067374,495389,2023040,4544250,2041530,2393305,3972956,8566168,2732452,8515802,7129666,5477568,2818776,4782628,6687952,3825091,4619238,10143314,6254518,3705681,5218066,6432516,5771661,7615276,6893382,8470907,5125686,3648907,9157310,5674376,6059686,6347626,4217324,4939693,3691972,3750853,6731734,2112152,4670228,4545966,9400721,4943733,5867037,8883824,5089200,4831997,3555188,2667542,1543437,1731255,2204164,5277837,729656,1371836,2255180,7053267,1272187,3193064,1483114,1647310,2236062,1617829,6392618,3532027,2021415,1509249,1431150,1120502,3948706,1955771,2053053,4805669,3170148,1424340,5029735,276405,2520564,1789845,3459248,3971789,2241081,2286224,1939966,4020597,1797704,1811276,2587427,4343071,2091342,1616315,1907439,8343499,6110434,3500841,1962309,3521952,3217021,2793114,1303925,2297871,7704899,2960016,4360562,7055385,4753016,5978143,2807534,4318857,6991533,4973203,3612277,3509518,3751170],"x":["2021-05-17","2021-05-19","2021-05-22","2021-05-23","2021-05-31","2021-06-10","2021-06-11","2021-06-13","2021-06-18","2021-06-20","2021-06-27","2021-07-04","2021-07-08","2021-07-09","2021-07-10","2021-07-11","2021-07-12","2021-07-27","2021-07-31","2021-08-04","2021-08-09","2021-08-11","2021-08-12","2021-08-13","2021-08-14","2021-08-15","2021-08-18","2021-08-19","2021-08-20","2021-08-23","2021-08-25","2021-08-26","2021-08-27","2021-08-28","2021-08-30","2021-09-01","2021-09-02","2021-09-03","2021-09-05","2021-09-06","2021-09-07","2021-09-08","2021-09-09","2021-09-12","2021-09-13","2021-09-14","2021-09-16","2021-09-17","2021-09-18","2021-09-21","2021-09-22","2021-09-24","2021-09-26","2021-09-29","2021-09-30","2021-10-02","2021-10-05","2021-10-06","2021-10-08","2021-10-11","2021-10-12","2021-10-16","2021-10-18","2021-10-19","2021-10-28","2021-11-04","2021-11-18","2021-11-19","2021-12-03","2021-12-06","2021-12-13","2022-01-07","2022-01-10","2022-02-05","2022-02-25","2022-02-28","2022-03-04","2022-03-07","2022-03-08","2022-03-09","2022-03-13","2022-03-19","2022-04-19","2022-04-23","2022-04-27","2022-05-01","2022-05-02","2022-05-29","2022-06-05","2022-06-09","2022-06-13","2022-06-14","2022-06-20","2022-06-21","2022-06-23","2022-07-01","2022-07-05","2022-07-09","2022-07-10","2022-07-16","2022-07-25","2022-07-26","2022-07-27","2022-07-28","2022-08-03","2022-08-06","2022-08-15","2022-08-16","2022-08-19","2022-08-25","2022-09-11","2022-09-14","2022-10-01","2022-10-14","2022-10-21","2022-10-25","2022-10-26","2022-11-01"],"name":"walking duration (ms)","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"type":"scatter","mode":"lines+markers","y":[424601,93935,1672131,1453615,60805,90896,77057,90432,60721,212319,90538,167538,181778,91152,152897,94011,2210676,243017,65449,121078,156732,583661,121518,855175,743917,1133995,1906950,860852,1120919,1048265,186485,1429868,1059961,789246,773492,1401775,874125,1813725,788884,726249,1515266,907409,1004206,1371745,1731522,221527,1428964,1547525,90835,670931,1148892,60269,621585,85017,30106,665674,789509,60263,60281,150592,1281511,60755,725901,89803,193396,156749,136501,122331,64328,145667,211762,81477,91307,90290,166399,77116,161714,104718,262065,174854,73443,172056,133172,976833,60171,1899077,137960,151820,90486,120996,208589,30340,154557,121434,60770,96517,91179,60264,85316,67072,2830944,638888,545250,60273,138238,514960,212153,212605,212650,181763,60572,90579,211911,31165,138206,150760,96518,60612],"x":["2021-05-17","2021-05-19","2021-05-22","2021-05-23","2021-05-31","2021-06-10","2021-06-11","2021-06-13","2021-06-18","2021-06-20","2021-06-27","2021-07-04","2021-07-08","2021-07-09","2021-07-10","2021-07-11","2021-07-12","2021-07-27","2021-07-31","2021-08-04","2021-08-09","2021-08-11","2021-08-12","2021-08-13","2021-08-14","2021-08-15","2021-08-18","2021-08-19","2021-08-20","2021-08-23","2021-08-25","2021-08-26","2021-08-27","2021-08-28","2021-08-30","2021-09-01","2021-09-02","2021-09-03","2021-09-05","2021-09-06","2021-09-07","2021-09-08","2021-09-09","2021-09-12","2021-09-13","2021-09-14","2021-09-16","2021-09-17","2021-09-18","2021-09-21","2021-09-22","2021-09-24","2021-09-26","2021-09-29","2021-09-30","2021-10-02","2021-10-05","2021-10-06","2021-10-08","2021-10-11","2021-10-12","2021-10-16","2021-10-18","2021-10-19","2021-10-28","2021-11-04","2021-11-18","2021-11-19","2021-12-03","2021-12-06","2021-12-13","2022-01-07","2022-01-10","2022-02-05","2022-02-25","2022-02-28","2022-03-04","2022-03-07","2022-03-08","2022-03-09","2022-03-13","2022-03-19","2022-04-19","2022-04-23","2022-04-27","2022-05-01","2022-05-02","2022-05-29","2022-06-05","2022-06-09","2022-06-13","2022-06-14","2022-06-20","2022-06-21","2022-06-23","2022-07-01","2022-07-05","2022-07-09","2022-07-10","2022-07-16","2022-07-25","2022-07-26","2022-07-27","2022-07-28","2022-08-03","2022-08-06","2022-08-15","2022-08-16","2022-08-19","2022-08-25","2022-09-11","2022-09-14","2022-10-01","2022-10-14","2022-10-21","2022-10-25","2022-10-26","2022-11-01"],"name":"running duration (ms)","marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"line":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>This chart brings another aspect of my exercise routine. The days I ran in the last year, I walked a lot more than I ran, obviously. One exception to that might be 25th of July when I almost walked and ran same amount of time.</p>
<p>Now, besides time, let’s add another dimension of distance. This chart will have another y axis. We need to let plotly know that we will use another dimension. <code>overlaying = "y"</code> argument will do it. Also, we use another <code>addtrace</code> function to add the second y axis properties. <code>yaxis="y2"</code> argument will link this trace to our new dimension. <code>y2</code> here is defined by <code>plotly</code> as default setting.</p>
<div class="cell">
<div class="sourceCode" id="cb12" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ay</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span></span>
<span>  tickfont <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>color <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>,</span>
<span>  overlaying <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y"</span>,</span>
<span>  side<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"right"</span>,</span>
<span>  title<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;b&gt; Distance I walked in meters &lt;/b&gt;"</span></span>
<span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span></span>
<span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fig</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plotly</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/plotly/man/plot_ly.html">plot_ly</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fig</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fig</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/plotly/man/add_trace.html">add_trace</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data_for_plotting</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Move.Minutes.count</span>,</span>
<span>            x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data_for_plotting</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Date</span>, </span>
<span>            name<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"movemnt(min.)"</span>, </span>
<span>            type <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bar"</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span></span>
<span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fig</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fig</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/plotly/man/add_trace.html">add_trace</a></span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data_for_plotting</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Distance..m.</span>, </span>
<span>                         x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data_for_plotting</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Date</span> , </span>
<span>                         name<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"distance(m.)"</span>, yaxis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y2"</span>,</span>
<span>                         type <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"scatter"</span>, mode<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lines+markers"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fig</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fig</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">layout</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span></span>
<span>  title<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"My movement VS distance  &lt;b&gt;in 2022&lt;/b&gt;"</span>,</span>
<span>  yaxis2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ay</span>,</span>
<span>  xaxis <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span> title<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;b&gt;Days&lt;/b&gt;"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>,</span>
<span>  yaxis <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span> title<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;b&gt; Time I moved in minutes &lt;/b&gt; "</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fig</span></span></code></pre></div>
<div class="cell-output-display">
<div id="htmlwidget-5b57898cf84a75214d88" style="width:100%;height:464px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-5b57898cf84a75214d88">{"x":{"visdat":{"272c15f53929":["function () ","plotlyVisDat"]},"cur_data":"272c15f53929","attrs":{"272c15f53929":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"y":[79,140,33,62,25,72,17,41,97,35,38,90,139,64,142,136,124,63,92,133,70,103,181,134,82,112,129,130,152,149,110,103,79,182,113,135,146,110,110,79,104,127,60,122,103,199,110,132,155,102,93,65,63,50,43,67,121,44,49,23,162,35,69,40,33,57,60,134,62,48,46,32,49,60,63,45,111,68,43,104,11,77,71,92,86,93,53,60,96,34,44,74,68,63,51,57,126,116,83,37,108,85,98,40,67,151,47,94,121,115,117,55,101,117,90,83,78,74],"x":["2021-05-17","2021-05-19","2021-05-22","2021-05-23","2021-05-31","2021-06-10","2021-06-11","2021-06-13","2021-06-18","2021-06-20","2021-06-27","2021-07-04","2021-07-08","2021-07-09","2021-07-10","2021-07-11","2021-07-12","2021-07-27","2021-07-31","2021-08-04","2021-08-09","2021-08-11","2021-08-12","2021-08-13","2021-08-14","2021-08-15","2021-08-18","2021-08-19","2021-08-20","2021-08-23","2021-08-25","2021-08-26","2021-08-27","2021-08-28","2021-08-30","2021-09-01","2021-09-02","2021-09-03","2021-09-05","2021-09-06","2021-09-07","2021-09-08","2021-09-09","2021-09-12","2021-09-13","2021-09-14","2021-09-16","2021-09-17","2021-09-18","2021-09-21","2021-09-22","2021-09-24","2021-09-26","2021-09-29","2021-09-30","2021-10-02","2021-10-05","2021-10-06","2021-10-08","2021-10-11","2021-10-12","2021-10-16","2021-10-18","2021-10-19","2021-10-28","2021-11-04","2021-11-18","2021-11-19","2021-12-03","2021-12-06","2021-12-13","2022-01-07","2022-01-10","2022-02-05","2022-02-25","2022-02-28","2022-03-04","2022-03-07","2022-03-08","2022-03-09","2022-03-13","2022-03-19","2022-04-19","2022-04-23","2022-04-27","2022-05-01","2022-05-02","2022-05-29","2022-06-05","2022-06-09","2022-06-13","2022-06-14","2022-06-20","2022-06-21","2022-06-23","2022-07-01","2022-07-05","2022-07-09","2022-07-10","2022-07-16","2022-07-25","2022-07-26","2022-07-27","2022-07-28","2022-08-03","2022-08-06","2022-08-15","2022-08-16","2022-08-19","2022-08-25","2022-09-11","2022-09-14","2022-10-01","2022-10-14","2022-10-21","2022-10-25","2022-10-26","2022-11-01"],"name":"movemnt(min.)","type":"bar","inherit":true},"272c15f53929.1":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"y":[3978.95,9714.47,2806.12,4310.05,994.99,3758.57,845.97,2216.71,5379.95,2038.22,2160.35,5333.26,8330.72,2308.1,6568.62,6247.73,5484.57,3229.55,5412.06,7540.2,4607.82,6063.13,11212.15,9292.42,5698.96,7831.29,9466.05,8678.01,8904.74,8222.8,4020.49,8255.96,5551.35,11203.33,8325.93,8876.98,8918,8062.81,7408.37,6304.04,8030.82,8248.59,4782.24,7741.82,7622.35,9264.98,6964.87,7493.81,8506.53,6549.23,6622.39,3540.49,4858.77,2157.86,2248.82,3599.88,8756,1454.79,1870.3,886.45,10437,1262.71,4943.18,1539.89,1625.1,1891.53,2121.47,6468.59,2748.08,1995.96,2010.46,1183.99,1714.16,2452.77,2256.18,1905.57,4029.66,3364.32,1580.25,4611.37,589.78,3346.99,2108.86,5786.77,3687.62,4347.44,1994.89,2790.49,3762.68,1563.13,1699.24,3144.05,2348.81,2132.23,2118.4,2186.05,5808.04,6196.31,3084,1688.39,6615.7,4786.44,3942.07,1649.8,2607.46,6968.82,2038.62,4547.84,6202.18,4509,5487.67,2258.84,4504.11,5815.54,4765.25,3982.46,3395.1,3995.35],"x":["2021-05-17","2021-05-19","2021-05-22","2021-05-23","2021-05-31","2021-06-10","2021-06-11","2021-06-13","2021-06-18","2021-06-20","2021-06-27","2021-07-04","2021-07-08","2021-07-09","2021-07-10","2021-07-11","2021-07-12","2021-07-27","2021-07-31","2021-08-04","2021-08-09","2021-08-11","2021-08-12","2021-08-13","2021-08-14","2021-08-15","2021-08-18","2021-08-19","2021-08-20","2021-08-23","2021-08-25","2021-08-26","2021-08-27","2021-08-28","2021-08-30","2021-09-01","2021-09-02","2021-09-03","2021-09-05","2021-09-06","2021-09-07","2021-09-08","2021-09-09","2021-09-12","2021-09-13","2021-09-14","2021-09-16","2021-09-17","2021-09-18","2021-09-21","2021-09-22","2021-09-24","2021-09-26","2021-09-29","2021-09-30","2021-10-02","2021-10-05","2021-10-06","2021-10-08","2021-10-11","2021-10-12","2021-10-16","2021-10-18","2021-10-19","2021-10-28","2021-11-04","2021-11-18","2021-11-19","2021-12-03","2021-12-06","2021-12-13","2022-01-07","2022-01-10","2022-02-05","2022-02-25","2022-02-28","2022-03-04","2022-03-07","2022-03-08","2022-03-09","2022-03-13","2022-03-19","2022-04-19","2022-04-23","2022-04-27","2022-05-01","2022-05-02","2022-05-29","2022-06-05","2022-06-09","2022-06-13","2022-06-14","2022-06-20","2022-06-21","2022-06-23","2022-07-01","2022-07-05","2022-07-09","2022-07-10","2022-07-16","2022-07-25","2022-07-26","2022-07-27","2022-07-28","2022-08-03","2022-08-06","2022-08-15","2022-08-16","2022-08-19","2022-08-25","2022-09-11","2022-09-14","2022-10-01","2022-10-14","2022-10-21","2022-10-25","2022-10-26","2022-11-01"],"name":"distance(m.)","yaxis":"y2","type":"scatter","mode":"lines+markers","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"My movement VS distance  <b>in 2022<\/b>","yaxis2":{"tickfont":{"color":"red"},"overlaying":"y","side":"right","title":"<b> Distance I walked in meters <\/b>"},"xaxis":{"domain":[0,1],"automargin":true,"title":"<b>Days<\/b>","type":"category","categoryorder":"array","categoryarray":["2021-05-17","2021-05-19","2021-05-22","2021-05-23","2021-05-31","2021-06-10","2021-06-11","2021-06-13","2021-06-18","2021-06-20","2021-06-27","2021-07-04","2021-07-08","2021-07-09","2021-07-10","2021-07-11","2021-07-12","2021-07-27","2021-07-31","2021-08-04","2021-08-09","2021-08-11","2021-08-12","2021-08-13","2021-08-14","2021-08-15","2021-08-18","2021-08-19","2021-08-20","2021-08-23","2021-08-25","2021-08-26","2021-08-27","2021-08-28","2021-08-30","2021-09-01","2021-09-02","2021-09-03","2021-09-05","2021-09-06","2021-09-07","2021-09-08","2021-09-09","2021-09-12","2021-09-13","2021-09-14","2021-09-16","2021-09-17","2021-09-18","2021-09-21","2021-09-22","2021-09-24","2021-09-26","2021-09-29","2021-09-30","2021-10-02","2021-10-05","2021-10-06","2021-10-08","2021-10-11","2021-10-12","2021-10-16","2021-10-18","2021-10-19","2021-10-28","2021-11-04","2021-11-18","2021-11-19","2021-12-03","2021-12-06","2021-12-13","2022-01-07","2022-01-10","2022-02-05","2022-02-25","2022-02-28","2022-03-04","2022-03-07","2022-03-08","2022-03-09","2022-03-13","2022-03-19","2022-04-19","2022-04-23","2022-04-27","2022-05-01","2022-05-02","2022-05-29","2022-06-05","2022-06-09","2022-06-13","2022-06-14","2022-06-20","2022-06-21","2022-06-23","2022-07-01","2022-07-05","2022-07-09","2022-07-10","2022-07-16","2022-07-25","2022-07-26","2022-07-27","2022-07-28","2022-08-03","2022-08-06","2022-08-15","2022-08-16","2022-08-19","2022-08-25","2022-09-11","2022-09-14","2022-10-01","2022-10-14","2022-10-21","2022-10-25","2022-10-26","2022-11-01"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"<b> Time I moved in minutes <\/b> "},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"y":[79,140,33,62,25,72,17,41,97,35,38,90,139,64,142,136,124,63,92,133,70,103,181,134,82,112,129,130,152,149,110,103,79,182,113,135,146,110,110,79,104,127,60,122,103,199,110,132,155,102,93,65,63,50,43,67,121,44,49,23,162,35,69,40,33,57,60,134,62,48,46,32,49,60,63,45,111,68,43,104,11,77,71,92,86,93,53,60,96,34,44,74,68,63,51,57,126,116,83,37,108,85,98,40,67,151,47,94,121,115,117,55,101,117,90,83,78,74],"x":["2021-05-17","2021-05-19","2021-05-22","2021-05-23","2021-05-31","2021-06-10","2021-06-11","2021-06-13","2021-06-18","2021-06-20","2021-06-27","2021-07-04","2021-07-08","2021-07-09","2021-07-10","2021-07-11","2021-07-12","2021-07-27","2021-07-31","2021-08-04","2021-08-09","2021-08-11","2021-08-12","2021-08-13","2021-08-14","2021-08-15","2021-08-18","2021-08-19","2021-08-20","2021-08-23","2021-08-25","2021-08-26","2021-08-27","2021-08-28","2021-08-30","2021-09-01","2021-09-02","2021-09-03","2021-09-05","2021-09-06","2021-09-07","2021-09-08","2021-09-09","2021-09-12","2021-09-13","2021-09-14","2021-09-16","2021-09-17","2021-09-18","2021-09-21","2021-09-22","2021-09-24","2021-09-26","2021-09-29","2021-09-30","2021-10-02","2021-10-05","2021-10-06","2021-10-08","2021-10-11","2021-10-12","2021-10-16","2021-10-18","2021-10-19","2021-10-28","2021-11-04","2021-11-18","2021-11-19","2021-12-03","2021-12-06","2021-12-13","2022-01-07","2022-01-10","2022-02-05","2022-02-25","2022-02-28","2022-03-04","2022-03-07","2022-03-08","2022-03-09","2022-03-13","2022-03-19","2022-04-19","2022-04-23","2022-04-27","2022-05-01","2022-05-02","2022-05-29","2022-06-05","2022-06-09","2022-06-13","2022-06-14","2022-06-20","2022-06-21","2022-06-23","2022-07-01","2022-07-05","2022-07-09","2022-07-10","2022-07-16","2022-07-25","2022-07-26","2022-07-27","2022-07-28","2022-08-03","2022-08-06","2022-08-15","2022-08-16","2022-08-19","2022-08-25","2022-09-11","2022-09-14","2022-10-01","2022-10-14","2022-10-21","2022-10-25","2022-10-26","2022-11-01"],"name":"movemnt(min.)","type":"bar","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"y":[3978.95,9714.47,2806.12,4310.05,994.99,3758.57,845.97,2216.71,5379.95,2038.22,2160.35,5333.26,8330.72,2308.1,6568.62,6247.73,5484.57,3229.55,5412.06,7540.2,4607.82,6063.13,11212.15,9292.42,5698.96,7831.29,9466.05,8678.01,8904.74,8222.8,4020.49,8255.96,5551.35,11203.33,8325.93,8876.98,8918,8062.81,7408.37,6304.04,8030.82,8248.59,4782.24,7741.82,7622.35,9264.98,6964.87,7493.81,8506.53,6549.23,6622.39,3540.49,4858.77,2157.86,2248.82,3599.88,8756,1454.79,1870.3,886.45,10437,1262.71,4943.18,1539.89,1625.1,1891.53,2121.47,6468.59,2748.08,1995.96,2010.46,1183.99,1714.16,2452.77,2256.18,1905.57,4029.66,3364.32,1580.25,4611.37,589.78,3346.99,2108.86,5786.77,3687.62,4347.44,1994.89,2790.49,3762.68,1563.13,1699.24,3144.05,2348.81,2132.23,2118.4,2186.05,5808.04,6196.31,3084,1688.39,6615.7,4786.44,3942.07,1649.8,2607.46,6968.82,2038.62,4547.84,6202.18,4509,5487.67,2258.84,4504.11,5815.54,4765.25,3982.46,3395.1,3995.35],"x":["2021-05-17","2021-05-19","2021-05-22","2021-05-23","2021-05-31","2021-06-10","2021-06-11","2021-06-13","2021-06-18","2021-06-20","2021-06-27","2021-07-04","2021-07-08","2021-07-09","2021-07-10","2021-07-11","2021-07-12","2021-07-27","2021-07-31","2021-08-04","2021-08-09","2021-08-11","2021-08-12","2021-08-13","2021-08-14","2021-08-15","2021-08-18","2021-08-19","2021-08-20","2021-08-23","2021-08-25","2021-08-26","2021-08-27","2021-08-28","2021-08-30","2021-09-01","2021-09-02","2021-09-03","2021-09-05","2021-09-06","2021-09-07","2021-09-08","2021-09-09","2021-09-12","2021-09-13","2021-09-14","2021-09-16","2021-09-17","2021-09-18","2021-09-21","2021-09-22","2021-09-24","2021-09-26","2021-09-29","2021-09-30","2021-10-02","2021-10-05","2021-10-06","2021-10-08","2021-10-11","2021-10-12","2021-10-16","2021-10-18","2021-10-19","2021-10-28","2021-11-04","2021-11-18","2021-11-19","2021-12-03","2021-12-06","2021-12-13","2022-01-07","2022-01-10","2022-02-05","2022-02-25","2022-02-28","2022-03-04","2022-03-07","2022-03-08","2022-03-09","2022-03-13","2022-03-19","2022-04-19","2022-04-23","2022-04-27","2022-05-01","2022-05-02","2022-05-29","2022-06-05","2022-06-09","2022-06-13","2022-06-14","2022-06-20","2022-06-21","2022-06-23","2022-07-01","2022-07-05","2022-07-09","2022-07-10","2022-07-16","2022-07-25","2022-07-26","2022-07-27","2022-07-28","2022-08-03","2022-08-06","2022-08-15","2022-08-16","2022-08-19","2022-08-25","2022-09-11","2022-09-14","2022-10-01","2022-10-14","2022-10-21","2022-10-25","2022-10-26","2022-11-01"],"name":"distance(m.)","yaxis":"y2","type":"scatter","mode":"lines+markers","marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"line":{"color":"rgba(255,127,14,1)"},"xaxis":"x","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>As the final result, you can see that on the first y axis there are the number of minutes (from 0 to 200) when I was in a moving state. On the other side, we have the distance I walked or run in meters (from 0 to 10k). For example; on sixth of Auust in 2022, I walked almost 7k meters in 150 minutes.</p>
<p>As a final step, let’s see the calories I burnt during that time. Another <code>addtrace</code> would help us draw the line for the calories that I burnt throughout these days:</p>
<div class="cell">
<div class="sourceCode" id="cb13" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fig</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plotly</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/plotly/man/plot_ly.html">plot_ly</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fig</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fig</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/plotly/man/add_trace.html">add_trace</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data_for_plotting</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Step.count</span>,</span>
<span>            x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data_for_plotting</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Date</span>, </span>
<span>            name<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Steps "</span>, </span>
<span>            type <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"scatter"</span>, mode<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lines"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fig</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fig</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/plotly/man/add_trace.html">add_trace</a></span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data_for_plotting</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Distance..m.</span>, </span>
<span>                         x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data_for_plotting</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Date</span> , </span>
<span>                         name<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"distance"</span>, </span>
<span>                         type <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bar"</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span></span>
<span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fig</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fig</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/plotly/man/add_trace.html">add_trace</a></span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data_for_plotting</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Calories..kcal.</span>, </span>
<span>                         x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data_for_plotting</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Date</span> , </span>
<span>                         name<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"calories"</span>,</span>
<span>                         type <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"scatter"</span>, mode<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lines"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span></span>
<span></span>
<span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fig</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fig</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">layout</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span></span>
<span>  title<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" &lt;b&gt;My movement in 2022&lt;/b&gt;"</span>,</span>
<span>  xaxis <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span> title<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;b&gt;Days&lt;/b&gt;"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>,</span>
<span>  yaxis <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span> title<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;b&gt; steps(n)&lt;/b&gt; / &lt;b&gt; distance(m)&lt;/b&gt; / &lt;b&gt; calories(kcal) &lt;/b&gt; "</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fig</span></span></code></pre></div>
<div class="cell-output-display">
<div id="htmlwidget-1af12229717c318d7243" style="width:100%;height:464px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-1af12229717c318d7243">{"x":{"visdat":{"272c66a1b64":["function () ","plotlyVisDat"]},"cur_data":"272c66a1b64","attrs":{"272c66a1b64":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"y":[6161,14000,3724,5939,1851,5839,1910,3557,8339,3303,3538,7909,12416,3984,10415,9901,8232,5217,8078,11405,6746,8791,16264,13129,7985,10774,12680,12357,12834,12315,6691,11218,7257,16395,11486,12290,12526,10955,10262,8425,10873,11782,6497,11060,10380,14294,9672,10604,12680,9556,9029,5594,6653,3337,3584,5226,11807,2332,3186,1635,14466,2150,6672,2607,2985,3368,3616,10011,4791,3199,3483,2070,3083,4205,3860,3206,6801,5183,2626,7272,1279,5847,3412,8175,5671,6731,3465,4833,6490,2945,2834,5298,3971,3635,3597,3598,9176,9820,5216,2787,9395,7356,6294,2761,4263,10897,3394,7179,9390,7314,8289,3730,7027,8814,7501,6070,5393,6100],"x":["2021-05-17","2021-05-19","2021-05-22","2021-05-23","2021-05-31","2021-06-10","2021-06-11","2021-06-13","2021-06-18","2021-06-20","2021-06-27","2021-07-04","2021-07-08","2021-07-09","2021-07-10","2021-07-11","2021-07-12","2021-07-27","2021-07-31","2021-08-04","2021-08-09","2021-08-11","2021-08-12","2021-08-13","2021-08-14","2021-08-15","2021-08-18","2021-08-19","2021-08-20","2021-08-23","2021-08-25","2021-08-26","2021-08-27","2021-08-28","2021-08-30","2021-09-01","2021-09-02","2021-09-03","2021-09-05","2021-09-06","2021-09-07","2021-09-08","2021-09-09","2021-09-12","2021-09-13","2021-09-14","2021-09-16","2021-09-17","2021-09-18","2021-09-21","2021-09-22","2021-09-24","2021-09-26","2021-09-29","2021-09-30","2021-10-02","2021-10-05","2021-10-06","2021-10-08","2021-10-11","2021-10-12","2021-10-16","2021-10-18","2021-10-19","2021-10-28","2021-11-04","2021-11-18","2021-11-19","2021-12-03","2021-12-06","2021-12-13","2022-01-07","2022-01-10","2022-02-05","2022-02-25","2022-02-28","2022-03-04","2022-03-07","2022-03-08","2022-03-09","2022-03-13","2022-03-19","2022-04-19","2022-04-23","2022-04-27","2022-05-01","2022-05-02","2022-05-29","2022-06-05","2022-06-09","2022-06-13","2022-06-14","2022-06-20","2022-06-21","2022-06-23","2022-07-01","2022-07-05","2022-07-09","2022-07-10","2022-07-16","2022-07-25","2022-07-26","2022-07-27","2022-07-28","2022-08-03","2022-08-06","2022-08-15","2022-08-16","2022-08-19","2022-08-25","2022-09-11","2022-09-14","2022-10-01","2022-10-14","2022-10-21","2022-10-25","2022-10-26","2022-11-01"],"name":"Steps ","type":"scatter","mode":"lines","inherit":true},"272c66a1b64.1":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"y":[3978.95,9714.47,2806.12,4310.05,994.99,3758.57,845.97,2216.71,5379.95,2038.22,2160.35,5333.26,8330.72,2308.1,6568.62,6247.73,5484.57,3229.55,5412.06,7540.2,4607.82,6063.13,11212.15,9292.42,5698.96,7831.29,9466.05,8678.01,8904.74,8222.8,4020.49,8255.96,5551.35,11203.33,8325.93,8876.98,8918,8062.81,7408.37,6304.04,8030.82,8248.59,4782.24,7741.82,7622.35,9264.98,6964.87,7493.81,8506.53,6549.23,6622.39,3540.49,4858.77,2157.86,2248.82,3599.88,8756,1454.79,1870.3,886.45,10437,1262.71,4943.18,1539.89,1625.1,1891.53,2121.47,6468.59,2748.08,1995.96,2010.46,1183.99,1714.16,2452.77,2256.18,1905.57,4029.66,3364.32,1580.25,4611.37,589.78,3346.99,2108.86,5786.77,3687.62,4347.44,1994.89,2790.49,3762.68,1563.13,1699.24,3144.05,2348.81,2132.23,2118.4,2186.05,5808.04,6196.31,3084,1688.39,6615.7,4786.44,3942.07,1649.8,2607.46,6968.82,2038.62,4547.84,6202.18,4509,5487.67,2258.84,4504.11,5815.54,4765.25,3982.46,3395.1,3995.35],"x":["2021-05-17","2021-05-19","2021-05-22","2021-05-23","2021-05-31","2021-06-10","2021-06-11","2021-06-13","2021-06-18","2021-06-20","2021-06-27","2021-07-04","2021-07-08","2021-07-09","2021-07-10","2021-07-11","2021-07-12","2021-07-27","2021-07-31","2021-08-04","2021-08-09","2021-08-11","2021-08-12","2021-08-13","2021-08-14","2021-08-15","2021-08-18","2021-08-19","2021-08-20","2021-08-23","2021-08-25","2021-08-26","2021-08-27","2021-08-28","2021-08-30","2021-09-01","2021-09-02","2021-09-03","2021-09-05","2021-09-06","2021-09-07","2021-09-08","2021-09-09","2021-09-12","2021-09-13","2021-09-14","2021-09-16","2021-09-17","2021-09-18","2021-09-21","2021-09-22","2021-09-24","2021-09-26","2021-09-29","2021-09-30","2021-10-02","2021-10-05","2021-10-06","2021-10-08","2021-10-11","2021-10-12","2021-10-16","2021-10-18","2021-10-19","2021-10-28","2021-11-04","2021-11-18","2021-11-19","2021-12-03","2021-12-06","2021-12-13","2022-01-07","2022-01-10","2022-02-05","2022-02-25","2022-02-28","2022-03-04","2022-03-07","2022-03-08","2022-03-09","2022-03-13","2022-03-19","2022-04-19","2022-04-23","2022-04-27","2022-05-01","2022-05-02","2022-05-29","2022-06-05","2022-06-09","2022-06-13","2022-06-14","2022-06-20","2022-06-21","2022-06-23","2022-07-01","2022-07-05","2022-07-09","2022-07-10","2022-07-16","2022-07-25","2022-07-26","2022-07-27","2022-07-28","2022-08-03","2022-08-06","2022-08-15","2022-08-16","2022-08-19","2022-08-25","2022-09-11","2022-09-14","2022-10-01","2022-10-14","2022-10-21","2022-10-25","2022-10-26","2022-11-01"],"name":"distance","type":"bar","inherit":true},"272c66a1b64.2":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"y":[2016.47,2201.5,1912.17,2007.93,1719.06,1860.97,1690.76,1792.62,1953.07,1811.82,1816.84,1931.81,2239.03,1839.11,2226.35,2127.03,2331.44,1867.17,1969.36,2102.18,1920.23,2035.17,2328.13,2228.6,2074.02,2254.16,2461.36,2236.67,2398.01,2330.44,2301.68,2305.22,2110.49,2383.01,2192.89,2284.46,2226.82,2235.33,2119.53,2055.41,2143.03,2258.33,1978.62,2173.45,2222.13,2294.34,2209.13,2265.2,2241.25,2081.3,2148.43,1891.53,1918.62,1760.46,1765.02,1899.93,2147.14,1703.6,1745.59,1816.68,2313.61,1739.15,1977.85,1757.22,1783.25,1816.33,1772.92,2083.02,1887.43,1800.67,1776.93,1752.6,1733.74,1918.5,1799.43,1792.62,1985.07,1869.73,1780.42,2001.66,1675.91,1837.2,1853.51,2019.99,1915.56,2073.84,1816.84,1796.25,1923.23,1782.4,1796.21,1820.65,1953.77,1801.66,1761.65,1785.96,2205.97,2055.41,1888.48,1785.2,2295.13,1951.64,1910.1,1741.15,1817.64,2226.77,1871.85,1963.61,2139.68,1984.59,2132.28,1843.93,1960.65,2108.72,1992.56,1905.43,1890.71,1901.21],"x":["2021-05-17","2021-05-19","2021-05-22","2021-05-23","2021-05-31","2021-06-10","2021-06-11","2021-06-13","2021-06-18","2021-06-20","2021-06-27","2021-07-04","2021-07-08","2021-07-09","2021-07-10","2021-07-11","2021-07-12","2021-07-27","2021-07-31","2021-08-04","2021-08-09","2021-08-11","2021-08-12","2021-08-13","2021-08-14","2021-08-15","2021-08-18","2021-08-19","2021-08-20","2021-08-23","2021-08-25","2021-08-26","2021-08-27","2021-08-28","2021-08-30","2021-09-01","2021-09-02","2021-09-03","2021-09-05","2021-09-06","2021-09-07","2021-09-08","2021-09-09","2021-09-12","2021-09-13","2021-09-14","2021-09-16","2021-09-17","2021-09-18","2021-09-21","2021-09-22","2021-09-24","2021-09-26","2021-09-29","2021-09-30","2021-10-02","2021-10-05","2021-10-06","2021-10-08","2021-10-11","2021-10-12","2021-10-16","2021-10-18","2021-10-19","2021-10-28","2021-11-04","2021-11-18","2021-11-19","2021-12-03","2021-12-06","2021-12-13","2022-01-07","2022-01-10","2022-02-05","2022-02-25","2022-02-28","2022-03-04","2022-03-07","2022-03-08","2022-03-09","2022-03-13","2022-03-19","2022-04-19","2022-04-23","2022-04-27","2022-05-01","2022-05-02","2022-05-29","2022-06-05","2022-06-09","2022-06-13","2022-06-14","2022-06-20","2022-06-21","2022-06-23","2022-07-01","2022-07-05","2022-07-09","2022-07-10","2022-07-16","2022-07-25","2022-07-26","2022-07-27","2022-07-28","2022-08-03","2022-08-06","2022-08-15","2022-08-16","2022-08-19","2022-08-25","2022-09-11","2022-09-14","2022-10-01","2022-10-14","2022-10-21","2022-10-25","2022-10-26","2022-11-01"],"name":"calories","type":"scatter","mode":"lines","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":" <b>My movement in 2022<\/b>","xaxis":{"domain":[0,1],"automargin":true,"title":"<b>Days<\/b>","type":"category","categoryorder":"array","categoryarray":["2021-05-17","2021-05-19","2021-05-22","2021-05-23","2021-05-31","2021-06-10","2021-06-11","2021-06-13","2021-06-18","2021-06-20","2021-06-27","2021-07-04","2021-07-08","2021-07-09","2021-07-10","2021-07-11","2021-07-12","2021-07-27","2021-07-31","2021-08-04","2021-08-09","2021-08-11","2021-08-12","2021-08-13","2021-08-14","2021-08-15","2021-08-18","2021-08-19","2021-08-20","2021-08-23","2021-08-25","2021-08-26","2021-08-27","2021-08-28","2021-08-30","2021-09-01","2021-09-02","2021-09-03","2021-09-05","2021-09-06","2021-09-07","2021-09-08","2021-09-09","2021-09-12","2021-09-13","2021-09-14","2021-09-16","2021-09-17","2021-09-18","2021-09-21","2021-09-22","2021-09-24","2021-09-26","2021-09-29","2021-09-30","2021-10-02","2021-10-05","2021-10-06","2021-10-08","2021-10-11","2021-10-12","2021-10-16","2021-10-18","2021-10-19","2021-10-28","2021-11-04","2021-11-18","2021-11-19","2021-12-03","2021-12-06","2021-12-13","2022-01-07","2022-01-10","2022-02-05","2022-02-25","2022-02-28","2022-03-04","2022-03-07","2022-03-08","2022-03-09","2022-03-13","2022-03-19","2022-04-19","2022-04-23","2022-04-27","2022-05-01","2022-05-02","2022-05-29","2022-06-05","2022-06-09","2022-06-13","2022-06-14","2022-06-20","2022-06-21","2022-06-23","2022-07-01","2022-07-05","2022-07-09","2022-07-10","2022-07-16","2022-07-25","2022-07-26","2022-07-27","2022-07-28","2022-08-03","2022-08-06","2022-08-15","2022-08-16","2022-08-19","2022-08-25","2022-09-11","2022-09-14","2022-10-01","2022-10-14","2022-10-21","2022-10-25","2022-10-26","2022-11-01"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"<b> steps(n)<\/b> / <b> distance(m)<\/b> / <b> calories(kcal) <\/b> "},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"y":[6161,14000,3724,5939,1851,5839,1910,3557,8339,3303,3538,7909,12416,3984,10415,9901,8232,5217,8078,11405,6746,8791,16264,13129,7985,10774,12680,12357,12834,12315,6691,11218,7257,16395,11486,12290,12526,10955,10262,8425,10873,11782,6497,11060,10380,14294,9672,10604,12680,9556,9029,5594,6653,3337,3584,5226,11807,2332,3186,1635,14466,2150,6672,2607,2985,3368,3616,10011,4791,3199,3483,2070,3083,4205,3860,3206,6801,5183,2626,7272,1279,5847,3412,8175,5671,6731,3465,4833,6490,2945,2834,5298,3971,3635,3597,3598,9176,9820,5216,2787,9395,7356,6294,2761,4263,10897,3394,7179,9390,7314,8289,3730,7027,8814,7501,6070,5393,6100],"x":["2021-05-17","2021-05-19","2021-05-22","2021-05-23","2021-05-31","2021-06-10","2021-06-11","2021-06-13","2021-06-18","2021-06-20","2021-06-27","2021-07-04","2021-07-08","2021-07-09","2021-07-10","2021-07-11","2021-07-12","2021-07-27","2021-07-31","2021-08-04","2021-08-09","2021-08-11","2021-08-12","2021-08-13","2021-08-14","2021-08-15","2021-08-18","2021-08-19","2021-08-20","2021-08-23","2021-08-25","2021-08-26","2021-08-27","2021-08-28","2021-08-30","2021-09-01","2021-09-02","2021-09-03","2021-09-05","2021-09-06","2021-09-07","2021-09-08","2021-09-09","2021-09-12","2021-09-13","2021-09-14","2021-09-16","2021-09-17","2021-09-18","2021-09-21","2021-09-22","2021-09-24","2021-09-26","2021-09-29","2021-09-30","2021-10-02","2021-10-05","2021-10-06","2021-10-08","2021-10-11","2021-10-12","2021-10-16","2021-10-18","2021-10-19","2021-10-28","2021-11-04","2021-11-18","2021-11-19","2021-12-03","2021-12-06","2021-12-13","2022-01-07","2022-01-10","2022-02-05","2022-02-25","2022-02-28","2022-03-04","2022-03-07","2022-03-08","2022-03-09","2022-03-13","2022-03-19","2022-04-19","2022-04-23","2022-04-27","2022-05-01","2022-05-02","2022-05-29","2022-06-05","2022-06-09","2022-06-13","2022-06-14","2022-06-20","2022-06-21","2022-06-23","2022-07-01","2022-07-05","2022-07-09","2022-07-10","2022-07-16","2022-07-25","2022-07-26","2022-07-27","2022-07-28","2022-08-03","2022-08-06","2022-08-15","2022-08-16","2022-08-19","2022-08-25","2022-09-11","2022-09-14","2022-10-01","2022-10-14","2022-10-21","2022-10-25","2022-10-26","2022-11-01"],"name":"Steps ","type":"scatter","mode":"lines","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"y":[3978.95,9714.47,2806.12,4310.05,994.99,3758.57,845.97,2216.71,5379.95,2038.22,2160.35,5333.26,8330.72,2308.1,6568.62,6247.73,5484.57,3229.55,5412.06,7540.2,4607.82,6063.13,11212.15,9292.42,5698.96,7831.29,9466.05,8678.01,8904.74,8222.8,4020.49,8255.96,5551.35,11203.33,8325.93,8876.98,8918,8062.81,7408.37,6304.04,8030.82,8248.59,4782.24,7741.82,7622.35,9264.98,6964.87,7493.81,8506.53,6549.23,6622.39,3540.49,4858.77,2157.86,2248.82,3599.88,8756,1454.79,1870.3,886.45,10437,1262.71,4943.18,1539.89,1625.1,1891.53,2121.47,6468.59,2748.08,1995.96,2010.46,1183.99,1714.16,2452.77,2256.18,1905.57,4029.66,3364.32,1580.25,4611.37,589.78,3346.99,2108.86,5786.77,3687.62,4347.44,1994.89,2790.49,3762.68,1563.13,1699.24,3144.05,2348.81,2132.23,2118.4,2186.05,5808.04,6196.31,3084,1688.39,6615.7,4786.44,3942.07,1649.8,2607.46,6968.82,2038.62,4547.84,6202.18,4509,5487.67,2258.84,4504.11,5815.54,4765.25,3982.46,3395.1,3995.35],"x":["2021-05-17","2021-05-19","2021-05-22","2021-05-23","2021-05-31","2021-06-10","2021-06-11","2021-06-13","2021-06-18","2021-06-20","2021-06-27","2021-07-04","2021-07-08","2021-07-09","2021-07-10","2021-07-11","2021-07-12","2021-07-27","2021-07-31","2021-08-04","2021-08-09","2021-08-11","2021-08-12","2021-08-13","2021-08-14","2021-08-15","2021-08-18","2021-08-19","2021-08-20","2021-08-23","2021-08-25","2021-08-26","2021-08-27","2021-08-28","2021-08-30","2021-09-01","2021-09-02","2021-09-03","2021-09-05","2021-09-06","2021-09-07","2021-09-08","2021-09-09","2021-09-12","2021-09-13","2021-09-14","2021-09-16","2021-09-17","2021-09-18","2021-09-21","2021-09-22","2021-09-24","2021-09-26","2021-09-29","2021-09-30","2021-10-02","2021-10-05","2021-10-06","2021-10-08","2021-10-11","2021-10-12","2021-10-16","2021-10-18","2021-10-19","2021-10-28","2021-11-04","2021-11-18","2021-11-19","2021-12-03","2021-12-06","2021-12-13","2022-01-07","2022-01-10","2022-02-05","2022-02-25","2022-02-28","2022-03-04","2022-03-07","2022-03-08","2022-03-09","2022-03-13","2022-03-19","2022-04-19","2022-04-23","2022-04-27","2022-05-01","2022-05-02","2022-05-29","2022-06-05","2022-06-09","2022-06-13","2022-06-14","2022-06-20","2022-06-21","2022-06-23","2022-07-01","2022-07-05","2022-07-09","2022-07-10","2022-07-16","2022-07-25","2022-07-26","2022-07-27","2022-07-28","2022-08-03","2022-08-06","2022-08-15","2022-08-16","2022-08-19","2022-08-25","2022-09-11","2022-09-14","2022-10-01","2022-10-14","2022-10-21","2022-10-25","2022-10-26","2022-11-01"],"name":"distance","type":"bar","marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null},{"y":[2016.47,2201.5,1912.17,2007.93,1719.06,1860.97,1690.76,1792.62,1953.07,1811.82,1816.84,1931.81,2239.03,1839.11,2226.35,2127.03,2331.44,1867.17,1969.36,2102.18,1920.23,2035.17,2328.13,2228.6,2074.02,2254.16,2461.36,2236.67,2398.01,2330.44,2301.68,2305.22,2110.49,2383.01,2192.89,2284.46,2226.82,2235.33,2119.53,2055.41,2143.03,2258.33,1978.62,2173.45,2222.13,2294.34,2209.13,2265.2,2241.25,2081.3,2148.43,1891.53,1918.62,1760.46,1765.02,1899.93,2147.14,1703.6,1745.59,1816.68,2313.61,1739.15,1977.85,1757.22,1783.25,1816.33,1772.92,2083.02,1887.43,1800.67,1776.93,1752.6,1733.74,1918.5,1799.43,1792.62,1985.07,1869.73,1780.42,2001.66,1675.91,1837.2,1853.51,2019.99,1915.56,2073.84,1816.84,1796.25,1923.23,1782.4,1796.21,1820.65,1953.77,1801.66,1761.65,1785.96,2205.97,2055.41,1888.48,1785.2,2295.13,1951.64,1910.1,1741.15,1817.64,2226.77,1871.85,1963.61,2139.68,1984.59,2132.28,1843.93,1960.65,2108.72,1992.56,1905.43,1890.71,1901.21],"x":["2021-05-17","2021-05-19","2021-05-22","2021-05-23","2021-05-31","2021-06-10","2021-06-11","2021-06-13","2021-06-18","2021-06-20","2021-06-27","2021-07-04","2021-07-08","2021-07-09","2021-07-10","2021-07-11","2021-07-12","2021-07-27","2021-07-31","2021-08-04","2021-08-09","2021-08-11","2021-08-12","2021-08-13","2021-08-14","2021-08-15","2021-08-18","2021-08-19","2021-08-20","2021-08-23","2021-08-25","2021-08-26","2021-08-27","2021-08-28","2021-08-30","2021-09-01","2021-09-02","2021-09-03","2021-09-05","2021-09-06","2021-09-07","2021-09-08","2021-09-09","2021-09-12","2021-09-13","2021-09-14","2021-09-16","2021-09-17","2021-09-18","2021-09-21","2021-09-22","2021-09-24","2021-09-26","2021-09-29","2021-09-30","2021-10-02","2021-10-05","2021-10-06","2021-10-08","2021-10-11","2021-10-12","2021-10-16","2021-10-18","2021-10-19","2021-10-28","2021-11-04","2021-11-18","2021-11-19","2021-12-03","2021-12-06","2021-12-13","2022-01-07","2022-01-10","2022-02-05","2022-02-25","2022-02-28","2022-03-04","2022-03-07","2022-03-08","2022-03-09","2022-03-13","2022-03-19","2022-04-19","2022-04-23","2022-04-27","2022-05-01","2022-05-02","2022-05-29","2022-06-05","2022-06-09","2022-06-13","2022-06-14","2022-06-20","2022-06-21","2022-06-23","2022-07-01","2022-07-05","2022-07-09","2022-07-10","2022-07-16","2022-07-25","2022-07-26","2022-07-27","2022-07-28","2022-08-03","2022-08-06","2022-08-15","2022-08-16","2022-08-19","2022-08-25","2022-09-11","2022-09-14","2022-10-01","2022-10-14","2022-10-21","2022-10-25","2022-10-26","2022-11-01"],"name":"calories","type":"scatter","mode":"lines","marker":{"color":"rgba(44,160,44,1)","line":{"color":"rgba(44,160,44,1)"}},"error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"line":{"color":"rgba(44,160,44,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>The reason why there are not many diversity in the calories that I burnt might be because of two reasons: either the calories are not counted correctly by Google, which I believe is the case, or as the charts contain information for only the days that I run, I spent similar amounts of calories. Either way, we can see that the calories don’t change much even though took much more steps and spent more time moving on some days than some other days.</p>
</section><section id="conclusion" class="level2"><h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<p>The plotly package have many useful embedded features. Especially the hovering property of the charts make it much more appealing easily. Another beautiful feature of <code>plotly</code> is that you can use certain HTML tags on your charts. For example here in the last chart, we used <code>&lt;b&gt; bolt &lt;/b&gt;</code>tag in order for making our titles stand out in the <code>layout</code> function.</p>
<p>Finally I must also mention that plotly have some features to create different types of graphs, animations and many other. <a href="https://plotly.com/r/">Their website for R</a> worths a visit.</p>


</section> ]]></description>
  <category>psych</category>
  <category>dplyr</category>
  <category>plotly</category>
  <guid>https://emrekaragul.com/posts/Visualisation of My Personal Google Data (2)/</guid>
  <pubDate>Sat, 10 Dec 2022 21:00:00 GMT</pubDate>
  <media:content url="https://emrekaragul.com/posts/Visualisation of My Personal Google Data (2)/image.png" medium="image" type="image/png" height="144" width="144"/>
</item>
<item>
  <title>Visualisation of My Personal Google Data (1): My Locations</title>
  <dc:creator>Ali Emre Karagül</dc:creator>
  <link>https://emrekaragul.com/posts/Visualisation of My Personal Google Data (1)/</link>
  <description><![CDATA[ <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mailchimp Subscription Modal</title>
<link href="//cdn-images.mailchimp.com/embedcode/classic-071822.css" rel="stylesheet" type="text/css">
<style>
        /* Modal Background */
        .modal {
            display: none; /* Hidden by default */
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5); /* Dimmed background */
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        #openModalBtn {
            background-color: tomato; /* background */
            color: white; /* White text */
            border: none; /* Remove border */
            padding: 10px 20px; /* Add padding */
            font-size: 24px; /* Adjust font size */
            border-radius: 5px; /* Rounded corners */
            cursor: pointer; /* Pointer cursor on hover */
            transition: background-color 0.3s ease; /* Smooth hover effect */
            width: 100%;
            margin-bottom: 20px; /* Add space after the button */
        }

        #openModalBtn:hover {
            background-color: rgb(255, 58, 23); /* Darker on hover */
        }
        /* Modal Content */
        .modal-content {
            background-color: #fff;
            padding: 20px;
            border-radius: 8px;
            max-width: 600px;
            width: 90%;
            text-align: center;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            overflow: auto;
        }

        /* Close Button */
        .close-btn {
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 20px;
            font-weight: bold;
            color: #aaa;
            cursor: pointer;
        }

        .close-btn:hover {
            color: #000;
        }
    </style>
<!-- Trigger Button --><button id="openModalBtn">Wanna subscribe?</button>


    <!-- Modal Structure -->
    <div id="subscriptionModal" class="modal">
        <div class="modal-content">
            <span class="close-btn">×</span>
            <!-- Mailchimp Signup Form -->
            <div>
                <div id="mc_embed_signup">
                    <form action="https://emrekaragul.us21.list-manage.com/subscribe/post?u=e72720e0214b2266cab41097e&amp;id=5cddb1a68e&amp;f_id=0038dfe1f0" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate="">
                        <div id="mc_embed_signup_scroll">
                            <h2 class="anchored">Submit your e-mail to subscribe!</h2>
                            <div class="mc-field-group">
                                <label for="mce-EMAIL">Email Address <span class="asterisk">*</span></label>
                                <input type="email" value="" name="EMAIL" class="required email" id="mce-EMAIL" required=""><span id="mce-EMAIL-HELPERTEXT" class="helper_text"></span>
                            </div>
                            <div id="mce-responses" class="clear foot">
                                <div class="response" id="mce-error-response" style="display:none"></div>
                                <div class="response" id="mce-success-response" style="display:none"></div>
                            </div>
                            
                            <div class="optionalParent">
                                <div class="clear foot">
                                    <input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button">
</div>
                            </div>
                        </div>
                    </form>
                </div>
                <script type="text/javascript" src="//s3.amazonaws.com/downloads.mailchimp.com/js/mc-validate.js"></script><script type="text/javascript">
                    (function($) {
                        window.fnames = new Array();
                        window.ftypes = new Array();
                        fnames[0] = 'EMAIL';
                        ftypes[0] = 'email';
                    }(jQuery));
                    var $mcj = jQuery.noConflict(true);
                </script><!--End mc_embed_signup-->
</div>
        </div>
    </div>

    <script>
        // Get the modal, button, and close elements
        const modal = document.getElementById("subscriptionModal");
        const openModalBtn = document.getElementById("openModalBtn");
        const closeBtn = document.querySelector(".close-btn");

        // Open the modal when the button is clicked
        openModalBtn.addEventListener("click", () => {
            modal.style.display = "flex"; // Show the modal
        });

        // Close the modal when the close button is clicked
        closeBtn.addEventListener("click", () => {
            modal.style.display = "none"; // Hide the modal
        });

        // Close the modal when clicking outside of it
        window.addEventListener("click", (e) => {
            if (e.target === modal) {
                modal.style.display = "none";
            }
        });
    </script><section id="introduction-to-the-series-visualisation-of-my-personal-google-data" class="level2"><h2 class="anchored" data-anchor-id="introduction-to-the-series-visualisation-of-my-personal-google-data">Introduction to the series: “Visualisation of My Personal Google Data”</h2>
<p>If you give permission to Google to store your location data, they will keep them in their databases forever. You can also allow them to store it for a while and then ask them delete it. They will directly do so.</p>
<p>What makes this study a fun project is its being very personal. I decided to analyze my personal data in August, 2022. Therefore, I granted many new permissions to Google along with many previously granted permissions. They keep them in various formats including .csv, .json, .mbox etc. When you query for your personal data, they provide it within a couple of days depending on the size of the data you queried.</p>
<p>Usually, I provide the readers with the data in my posts. However, in this series, the data are very personal and so I will not.</p>
</section><section id="introduction-my-locations" class="level2"><h2 class="anchored" data-anchor-id="introduction-my-locations">Introduction: “My Locations”</h2>
<p>In this part of the series, we will investigate my personal location data. We will visualize the spots I visited within a period of time. This way, I personally will gain insights about how boring my days are :)</p>
<p>The R packages that we use in this post are as follows: <code>rjson</code>, <code>tidyr</code>, <code>dplyr</code>, <code>purrr</code>, <code>lubridate</code>, <code>sp</code> and <code>leaflet</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">##packs for data processing</span></span>
<span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;"><a href="https://github.com/alexcb/rjson">rjson</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># to read .JSON files.</span></span>
<span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;"><a href="https://tidyr.tidyverse.org">tidyr</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># to process data</span></span>
<span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># to process data</span></span>
<span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;"><a href="https://purrr.tidyverse.org/">purrr</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># to process data</span></span>
<span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;"><a href="https://lubridate.tidyverse.org">lubridate</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># to deal with date variables</span></span>
<span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#packs for data viz</span></span>
<span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;"><a href="https://github.com/edzer/sp/">sp</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>         <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># a pack for spatial objects</span></span>
<span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;"><a href="https://rstudio.github.io/leaflet/">leaflet</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># map and its functions</span></span></code></pre></div>
</div>
</section><section id="understand-the-data" class="level2"><h2 class="anchored" data-anchor-id="understand-the-data">Understand the Data</h2>
<p>Inside the takeout folder that I received from Google, there is a folder named “Location History”. Inside it, “Semantic Location History” contains the location data based on the months and years. From that folder, I have called the locations I visited in November. Thus, we will use 2022_NOVEMBER.json file. Let’s investigate the data. Start with reading the file into R environment.</p>
<div class="cell" data-code_folding="false">
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">my_locations</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/rjson/man/fromJSON.html">fromJSON</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>file <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2022_NOVEMBER.json"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
</div>
<p>Then, let’s try to understand the structure of the data, how and what kind of information is stored into its cells. The list object <code>my_locations</code> contains many lists inside it. Let’s try to understand each one of them one by one:</p>
<div class="cell" data-code_folding="false">
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">my_locations</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[[</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      Length Class  Mode
 [1,] 1      -none- list
 [2,] 1      -none- list
 [3,] 1      -none- list
 [4,] 1      -none- list
 [5,] 1      -none- list
 [6,] 1      -none- list
 [7,] 1      -none- list
 [8,] 1      -none- list
 [9,] 1      -none- list
[10,] 1      -none- list
[11,] 1      -none- list
[12,] 1      -none- list
[13,] 1      -none- list
[14,] 1      -none- list
[15,] 1      -none- list
[16,] 1      -none- list
[17,] 1      -none- list</code></pre>
</div>
</div>
<p>There are many smaller lists in the first indexed list. Let’s try the first one and see what’s inside:</p>
<div class="cell" data-code_folding="false">
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">my_locations</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[[</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[[</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           Length Class  Mode
placeVisit 11     -none- list</code></pre>
</div>
</div>
<p>There is a single list inside. Sad :( Let’s dive one more step:</p>
<div class="cell" data-code_folding="false">
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">my_locations</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[[</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[[</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[[</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                        Length Class  Mode     
location                8      -none- list     
duration                2      -none- list     
placeConfidence         1      -none- character
centerLatE7             1      -none- numeric  
centerLngE7             1      -none- numeric  
visitConfidence         1      -none- numeric  
otherCandidateLocations 4      -none- list     
editConfirmationStatus  1      -none- character
locationConfidence      1      -none- numeric  
placeVisitType          1      -none- character
placeVisitImportance    1      -none- character</code></pre>
</div>
</div>
<p>Finally, here we have several items. There is a list called <code>location</code> containing 8 items inside. There is <code>duration</code> with 2 items and <code>otherCandidateLocations</code> with 4 items. Other lists contain only one item each. Let’s check these one by one:</p>
<div class="cell" data-code_folding="false">
<div class="sourceCode" id="cb9" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">my_locations</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[[</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[[</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[[</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">location</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                      Length Class  Mode     
latitudeE7            1      -none- numeric  
longitudeE7           1      -none- numeric  
placeId               1      -none- character
address               1      -none- character
semanticType          1      -none- character
sourceInfo            1      -none- list     
locationConfidence    1      -none- numeric  
calibratedProbability 1      -none- numeric  </code></pre>
</div>
</div>
<div class="cell" data-code_folding="false">
<div class="sourceCode" id="cb11" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">my_locations</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[[</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[[</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[[</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">duration</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               Length Class  Mode     
startTimestamp 1      -none- character
endTimestamp   1      -none- character</code></pre>
</div>
</div>
<div class="cell" data-code_folding="false">
<div class="sourceCode" id="cb13" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">my_locations</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[[</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[[</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[[</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">otherCandidateLocations</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     Length Class  Mode
[1,] 7      -none- list
[2,] 7      -none- list
[3,] 7      -none- list
[4,] 7      -none- list</code></pre>
</div>
</div>
<p>We can obtain much information through this investigation process. For instance, inside the <code>location</code> I can see information about the latitude, longitude, address, the confidence that I have to this place, and some other. Here, if you are following along with me, please spare some time to understand your data. Delve into them and digest as much information as you can. I will see you in the next section: data processing.</p>
</section><section id="pre-processing" class="level2"><h2 class="anchored" data-anchor-id="pre-processing">Pre-processing</h2>
<p>You can use as many items as you want in your work. You should decide the meaningful information while understanding your data. Now let’s re-define our lists as a dataframe.</p>
<div class="cell" data-code_folding="false">
<div class="sourceCode" id="cb15" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">df</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://purrr.tidyverse.org/reference/map_dfr.html">map_dfr</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">my_locations</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"timelineObjects"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">as.data.frame</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/utils/View.html">View</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">df</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># there is one empty row after each entry. Let's drop them through one of the complete columns:</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">df</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://tidyr.tidyverse.org/reference/drop_na.html">drop_na</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">df</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">placeVisit.location.latitudeE7</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
</div>
<p>There are many columns, some of which I won’t need. Especially, I am not interested in the locations defined as “candidate”. I will exclude them from my study. They are probably the locations that might be the place that I visited ordered by possibility. I just need the one with the highest possibility, which is tagged with <code>placeVisit.location.</code> . These locations are also defined as “HIGH CONFIDENCE”. Let’s continue the analysis with these locations, only.</p>
<p>Also, there are some columns with no entry. Let me exclude them with a function. Let the function be called <code>not_all_na</code>. This is a function that drops all the columns which are completely empty:</p>
<div class="cell" data-code_folding="false">
<div class="sourceCode" id="cb16" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">not_all_na</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">x</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/any.html">any</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">x</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#use the function on the dataframe:</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">df</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">df</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://tidyselect.r-lib.org/reference/where.html">where</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">not_all_na</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
</div>
<p>Now, I have a dataframe with 150+ columns. However, I just need the information about latitude, altitude, date and address of the locations that I visited. Let’s write a query to get this data into a new dataframe:</p>
<div class="cell" data-code_folding="false">
<div class="sourceCode" id="cb17" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">lat</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">df</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">contains</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"placeVisit.location.latitudeE7"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">lon</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">df</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">contains</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"placeVisit.location.longitudeE7"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">address</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">df</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">contains</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"placeVisit.location.address"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">date</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">df</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">contains</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"placeVisit.duration.startTimestamp"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
</div>
<p>The chunks of code above ask for columns whose names contain the extensions written in quotation marks in them. Still, this raw information isn’t enough for several reasons. Firstly, <code>lat</code> and <code>lot</code> are coordinates in E7 format. With a quick research on the internet, I learned that they simply need to be divided by 10000000. Also, <code>date</code> contains day, month, year, hour, minute, second and time zone (which is in GMT+0 format) information all in the same column. They need to be handled. Let’s start with the second issue (the one about <code>date</code>):</p>
<div class="cell" data-code_folding="false">
<div class="sourceCode" id="cb18" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#re-name the only column:</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">date</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Date"</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">date</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                      Date
1 2022-11-06T13:12:38.091Z
2 2022-11-06T13:24:32.338Z
3 2022-11-06T13:59:00.539Z
4 2022-11-06T14:17:15.462Z
5 2022-11-06T14:39:29.138Z
6 2022-11-07T05:32:14.277Z</code></pre>
</div>
</div>
<p>As can be seen above, there are two separators: One is “T” separating day and time info. The other is “.” separating time and time zone info. Follow the notes in the code to grasp the process:</p>
<div class="cell" data-code_folding="false">
<div class="sourceCode" id="cb20" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#divide the day and hour info from the time zone info, then drop the time zone:</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">date</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span></span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://tidyr.tidyverse.org/reference/separate.html">separate</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span></span>
<span>    data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">date</span>,</span>
<span>    col <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Date</span>,</span>
<span>    into <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Date"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"zone"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>,</span>
<span>    sep <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"\\."</span></span>
<span>  <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">date</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">date</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span></span>
<span></span>
<span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#Now, transform the time in local time zone which is GMT+3:</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">date</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Date</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/as.POSIXlt.html">as.POSIXct</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">date</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Date</span>, format<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"%Y-%m-%dT%H:%M:%S"</span>, tz<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/timezones.html">Sys.timezone</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://lubridate.tidyverse.org/reference/period.html">hours</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span></span>
<span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#divide the day and hour info:</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">date</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span></span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://tidyr.tidyverse.org/reference/separate.html">separate</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span></span>
<span>    data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">date</span>,</span>
<span>    col <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Date</span>,</span>
<span>    into <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Day"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Hour"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>,</span>
<span>    sep <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" "</span></span>
<span>  <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#see the new format:</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">date</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         Day     Hour
1 2022-11-06 16:12:38
2 2022-11-06 16:24:32
3 2022-11-06 16:59:00
4 2022-11-06 17:17:15
5 2022-11-06 17:39:29
6 2022-11-07 08:32:14</code></pre>
</div>
</div>
<p>Nicely done! Now gather all the information that we need into a dataframe. Again follow along the notes in the code:</p>
<div class="cell" data-code_folding="false">
<div class="sourceCode" id="cb22" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">coords</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span></span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://tidyr.tidyverse.org/reference/drop_na.html">drop_na</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span></span>
<span>    lat <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">lat</span>, use.names <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">10000000</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#divide lat and lon by 10000000 to get rid of the E7 format</span></span>
<span>    lon <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">lon</span>, use.names <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">10000000</span>, </span>
<span>    address <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">address</span>, use.names <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>,</span>
<span>    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">date</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># we processed this before</span></span>
<span>  <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
</div>
<p>So far, we have worked to prepare for the data visualization process. Our data is ready with the name <code>coords</code>. Let’s continue with the visualization.</p>
</section><section id="data-visualization" class="level2"><h2 class="anchored" data-anchor-id="data-visualization">Data Visualization</h2>
<p>At this point, we will visualize the locations I visited in November of 2022 on a world map. You can’t be as disappointed as me when you see that I live a life between home and work. Yet, the point here is to see the process of visualization. We owe this beautiful project to the <a href="https://rstudio.github.io/leaflet/">R package leaflet</a>. It is actually <a href="https://leafletjs.com/index.html">a javascript library</a>, all its arguments are deployed into R environment too. Therefore, we can work with it. If you are still with me, I mhighly recommend you to read the documentation of the package <code>leaflet</code>. Then, follow along the notes in the code and try to understand it if you are not familiar with it.</p>
<div class="cell" data-code_folding="false">
<div class="sourceCode" id="cb23" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://edzer.github.io/sp/reference/coordinates.html">coordinates</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">coords</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">lon</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">lat</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rstudio.github.io/leaflet/reference/leaflet.html">leaflet</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">coords</span>,</span>
<span></span>
<span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># formating the outer of the map:</span></span>
<span>        width <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"800px"</span>,</span>
<span>        height <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"400px"</span>, </span>
<span>        padding <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rstudio.github.io/leaflet/reference/map-layers.html">addTiles</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span></span>
<span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#formating the markers on the map:</span></span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rstudio.github.io/leaflet/reference/map-layers.html">addCircleMarkers</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span></span>
<span>    color <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tomato"</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#my favorite colour</span></span>
<span>    fillOpacity <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span>    radius <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>,</span>
<span>    stroke <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,</span>
<span>    </span>
<span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#address pops up when you click on a marker:</span></span>
<span>    popup <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">coords</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">address</span>,</span>
<span></span>
<span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#the date and hour shows up with a fancy personal note when you hover on a marker:</span></span>
<span>    label <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"I have been around here on "</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">coords</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Day</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" at around "</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">coords</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Hour</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>,</span>
<span></span>
<span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#formating the label that shows up when you hover:</span></span>
<span>    labelOptions <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rstudio.github.io/leaflet/reference/map-options.html">labelOptions</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span></span>
<span>      noHide <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">F</span>,</span>
<span>      direction <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"top"</span>,</span>
<span>      style <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span></span>
<span>        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"color"</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>,</span>
<span>        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"font-family"</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"calibri"</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#I love calibri</span></span>
<span>        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"box-shadow"</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"3px 3px rgba(0,0,0,0.25)"</span>,</span>
<span>        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"font-size"</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"12px"</span>,</span>
<span>        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"border-color"</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"rgba(0,0,0,0.5)"</span></span>
<span>      <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span>    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span>  <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output-display">
<div id="htmlwidget-e89f608a73d1db18a340" style="width:800px;height:400px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-e89f608a73d1db18a340">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"https://openstreetmap.org\">OpenStreetMap<\/a> contributors, <a href=\"https://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA<\/a>"}]},{"method":"addCircleMarkers","args":[[39.9107968,39.9077105,39.9107968,39.9020001,39.9107968,39.9211819,39.9033022,39.9107968],[32.865052,32.8704428,32.865052,32.8601762,32.865052,32.7983108,32.860418,32.865052],7,null,null,{"interactive":true,"className":"","stroke":false,"color":"tomato","weight":5,"opacity":0.5,"fill":true,"fillColor":"tomato","fillOpacity":1},null,null,["Esatoğlu, Başak Sk. No:24, 06660 Çankaya/Ankara, Türkiye","Muhsin Ertuğrul, Belligün Cd. No:18, 06660 Çankaya/Ankara, Türkiye","Esatoğlu, Başak Sk. No:24, 06660 Çankaya/Ankara, Türkiye","Çankaya Kuğulu, Çankaya, Park, 06690 Çankaya/Ankara, Türkiye","Esatoğlu, Başak Sk. No:24, 06660 Çankaya/Ankara, Türkiye","Söğütözü, Söğütözü Cd. No:43, 06510 Çankaya/Ankara, Türkiye","Remzi Oğuz Arık, Tunalı Hilmi Cd. No:119/A, 06680 Çankaya/Ankara, Türkiye","Esatoğlu, Başak Sk. No:24, 06660 Çankaya/Ankara, Türkiye"],null,["I have been around here on 2022-11-06 at around 16:12:38","I have been around here on 2022-11-06 at around 16:24:32","I have been around here on 2022-11-06 at around 16:59:00","I have been around here on 2022-11-06 at around 17:17:15","I have been around here on 2022-11-06 at around 17:39:29","I have been around here on 2022-11-07 at around 08:32:14","I have been around here on 2022-11-07 at around 17:14:12","I have been around here on 2022-11-07 at around 17:46:44"],{"interactive":false,"permanent":false,"direction":"top","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"style":{"color":"black","font-family":"calibri","box-shadow":"3px 3px rgba(0,0,0,0.25)","font-size":"12px","border-color":"rgba(0,0,0,0.5)"},"className":"","sticky":true},null]}],"limits":{"lat":[39.9020001,39.9211819],"lng":[32.7983108,32.8704428]}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section><section id="conclusion" class="level2"><h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<p>Working with your personal data gives you the opportunity to understand your own habits, likes, dislikes, and maybe future expectations. Here, you can only see my locations in November. When I worked on longer periods, I realized that I need to travel and see new places more often. Even if they are in my own city, a new place is a new vision of life.</p>
<p>Visualizing data on spatial environments is a new challenge for me. Rather than graphs and charts, working with maps are more attractive obviously. While visualizing location data on maps, <code>leaflet</code> is an amazing, open source library. There are other options. One needs a mention here: <code>ggmap</code>. Yet, to use this package you need an API key obtained from Google. For more information about API keys, <a href="https://developers.google.com/maps/documentation/embed/get-api-key#:~:text=Go%20to%20the%20Google%20Maps%20Platform%20%3E%20Credentials%20page.&amp;text=On%20the%20Credentials%20page%2C%20click,Click%20Close.">visit here</a>. As of the package, you can visit the <a href="https://cran.r-project.org/web/packages/ggmap/readme/README.html">CRAN page of ggmap</a>. Under the title “Google Maps API key”, you will see the procedure to buy a personal API key. It reads as follows:</p>
<p>GOOGLE MAPS API KEY <span class="citation" data-cites="ggmap">[@ggmap]</span></p>
<p><em>A few years ago Google has <a href="https://developers.google.com/maps/documentation/geocoding/usage-and-billing">changed its API requirements</a>, and <strong>ggmap</strong> users are now required to register with Google. From a user’s perspective, there are essentially three ramifications of this:</em></p>
<ol type="1">
<li><p><em>Users must register with Google. You can do this at <a href="https://mapsplatform.google.com/">https://mapsplatform.google.com</a>. While it will require a valid credit card (sorry!), there seems to be a fair bit of free use before you incur charges, and even then the charges are modest for light use.</em></p></li>
<li><p><em>Users must enable the APIs they intend to use. What may appear to <strong>ggmap</strong> users as one overarching “Google Maps” product, Google in fact has several services that it provides as geo-related solutions. For example, the <a href="https://developers.google.com/maps/documentation/maps-static/overview">Maps Static API</a> provides map images, while the <a href="https://developers.google.com/maps/documentation/geocoding/overview">Geocoding API</a> provides geocoding and reverse geocoding services. Apart from the relevant Terms of Service, generally <strong>ggmap</strong> users don’t need to think about the different services. For example, you just need to remember that <code>get_googlemap()</code> gets maps, <code>geocode()</code> geocodes (with Google, DSK is done), etc., and <strong>ggmap</strong> handles the queries for you. However, you do need to enable the APIs before you use them. You’ll only need to do that once, and then they’ll be ready for you to use. Enabling the APIs just means clicking a few radio buttons on the Google Maps Platform web interface listed above, so it’s easy.</em></p></li>
<li><p><em>Inside R, after loading the new version of <strong>ggmap</strong>, you’ll need provide <strong>ggmap</strong> with your API key, a <a href="https://en.wikipedia.org/wiki/Hash_function">hash value</a> (think string of jibberish) that authenticates you to Google’s servers. This can be done on a temporary basis with <code>register_google(key = "[your key]")</code> or permanently using <code>register_google(key = "[your key]", write = TRUE)</code> (note: this will overwrite your <code>~/.Renviron</code> file by replacing/adding the relevant line). If you use the former, know that you’ll need to re-do it every time you reset R.</em></p></li>
</ol>
<p><em>Your API key is private and unique to you, so be careful not to share it online, for example in a GitHub issue or saving it in a shared R script file. If you share it inadvertantly, just get on Google’s website and regenerate your key - this will retire the old one. Keeping your key private is made a bit easier by <strong>ggmap</strong> scrubbing the key out of queries by default, so when URLs are shown in your console, they’ll look something like <code>key=xxx</code>. (Read the details section of the <code>register_google()</code> documentation for a bit more info on this point.)</em></p>
<section id="stay-tuned" class="level5"><h5 class="anchored" data-anchor-id="stay-tuned">Stay tuned!</h5>
<p>This series continues with the visualization of my Google Fit data. We will delve into my exercise habbits.</p>


</section></section> ]]></description>
  <category>rjson</category>
  <category>tidyr</category>
  <category>dplyr</category>
  <category>purrr</category>
  <category>lubridate</category>
  <category>sp</category>
  <category>leaflet</category>
  <guid>https://emrekaragul.com/posts/Visualisation of My Personal Google Data (1)/</guid>
  <pubDate>Tue, 15 Nov 2022 21:00:00 GMT</pubDate>
  <media:content url="https://emrekaragul.com/posts/Visualisation of My Personal Google Data (1)/image.png" medium="image" type="image/png" height="144" width="144"/>
</item>
<item>
  <title>Yapısal Eşitlik Modelleme</title>
  <dc:creator>Ali Emre Karagül</dc:creator>
  <link>https://emrekaragul.com/posts/Structural Equation Modelling (in Turkish)/</link>
  <description><![CDATA[ <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mailchimp Subscription Modal</title>
<link href="//cdn-images.mailchimp.com/embedcode/classic-071822.css" rel="stylesheet" type="text/css">
<style>
        /* Modal Background */
        .modal {
            display: none; /* Hidden by default */
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5); /* Dimmed background */
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        #openModalBtn {
            background-color: tomato; /* background */
            color: white; /* White text */
            border: none; /* Remove border */
            padding: 10px 20px; /* Add padding */
            font-size: 24px; /* Adjust font size */
            border-radius: 5px; /* Rounded corners */
            cursor: pointer; /* Pointer cursor on hover */
            transition: background-color 0.3s ease; /* Smooth hover effect */
            width: 100%;
            margin-bottom: 20px; /* Add space after the button */
        }

        #openModalBtn:hover {
            background-color: rgb(255, 58, 23); /* Darker on hover */
        }
        /* Modal Content */
        .modal-content {
            background-color: #fff;
            padding: 20px;
            border-radius: 8px;
            max-width: 600px;
            width: 90%;
            text-align: center;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            overflow: auto;
        }

        /* Close Button */
        .close-btn {
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 20px;
            font-weight: bold;
            color: #aaa;
            cursor: pointer;
        }

        .close-btn:hover {
            color: #000;
        }
    </style>
<!-- Trigger Button --><button id="openModalBtn">Wanna subscribe?</button>


    <!-- Modal Structure -->
    <div id="subscriptionModal" class="modal">
        <div class="modal-content">
            <span class="close-btn">×</span>
            <!-- Mailchimp Signup Form -->
            <div>
                <div id="mc_embed_signup">
                    <form action="https://emrekaragul.us21.list-manage.com/subscribe/post?u=e72720e0214b2266cab41097e&amp;id=5cddb1a68e&amp;f_id=0038dfe1f0" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate="">
                        <div id="mc_embed_signup_scroll">
                            <h2 class="anchored">Submit your e-mail to subscribe!</h2>
                            <div class="mc-field-group">
                                <label for="mce-EMAIL">Email Address <span class="asterisk">*</span></label>
                                <input type="email" value="" name="EMAIL" class="required email" id="mce-EMAIL" required=""><span id="mce-EMAIL-HELPERTEXT" class="helper_text"></span>
                            </div>
                            <div id="mce-responses" class="clear foot">
                                <div class="response" id="mce-error-response" style="display:none"></div>
                                <div class="response" id="mce-success-response" style="display:none"></div>
                            </div>
                            
                            <div class="optionalParent">
                                <div class="clear foot">
                                    <input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button">
</div>
                            </div>
                        </div>
                    </form>
                </div>
                <script type="text/javascript" src="//s3.amazonaws.com/downloads.mailchimp.com/js/mc-validate.js"></script><script type="text/javascript">
                    (function($) {
                        window.fnames = new Array();
                        window.ftypes = new Array();
                        fnames[0] = 'EMAIL';
                        ftypes[0] = 'email';
                    }(jQuery));
                    var $mcj = jQuery.noConflict(true);
                </script><!--End mc_embed_signup-->
</div>
        </div>
    </div>

    <script>
        // Get the modal, button, and close elements
        const modal = document.getElementById("subscriptionModal");
        const openModalBtn = document.getElementById("openModalBtn");
        const closeBtn = document.querySelector(".close-btn");

        // Open the modal when the button is clicked
        openModalBtn.addEventListener("click", () => {
            modal.style.display = "flex"; // Show the modal
        });

        // Close the modal when the close button is clicked
        closeBtn.addEventListener("click", () => {
            modal.style.display = "none"; // Hide the modal
        });

        // Close the modal when clicking outside of it
        window.addEventListener("click", (e) => {
            if (e.target === modal) {
                modal.style.display = "none";
            }
        });
    </script><p>Bu çalışmada PISA 2015 <a href="https://www.oecd.org/pisa/data/CY6_QST_MS_STQ_PBA_Final.pdf">“student questionnaire: paper based verison”</a> içerisindeki en son alt ölçek olan ‘Your View on Science’ ölçeğinden elde edilen veriler kullanılmıştır. Türkiye örnekleminden faydalanılmıştır. Bu örneklem ile bahsi geçen ölçeğin yapısal eşitlik modelleri oluşturulmuş ve karşılaştırılmıştır. Adım adım veri setinin R ile analize hazır hale getirilmesi anlatılmaktadır. Doğrudan analiz ile ilgileniyorsanız aşağıda <strong>‘Analiz Süreci’</strong> başlığına ilerleyiniz.</p>
<section id="veri-ön-hazırlık-süreci" class="level2"><h2 class="anchored" data-anchor-id="veri-ön-hazırlık-süreci">Veri Ön Hazırlık Süreci</h2>
<p>Öncelikle <a href="https://www.oecd.org/pisa/data/2015database/">OECD</a> tarafından yayınlanan veri setini <a href="https://webfs.oecd.org/pisa/PUF_SPSS_COMBINED_CMB_STU_QQQ.zip">şuradan</a> indiriyoruz. İndirilen bu dosya .sav uzantılı bbir dosya. Bu tür dosyaları açmak için <code>haven</code> paketi <code>read_sav</code> fonksiyonundan faydalanabiliriz. Veri setinin tamamına ihtiyacımız yok, zaten oldukça büyük bir veri. Ülke değilşkeni ve ilgili ölçeğin maddeleri yeterli olacaktır. İndirdiğimiz .sav uzantılı dosyayı <em>working directory’</em>mize taşıdıktan sonra çalıştıracağımız kod satırı şunlar:</p>
<div class="cell">
<details class="code-fold"><summary>Kod</summary><div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;"><a href="https://haven.tidyverse.org">haven</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> </span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://haven.tidyverse.org/reference/read_spss.html">read_sav</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span></span>
<span>  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CY6_MS_CMB_STU_QQQ.sav"</span>,</span>
<span>  col_select <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span></span>
<span>    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CNT"</span>,</span>
<span>    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ST092Q01TA"</span>,</span>
<span>    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ST092Q02TA"</span>,</span>
<span>    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ST092Q04TA"</span>,</span>
<span>    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ST092Q05TA"</span>,</span>
<span>    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ST092Q06NA"</span>,</span>
<span>    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ST092Q08NA"</span>,</span>
<span>    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ST092Q09NA"</span>,</span>
<span>    </span>
<span>    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ST094Q01NA"</span>,</span>
<span>    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ST094Q02NA"</span>,</span>
<span>    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ST094Q03NA"</span>,</span>
<span>    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ST094Q04NA"</span>,</span>
<span>    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ST094Q05NA"</span>,</span>
<span>    </span>
<span>    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ST113Q01TA"</span>,</span>
<span>    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ST113Q02TA"</span>,</span>
<span>    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ST113Q03TA"</span>,</span>
<span>    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ST113Q04TA"</span>,</span>
<span>    </span>
<span>    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ST129Q01TA"</span>,</span>
<span>    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ST129Q02TA"</span>,</span>
<span>    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ST129Q03TA"</span>,</span>
<span>    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ST129Q04TA"</span>,</span>
<span>    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ST129Q05TA"</span>,</span>
<span>    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ST129Q06TA"</span>,</span>
<span>    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ST129Q07TA"</span>,</span>
<span>    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ST129Q08TA"</span>,</span>
<span>    </span>
<span>    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ST131Q01NA"</span>,</span>
<span>    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ST131Q03NA"</span>,</span>
<span>    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ST131Q04NA"</span>,</span>
<span>    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ST131Q06NA"</span>,</span>
<span>    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ST131Q08NA"</span>,</span>
<span>    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ST131Q11NA"</span></span>
<span>  <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
</details>
</div>
<p>Ülke değişkenine artık ihtiyacımız yok. O nedenle veri setimizi sadece ölçek maddelerini içerecek şekilde yeniden tanımlayalım:</p>
<div class="cell">
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">science_data</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">CNT</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"TUR"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span></span></code></pre></div>
</div>
<p>Bu veri setini şu kod satırını yürüterek .csv uzantılı bir dosya olarak bilgisayarıma kaydediyorum. Böylece analiz aşamasında o halini de paylaşabileceğim:</p>
<div class="cell" data-code_folding="true">
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/utils/write.table.html">write.csv</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">science_data</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"science_data.csv"</span>, row.names <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
</div>
</section><section id="analiz-süreci" class="level2"><h2 class="anchored" data-anchor-id="analiz-süreci">Analiz Süreci</h2>
<p>İlgili ölçekten elde edilen veriyi <a href="https://drive.google.com/file/d/1HVNyhK1J6PmwS04_W4B7LCVXEDakFShg/view?usp=sharing">.csv uzantılı dosya</a> olarak indirebilirsiniz. Bunu read.csv fonksiyonu ile R ortamına aktarabilirsiniz. Veri setimiz hazır. Analizimizde öncelikle doğrulayı faktör analizi kullanacağız. Daha sonra da bi-faktör modelleme yapacağız. Veri setimizi tekrar yükleyelim: <code>science_data&lt;-read.csv("science_data.csv",   header = TRUE, sep = ",")</code></p>
<section id="doğrulayıcı-faktör-analizi-dfa" class="level3"><h3 class="anchored" data-anchor-id="doğrulayıcı-faktör-analizi-dfa">Doğrulayıcı Faktör Analizi (DFA)</h3>
<p>Çalışmamıza konu olan ölçek beş faktörden oluşmaktadır. Bu yapı ile ölçek geliştirme sürecinde tanımlanmıştır. Her faktörde farklı sayılarda maddeler yer almaktadır. Veri setinde bunlar ST ön eki ve faktör numarası ile tanımlanmıştır. Faktörleri ve veri setindeki kodlamalarını şu şekilde listeleyelim:</p>
<ol type="1">
<li><p>ST092: How informed are you about the following environmental issues?</p></li>
<li><p>ST094: How much do you disagree or agree with the statements about yourself below?</p></li>
<li><p>ST113: How much do you agree with the statements below?</p></li>
<li><p>ST129: How easy do you think it would be for you to perform the following tasks on your own?</p></li>
<li><p>ST131: How much do you disagree or agree with the statements below?</p></li>
</ol>
<p>Bu beş faktörün altında tanımlanan yapıya göre DFA uygulayacağız ve bir geçerlilik çalışması yürüteceğiz. Bunun için öncelikle modelimizi R’a tanıtalım:</p>
<div class="cell" data-code_folding="true">
<details class="code-fold"><summary>Kod</summary><div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Science.model</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ST092 =~ 1* ST092Q01TA+</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              ST092Q02TA+</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              ST092Q04TA+</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              ST092Q05TA+</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              ST092Q06NA+</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              ST092Q08NA+</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              ST092Q09NA</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              </span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                  ST094 =~ 1* ST094Q01NA+</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              ST094Q02NA+</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              ST094Q03NA+</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              ST094Q04NA+</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              ST094Q05NA</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              </span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                  ST113 =~ 1* ST113Q01TA+</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              ST113Q02TA+</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              ST113Q03TA+</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              ST113Q04TA</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                  </span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                  ST129 =~ 1* ST129Q01TA+</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              ST129Q02TA+</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              ST129Q03TA+</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              ST129Q04TA+</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              ST129Q05TA+</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              ST129Q06TA+</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              ST129Q07TA+</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              ST129Q08TA</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              </span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                  ST131 =~ 1* ST131Q01NA+</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              ST131Q03NA+</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              ST131Q04NA+</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              ST131Q06NA+</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              ST131Q08NA+</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              ST131Q11NA            </span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                    </span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                           </span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                            ST092 ~~ ST094</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                            ST092 ~~ ST113</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                            ST092 ~~ ST129</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                            ST092 ~~ ST131</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                            </span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                            ST094 ~~ ST113</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                            ST094 ~~ ST129</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                            ST094 ~~ ST131</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                            </span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                            ST113 ~~ ST129</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                            ST113 ~~ ST131</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                            </span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                            ST129 ~~ ST131'</span></span></code></pre></div>
</details>
</div>
<p>Şimdi Türkiye örnekleminden elde edilen verimizin bu modele uyum sağlayıp sağlamadığına bakacağız. Bu aşamada çeşitli modelleme yaklaşımlarından çıktılar alarak bunları karşılaştıracağız. Bu modelleme yaklaşımları şunlardır:</p>
<ul>
<li><p><em>maximum likelihood model (MLM)</em></p></li>
<li><p><em>weighted least squares (WLS)</em></p></li>
<li><p><em>robust maximum likelihood model (RMLM)</em></p></li>
<li><p><em>diagonally weighted least squares (DWLS)</em></p></li>
</ul>
<p>Yukarıdaki lsitede görüldüğü sıra ile modellerimizi <code>lavaan</code> paketiyle oluşturalım:</p>
<div class="cell" data-code_folding="true">
<details class="code-fold"><summary>Kod</summary><div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;"><a href="https://lavaan.ugent.be">lavaan</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model_mlm</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/lavaan/man/cfa.html">cfa</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Science.model</span>, data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">science_data</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model_wls</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/lavaan/man/cfa.html">cfa</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Science.model</span>, WLS.V <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">science_data</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model_rml</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/lavaan/man/cfa.html">cfa</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Science.model</span>, estimator <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"MLM"</span>, se <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"robust.mlm"</span>, data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">science_data</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model_dwls</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/lavaan/man/cfa.html">cfa</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Science.model</span>, data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">science_data</span>, estimator<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"DWLS"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
</details>
</div>
<p>Her biri için de ayrı ayrı analiz çıktılarını <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code> fonksiyonu ile tanımlayalım:</p>
<div class="cell" data-code_folding="true">
<details class="code-fold"><summary>Kod</summary><div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">science.mlm</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span></span>
<span>  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model_mlm</span>,</span>
<span>  fit.measures <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,</span>
<span>  standardized <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,</span>
<span>  rsquare <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,</span>
<span>  modindices <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span></span>
<span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">science.wls</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span></span>
<span>  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model_wls</span>,</span>
<span>  fit.measures <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,</span>
<span>  standardized <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,</span>
<span>  rsquare <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,</span>
<span>  modindices <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span></span>
<span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">science.rml</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span></span>
<span>  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model_rml</span>,</span>
<span>  fit.measures <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,</span>
<span>  standardized <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,</span>
<span>  rsquare <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,</span>
<span>  modindices <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span></span>
<span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">science.dwls</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span></span>
<span>  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model_dwls</span>,</span>
<span>  fit.measures <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,</span>
<span>  standardized <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,</span>
<span>  rsquare <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,</span>
<span>  modindices <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span></span>
<span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
</details>
</div>
<p>Tabi ki hem literatürde en yaygın kullanılan hem de alan uzmanları tarafından en ok önerilen yöntem olması sebebiyle MLM yöntemi önceliğimiz. Bu yöntemde normallik varsayımı karşılandığı sürece güçlü analizler elde edilebilmektedir. Veri setimiz de büyük bir örneklemden elde edildiği için bu varsayımın karşılandığı düşünülmektedir. Grafik incelemelerinde de bu durum görülecektir. Dolayısıyla öncelikle MLM’ye ait uyum indekslerini görelim:</p>
<div class="cell" data-code_folding="true">
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">science.mlm</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fit"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span></span></code></pre></div>
</div>
<div class="cell" data-code_folding="false">
<details class="code-fold"><summary>Kod</summary><div class="sourceCode" id="cb8" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;"><a href="https://lavaan.ugent.be">lavaan</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Science.model</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ST092 =~ 1* ST092Q01TA+</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              ST092Q02TA+</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              ST092Q04TA+</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              ST092Q05TA+</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              ST092Q06NA+</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              ST092Q08NA+</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              ST092Q09NA</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              </span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                  ST094 =~ 1* ST094Q01NA+</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              ST094Q02NA+</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              ST094Q03NA+</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              ST094Q04NA+</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              ST094Q05NA</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              </span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                  ST113 =~ 1* ST113Q01TA+</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              ST113Q02TA+</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              ST113Q03TA+</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              ST113Q04TA</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                  </span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                  ST129 =~ 1* ST129Q01TA+</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              ST129Q02TA+</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              ST129Q03TA+</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              ST129Q04TA+</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              ST129Q05TA+</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              ST129Q06TA+</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              ST129Q07TA+</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              ST129Q08TA</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              </span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                  ST131 =~ 1* ST131Q01NA+</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              ST131Q03NA+</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              ST131Q04NA+</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              ST131Q06NA+</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              ST131Q08NA+</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              ST131Q11NA            </span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                    </span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                           </span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                            ST092 ~~ ST094</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                            ST092 ~~ ST113</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                            ST092 ~~ ST129</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                            ST092 ~~ ST131</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                            </span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                            ST094 ~~ ST113</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                            ST094 ~~ ST129</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                            ST094 ~~ ST131</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                            </span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                            ST113 ~~ ST129</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                            ST113 ~~ ST131</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                            </span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                            ST129 ~~ ST131'</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model_mlm</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/lavaan/man/cfa.html">cfa</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Science.model</span>, data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">science_data</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">science.mlm</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span></span>
<span>  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model_mlm</span>,</span>
<span>  fit.measures <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,</span>
<span>  standardized <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,</span>
<span>  rsquare <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,</span>
<span>  modindices <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span></span>
<span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">science.mlm</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fit"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span></span></code></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>                 npar                  fmin                 chisq 
               70.000                 0.652              6055.193 
                   df                pvalue        baseline.chisq 
              395.000                 0.000             96221.017 
          baseline.df       baseline.pvalue                   cfi 
              435.000                 0.000                 0.941 
                  tli                  logl     unrestricted.logl 
                0.935           -135531.110           -132503.514 
                  aic                   bic                ntotal 
           271202.220            271653.284              4646.000 
                 bic2                 rmsea        rmsea.ci.lower 
           271430.850                 0.056                 0.054 
       rmsea.ci.upper        rmsea.ci.level          rmsea.pvalue 
                0.057                 0.900                 0.000 
       rmsea.close.h0 rmsea.notclose.pvalue     rmsea.notclose.h0 
                0.050                 0.000                 0.080 
                 srmr 
                0.039 </code></pre>
</div>
</div>
<p>Bu çıktılar incelendiğinde, 70 parametreli 395 serbestlik derecesinde bir model oluştuğu görülmektedir. CFI ve TLI uyum indekleri .90 eşik değerin üzerindeyken, RMSEA ve SRMR .06’nın altında yer almaktadır. Bu durumda modelimizin uyumlu olduğu düşünülebilir. Yine de diğer modeller ile de karşılaştırmak gerekir. Onların uyum indeklerini de görelim:</p>
<p><strong>WLS model:</strong></p>
<div class="cell" data-code_folding="true">
<details class="code-fold"><summary>Kod</summary><div class="sourceCode" id="cb10" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">science.wls</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fit"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span></span></code></pre></div>
</details>
</div>
<div class="cell" data-code_folding="false">
<div class="cell-output cell-output-stdout">
<pre><code>                 npar                  fmin                 chisq 
               70.000                 0.652              6055.193 
                   df                pvalue        baseline.chisq 
              395.000                 0.000             96221.017 
          baseline.df       baseline.pvalue                   cfi 
              435.000                 0.000                 0.941 
                  tli                  logl     unrestricted.logl 
                0.935           -135531.110           -132503.514 
                  aic                   bic                ntotal 
           271202.220            271653.284              4646.000 
                 bic2                 rmsea        rmsea.ci.lower 
           271430.850                 0.056                 0.054 
       rmsea.ci.upper        rmsea.ci.level          rmsea.pvalue 
                0.057                 0.900                 0.000 
       rmsea.close.h0 rmsea.notclose.pvalue     rmsea.notclose.h0 
                0.050                 0.000                 0.080 
                 srmr 
                0.039 </code></pre>
</div>
</div>
<p><strong>RML model:</strong></p>
<div class="cell" data-code_folding="true">
<div class="sourceCode" id="cb12" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">science.rml</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fit"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span></span></code></pre></div>
</div>
<div class="cell" data-code_folding="false">
<div class="cell-output cell-output-stdout">
<pre><code>                         npar                          fmin 
                       70.000                         0.652 
                        chisq                            df 
                     6055.193                       395.000 
                       pvalue                  chisq.scaled 
                        0.000                      4484.352 
                    df.scaled                 pvalue.scaled 
                      395.000                         0.000 
         chisq.scaling.factor                baseline.chisq 
                        1.350                     96221.017 
                  baseline.df               baseline.pvalue 
                      435.000                         0.000 
        baseline.chisq.scaled            baseline.df.scaled 
                    75815.224                       435.000 
       baseline.pvalue.scaled baseline.chisq.scaling.factor 
                        0.000                         1.269 
                          cfi                           tli 
                        0.941                         0.935 
                   cfi.scaled                    tli.scaled 
                        0.946                         0.940 
                   cfi.robust                    tli.robust 
                        0.942                         0.936 
                         logl             unrestricted.logl 
                  -135531.110                   -132503.514 
                          aic                           bic 
                   271202.220                    271653.284 
                       ntotal                          bic2 
                     4646.000                    271430.850 
                        rmsea                rmsea.ci.lower 
                        0.056                         0.054 
               rmsea.ci.upper                rmsea.ci.level 
                        0.057                         0.900 
                 rmsea.pvalue                rmsea.close.h0 
                        0.000                         0.050 
        rmsea.notclose.pvalue             rmsea.notclose.h0 
                        0.000                         0.080 
                 rmsea.scaled         rmsea.ci.lower.scaled 
                        0.047                         0.046 
        rmsea.ci.upper.scaled           rmsea.pvalue.scaled 
                        0.048                         1.000 
 rmsea.notclose.pvalue.scaled                  rmsea.robust 
                        0.000                         0.055 
        rmsea.ci.lower.robust         rmsea.ci.upper.robust 
                        0.053                         0.056 
          rmsea.pvalue.robust  rmsea.notclose.pvalue.robust 
                        0.000                         0.000 
                         srmr 
                        0.039 </code></pre>
</div>
</div>
<p><strong>DWLS model:</strong></p>
<div class="cell" data-code_folding="true">
<div class="sourceCode" id="cb14" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">science.dwls</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fit"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span></span></code></pre></div>
</div>
<div class="cell" data-code_folding="false">
<div class="cell-output cell-output-stdout">
<pre><code>                 npar                  fmin                 chisq 
               70.000                 0.188              1744.348 
                   df                pvalue        baseline.chisq 
              395.000                 0.000            120867.135 
          baseline.df       baseline.pvalue                   cfi 
              435.000                 0.000                 0.989 
                  tli                 rmsea        rmsea.ci.lower 
                0.988                 0.027                 0.026 
       rmsea.ci.upper        rmsea.ci.level          rmsea.pvalue 
                0.028                 0.900                 1.000 
       rmsea.close.h0 rmsea.notclose.pvalue     rmsea.notclose.h0 
                0.050                 0.000                 0.080 
                 srmr 
                0.034 </code></pre>
</div>
</div>
<p>Tüm bu çıktılar incelendiğinde, en uygun modelin <em>diagonally weighted least squares (DWLS)</em> olduğu düşünülmektedir. Veri setinin farklı ölçek düzeyinde olması ve kategorik olması bu durumun sebebi olabilir. DWLS modeli, liteatürde yaygın bir şekilde bu tür veri setleri için önerilmektedir.</p>
</section><section id="bi-factor-model-oluşturma" class="level3"><h3 class="anchored" data-anchor-id="bi-factor-model-oluşturma">Bi-factor model oluşturma</h3>
<p>Bi faktör modellemede yapıyı oluşturan faktörlerin tüm maddelerden oluşan genel faktör ile ilişkisi incelenerek karar verilir. Bu amaçla DFA örneğinde olduğu gibi model tanımlamamızı yapıyoruz:</p>
<div class="cell" data-code_folding="true">
<details class="code-fold"><summary>Kod</summary><div class="sourceCode" id="cb16" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Science.bifactormodel</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'general.factor =~</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              ST092Q01TA+</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              ST092Q02TA+</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              ST092Q04TA+</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              ST092Q05TA+</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              ST092Q06NA+</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              ST092Q08NA+</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              ST092Q09NA+</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              ST094Q01NA+</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              ST094Q02NA+</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              ST094Q03NA+</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              ST094Q04NA+</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              ST094Q05NA+</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              ST113Q01TA+</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              ST113Q02TA+</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              ST113Q03TA+</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              ST113Q04TA+</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              ST129Q01TA+</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              ST129Q02TA+</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              ST129Q03TA+</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              ST129Q04TA+</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              ST129Q05TA+</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              ST129Q06TA+</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              ST129Q07TA+</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              ST129Q08TA+</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              ST131Q01NA+</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              ST131Q03NA+</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              ST131Q04NA+</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              ST131Q06NA+</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              ST131Q08NA+</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              ST131Q11NA</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"></span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                  ST092 =~ 1* ST092Q01TA+</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              ST092Q02TA+</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              ST092Q04TA+</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              ST092Q05TA+</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              ST092Q06NA+</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              ST092Q08NA+</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              ST092Q09NA</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"></span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                  ST094 =~ 1* ST094Q01NA+</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              ST094Q02NA+</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              ST094Q03NA+</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              ST094Q04NA+</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              ST094Q05NA</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"></span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                  ST113 =~ 1* ST113Q01TA+</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              ST113Q02TA+</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              ST113Q03TA+</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              ST113Q04TA</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"></span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                  ST129 =~ 1* ST129Q01TA+</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              ST129Q02TA+</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              ST129Q03TA+</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              ST129Q04TA+</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              ST129Q05TA+</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              ST129Q06TA+</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              ST129Q07TA+</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              ST129Q08TA</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"></span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                  ST131 =~ 1* ST131Q01NA+</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              ST131Q03NA+</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              ST131Q04NA+</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              ST131Q06NA+</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              ST131Q08NA+</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              ST131Q11NA</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                              </span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"></span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                general.factor  ~~ 0*ST092</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                general.factor  ~~ 0*ST094</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                general.factor  ~~ 0*ST113</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                general.factor  ~~ 0*ST129</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                general.factor  ~~ 0*ST131</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                </span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                            ST092 ~~ ST094</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                            ST092 ~~ ST113</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                            ST092 ~~ ST129</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                            ST092 ~~ ST131</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"></span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                            ST094 ~~ ST113</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                            ST094 ~~ ST129</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                            ST094 ~~ ST131</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"></span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                            ST113 ~~ ST129</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                            ST113 ~~ ST131</span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"></span></span>
<span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                            ST129 ~~ ST131'</span></span></code></pre></div>
</details>
</div>
<p>Ardından modellerimizi veri setimiz ile sınıyoruz.</p>
<div class="cell" data-code_folding="true">
<details class="code-fold"><summary>Kod</summary><div class="sourceCode" id="cb17" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Science.bifactormodel_mlm</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span></span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/lavaan/man/cfa.html">cfa</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span></span>
<span>    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Science.bifactormodel</span>,</span>
<span>    data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">science_data</span>,</span>
<span>    std.lv <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,</span>
<span>    information <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"observed"</span></span>
<span>  <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Science.bifactormodel_rml</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span></span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/lavaan/man/cfa.html">cfa</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span></span>
<span>    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Science.bifactormodel</span>,</span>
<span>    data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">science_data</span>,</span>
<span>    estimator <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"MLM"</span>,</span>
<span>    se <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"robust.mlm"</span>,</span>
<span>    std.lv <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,</span>
<span>    information <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"observed"</span></span>
<span>  <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">bifactor_mlm</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Science.bifactormodel_mlm</span> ,</span>
<span>        fit.measures <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,</span>
<span>        standardized <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">bifactor_rml</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Science.bifactormodel_rml</span> ,</span>
<span>        fit.measures <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,</span>
<span>        standardized <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">bifactor_mlm</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'fit'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span></span></code></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>                 npar                  fmin                 chisq 
               95.000                 0.634              5891.081 
                   df                pvalue        baseline.chisq 
              370.000                 0.000             96221.017 
          baseline.df       baseline.pvalue                   cfi 
              435.000                 0.000                 0.942 
                  tli                  logl     unrestricted.logl 
                0.932           -135449.054           -132503.514 
                  aic                   bic                ntotal 
           271088.109            271700.266              4646.000 
                 bic2                 rmsea        rmsea.ci.lower 
           271398.392                 0.057                 0.055 
       rmsea.ci.upper        rmsea.ci.level          rmsea.pvalue 
                0.058                 0.900                 0.000 
       rmsea.close.h0 rmsea.notclose.pvalue     rmsea.notclose.h0 
                0.050                 0.000                 0.080 
                 srmr 
                0.328 </code></pre>
</div>
<details class="code-fold"><summary>Kod</summary><div class="sourceCode" id="cb19" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">bifactor_rml</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'fit'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span></span></code></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>                         npar                          fmin 
                       95.000                         0.634 
                        chisq                            df 
                     5891.081                       370.000 
                       pvalue                  chisq.scaled 
                        0.000                      4166.363 
                    df.scaled                 pvalue.scaled 
                      370.000                         0.000 
         chisq.scaling.factor                baseline.chisq 
                        1.414                     96221.017 
                  baseline.df               baseline.pvalue 
                      435.000                         0.000 
        baseline.chisq.scaled            baseline.df.scaled 
                    19393.334                       435.000 
       baseline.pvalue.scaled baseline.chisq.scaling.factor 
                        0.000                         4.962 
                          cfi                           tli 
                        0.942                         0.932 
                   cfi.scaled                    tli.scaled 
                        0.800                         0.765 
                   cfi.robust                    tli.robust 
                        0.943                         0.933 
                         logl             unrestricted.logl 
                  -135449.054                   -132503.514 
                          aic                           bic 
                   271088.109                    271700.266 
                       ntotal                          bic2 
                     4646.000                    271398.392 
                        rmsea                rmsea.ci.lower 
                        0.057                         0.055 
               rmsea.ci.upper                rmsea.ci.level 
                        0.058                         0.900 
                 rmsea.pvalue                rmsea.close.h0 
                        0.000                         0.050 
        rmsea.notclose.pvalue             rmsea.notclose.h0 
                        0.000                         0.080 
                 rmsea.scaled         rmsea.ci.lower.scaled 
                        0.047                         0.046 
        rmsea.ci.upper.scaled           rmsea.pvalue.scaled 
                        0.048                         1.000 
 rmsea.notclose.pvalue.scaled                  rmsea.robust 
                        0.000                         0.056 
        rmsea.ci.lower.robust         rmsea.ci.upper.robust 
                        0.054                         0.057 
          rmsea.pvalue.robust  rmsea.notclose.pvalue.robust 
                        0.000                         0.000 
                         srmr 
                        0.328 </code></pre>
</div>
</div>
<p><strong>BI-FAKTÖR ML model:</strong></p>
<div class="cell" data-code_folding="false">
<div class="cell-output cell-output-stdout">
<pre><code>                 npar                  fmin                 chisq 
               95.000                 0.634              5891.081 
                   df                pvalue        baseline.chisq 
              370.000                 0.000             96221.017 
          baseline.df       baseline.pvalue                   cfi 
              435.000                 0.000                 0.942 
                  tli                  logl     unrestricted.logl 
                0.932           -135449.054           -132503.514 
                  aic                   bic                ntotal 
           271088.109            271700.266              4646.000 
                 bic2                 rmsea        rmsea.ci.lower 
           271398.392                 0.057                 0.055 
       rmsea.ci.upper        rmsea.ci.level          rmsea.pvalue 
                0.058                 0.900                 0.000 
       rmsea.close.h0 rmsea.notclose.pvalue     rmsea.notclose.h0 
                0.050                 0.000                 0.080 
                 srmr 
                0.328 </code></pre>
</div>
</div>
<p><strong>BI-FAKTÖR ROBUST ML model:</strong></p>
<div class="cell" data-code_folding="false">
<div class="cell-output cell-output-stdout">
<pre><code>                         npar                          fmin 
                       95.000                         0.634 
                        chisq                            df 
                     5891.081                       370.000 
                       pvalue                  chisq.scaled 
                        0.000                      4166.363 
                    df.scaled                 pvalue.scaled 
                      370.000                         0.000 
         chisq.scaling.factor                baseline.chisq 
                        1.414                     96221.017 
                  baseline.df               baseline.pvalue 
                      435.000                         0.000 
        baseline.chisq.scaled            baseline.df.scaled 
                    19393.334                       435.000 
       baseline.pvalue.scaled baseline.chisq.scaling.factor 
                        0.000                         4.962 
                          cfi                           tli 
                        0.942                         0.932 
                   cfi.scaled                    tli.scaled 
                        0.800                         0.765 
                   cfi.robust                    tli.robust 
                        0.943                         0.933 
                         logl             unrestricted.logl 
                  -135449.054                   -132503.514 
                          aic                           bic 
                   271088.109                    271700.266 
                       ntotal                          bic2 
                     4646.000                    271398.392 
                        rmsea                rmsea.ci.lower 
                        0.057                         0.055 
               rmsea.ci.upper                rmsea.ci.level 
                        0.058                         0.900 
                 rmsea.pvalue                rmsea.close.h0 
                        0.000                         0.050 
        rmsea.notclose.pvalue             rmsea.notclose.h0 
                        0.000                         0.080 
                 rmsea.scaled         rmsea.ci.lower.scaled 
                        0.047                         0.046 
        rmsea.ci.upper.scaled           rmsea.pvalue.scaled 
                        0.048                         1.000 
 rmsea.notclose.pvalue.scaled                  rmsea.robust 
                        0.000                         0.056 
        rmsea.ci.lower.robust         rmsea.ci.upper.robust 
                        0.054                         0.057 
          rmsea.pvalue.robust  rmsea.notclose.pvalue.robust 
                        0.000                         0.000 
                         srmr 
                        0.328 </code></pre>
</div>
</div>
<p>Bu çıktılar incelendiğinde de bi faktör modelin verimize DWLS model kadar uyumlu olmadığı görülmektedir. Bu nedenle DWLS modelin en uyumlu model olduğu düşünülmektedir. Bu modelin çıktılarını tablolaştıralım.</p>
</section><section id="en-uyumlu-modeldwls-çıktıları" class="level3"><h3 class="anchored" data-anchor-id="en-uyumlu-modeldwls-çıktıları">En Uyumlu Model:DWLS çıktıları</h3>
<p>NOT: Faktör varyansları sabitlenerek model oluşturulduğu için faktör varyansları tablosu raporlaştırılmamıştır.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="JASP">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
JASP
</div>
</div>
<div class="callout-body-container callout-body">
<p>Aşağıdaki çıktılar JASP’tan alınmıştır. JASP, istatiksel altyapısını R’dan alan bir açık kaynak kodlu yazılımdır. Kullanımı kolaydır ve çıktıları anlaşılır bir şekilde sunar. İndirmek ve daha fazla bilgi edinmek için <a href="https://jasp-stats.org/">JASP</a> adresini ziyaret edebilirsiniz.</p>
</div>
</div>
<section id="model-uyum-indeksleri" class="level4"><h4 class="anchored" data-anchor-id="model-uyum-indeksleri">Model uyum indeksleri</h4>
<p><img src="https://emrekaragul.com/posts/Structural Equation Modelling (in Turkish)/images/paste-E29C1283.png" class="img-fluid"></p>
<p>Parametre Tahminleri</p>
<p><img src="https://emrekaragul.com/posts/Structural Equation Modelling (in Turkish)/images/paste-30D7D53C.png" class="img-fluid"></p>
</section><section id="faktör-kovaryansları" class="level4"><h4 class="anchored" data-anchor-id="faktör-kovaryansları">Faktör Kovaryansları</h4>
<p><img src="https://emrekaragul.com/posts/Structural Equation Modelling (in Turkish)/images/paste-2111BA05.png" class="img-fluid"></p>
</section><section id="artık-residual-varyanslar" class="level4"><h4 class="anchored" data-anchor-id="artık-residual-varyanslar">Artık (residual) Varyanslar</h4>
<p><img src="https://emrekaragul.com/posts/Structural Equation Modelling (in Turkish)/images/paste-883E5B7B.png" class="img-fluid"></p>
</section><section id="model-gösterimi" class="level4"><h4 class="anchored" data-anchor-id="model-gösterimi">Model gösterimi</h4>
<p><img src="https://emrekaragul.com/posts/Structural Equation Modelling (in Turkish)/images/paste-A04B6DB6.png" class="img-fluid"></p>


</section></section></section> ]]></description>
  <category>haven</category>
  <category>dplyr</category>
  <category>lavaan</category>
  <guid>https://emrekaragul.com/posts/Structural Equation Modelling (in Turkish)/</guid>
  <pubDate>Sat, 29 Oct 2022 21:00:00 GMT</pubDate>
  <media:content url="https://emrekaragul.com/posts/Structural Equation Modelling (in Turkish)/image.png" medium="image" type="image/png" height="144" width="144"/>
</item>
<item>
  <title>Test Equating</title>
  <dc:creator>Ali Emre Karagül</dc:creator>
  <link>https://emrekaragul.com/posts/Test Equating/</link>
  <description><![CDATA[ <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mailchimp Subscription Modal</title>
<link href="//cdn-images.mailchimp.com/embedcode/classic-071822.css" rel="stylesheet" type="text/css">
<style>
        /* Modal Background */
        .modal {
            display: none; /* Hidden by default */
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5); /* Dimmed background */
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        #openModalBtn {
            background-color: tomato; /* background */
            color: white; /* White text */
            border: none; /* Remove border */
            padding: 10px 20px; /* Add padding */
            font-size: 24px; /* Adjust font size */
            border-radius: 5px; /* Rounded corners */
            cursor: pointer; /* Pointer cursor on hover */
            transition: background-color 0.3s ease; /* Smooth hover effect */
            width: 100%;
            margin-bottom: 20px; /* Add space after the button */
        }

        #openModalBtn:hover {
            background-color: rgb(255, 58, 23); /* Darker on hover */
        }
        /* Modal Content */
        .modal-content {
            background-color: #fff;
            padding: 20px;
            border-radius: 8px;
            max-width: 600px;
            width: 90%;
            text-align: center;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            overflow: auto;
        }

        /* Close Button */
        .close-btn {
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 20px;
            font-weight: bold;
            color: #aaa;
            cursor: pointer;
        }

        .close-btn:hover {
            color: #000;
        }
    </style>
<!-- Trigger Button --><button id="openModalBtn">Wanna subscribe?</button>


    <!-- Modal Structure -->
    <div id="subscriptionModal" class="modal">
        <div class="modal-content">
            <span class="close-btn">×</span>
            <!-- Mailchimp Signup Form -->
            <div>
                <div id="mc_embed_signup">
                    <form action="https://emrekaragul.us21.list-manage.com/subscribe/post?u=e72720e0214b2266cab41097e&amp;id=5cddb1a68e&amp;f_id=0038dfe1f0" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate="">
                        <div id="mc_embed_signup_scroll">
                            <h2 class="anchored">Submit your e-mail to subscribe!</h2>
                            <div class="mc-field-group">
                                <label for="mce-EMAIL">Email Address <span class="asterisk">*</span></label>
                                <input type="email" value="" name="EMAIL" class="required email" id="mce-EMAIL" required=""><span id="mce-EMAIL-HELPERTEXT" class="helper_text"></span>
                            </div>
                            <div id="mce-responses" class="clear foot">
                                <div class="response" id="mce-error-response" style="display:none"></div>
                                <div class="response" id="mce-success-response" style="display:none"></div>
                            </div>
                            
                            <div class="optionalParent">
                                <div class="clear foot">
                                    <input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button">
</div>
                            </div>
                        </div>
                    </form>
                </div>
                <script type="text/javascript" src="//s3.amazonaws.com/downloads.mailchimp.com/js/mc-validate.js"></script><script type="text/javascript">
                    (function($) {
                        window.fnames = new Array();
                        window.ftypes = new Array();
                        fnames[0] = 'EMAIL';
                        ftypes[0] = 'email';
                    }(jQuery));
                    var $mcj = jQuery.noConflict(true);
                </script><!--End mc_embed_signup-->
</div>
        </div>
    </div>

    <script>
        // Get the modal, button, and close elements
        const modal = document.getElementById("subscriptionModal");
        const openModalBtn = document.getElementById("openModalBtn");
        const closeBtn = document.querySelector(".close-btn");

        // Open the modal when the button is clicked
        openModalBtn.addEventListener("click", () => {
            modal.style.display = "flex"; // Show the modal
        });

        // Close the modal when the close button is clicked
        closeBtn.addEventListener("click", () => {
            modal.style.display = "none"; // Hide the modal
        });

        // Close the modal when clicking outside of it
        window.addEventListener("click", (e) => {
            if (e.target === modal) {
                modal.style.display = "none";
            }
        });
    </script><p>This is a simple test equating study. The data used in this study is simulated from real data. We don’t use the real data for privacy purposes here.</p>
<p>2020-2021 Fall Term A Level’s first quiz has 40 items. 2022-2023 Fall Term A Level’s first quiz has 40 items. 35 of the items in each test forms are unique items while 5 of them are common, thus will be called as “anchor items” in this study. For the readers interest, the items belong to four main domains (listening, structure, vocabbulary and reading), yet the common items are only in the reading section. This is obviously a violation of assumptions of test equating. Still, this study is conveyed for demonstration purposes. Therefore, let’s continue:</p>
<p>To ensure statistical equation of these two forms, we first introduced the data in R Studio and the first five rows can be seen below:</p>
<div class="cell" data-code_folding="true">
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Q1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"kitap1.csv"</span>, header <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Q1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  L1 L2 L3 L4 L5 L6 L7 L8 L9 L10 S1 S2 S3 S4 S5 S6 S7 S8 S9 S10 V1 V2 V3 V4 V5
1  0  1  0  1  1  1  0  1  1   0  1  1  0  1  0  0  0  0  0   1  0  1  1  0  1
2  1  1  1  1  1  1  1  1  1   1  0  1  1  0  1  1  0  0  0   0  1  1  1  1  0
3  1  1  1  1  1  1  0  1  1   0  1  1  0  1  1  0  0  1  1   0  0  1  0  1  0
4  1  1  1  1  1  1  1  0  1   0  1  1  0  1  1  0  1  1  0   0  0  1  1  0  1
5  1  1  1  1  1  1  1  0  1   1  1  1  1  1  0  1  0  1  0   0  1  1  1  0  0
6  1  1  1  1  0  0  1  1  1   1  0  0  0  0  0  1  1  1  1   1  1  1  1  0  0
  V6 V7 V8 V9 V10 R1 R2 R3 R4 R5 R6 R7 R8 R9 R10 form
1  0  1  1  1   1  1  1  0  1  1  1  1  1  1   1    x
2  0  1  1  0   0  1  0  1  1  0  1  1  0  1   1    x
3  1  0  1  1   1  1  0  0  1  1  1  0  1  1   1    x
4  1  1  1  0   1  1  1  1  1  0  1  0  0  1   1    x
5  1  1  1  0   1  1  1  1  0  1  1  1  0  1   1    x
6  1  1  1  1   1  1  1  1  1  1  1  1  1  1   1    x</code></pre>
</div>
</div>
<p>Later, we introduced the unique and anchor items separately. First 35 items are unique items, and the last 5 items are anchor items.</p>
<div class="cell" data-code_folding="true">
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calculate total scores based on unique items</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Q1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">total</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/colSums.html">rowSums</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Q1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">35</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span></span>
<span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calculate scores based on anchor items</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Q1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">anchor</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/colSums.html">rowSums</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Q1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">36</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">40</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
</div>
<p>As we will use the <strong><em>equate</em></strong> package, the data should be contained as frequency tables: Form x (20-21 fall) had a sample of 200 while form y (22-23 fall) had a sample of 133 students. They are defined as:</p>
<div class="cell" data-code_folding="true">
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#first introduce the equate package:</span></span>
<span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;"><a href="https://github.com/talbano/equate">equate</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create frequency tables (total score range: 0-35; anchor score range: 0-5)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Q1_x</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">freqtab</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Q1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">200</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"total"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"anchor"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span>, scales <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">35</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Q1_y</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">freqtab</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Q1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">201</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">334</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"total"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"anchor"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span>, scales <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">35</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
</div>
<p>To consideration of the reader one more time, we must state that these forms are the first quizzes of the students. They usually get high marks. For instance, you can see below that the students’ scores are distributed left-skewed in both forms. Their total correct answers are distributed between 20 and 35 for the unique items , and between 3 and 5 for anchor items in form X. The situation isn’t different for form y.</p>
<div class="cell" data-code_folding="true">
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#distrubution of the data among forms and unique/common items</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Q1_x</span>, xlab <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Total Scores Form X"</span>, ylab <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Common Anchor Scores Form X"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="index_files/figure-html/unnamed-chunk-4-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="https://emrekaragul.com/posts/Test Equating/index_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Q1_y</span>, xlab <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Total Scores Form y"</span>, ylab <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Common Anchor Scores Form y"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="index_files/figure-html/unnamed-chunk-4-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img src="https://emrekaragul.com/posts/Test Equating/index_files/figure-html/unnamed-chunk-4-2.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>Still, let’s continue… with the smoothing procedure. For both forms, we utilized loglinear presmoothing. Of course there are several other methods, yet literature shows not much a big difference between them, thus not much care given to this issue. again as this is a study with demonstration purposes. After the smoothing, it can be realized that the distribution is highly eye-pleasing right now. Also it is much easier to match the scores even if there isn’t an equivalent of it in the other form.</p>
<div class="cell" data-code_folding="true">
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#PRESMOOTHING</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">smooth_x</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">presmoothing</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Q1_x</span>, smoothmethod <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"loglinear"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: glm.fit: fitted rates numerically 0 occurred</code></pre>
</div>
<div class="sourceCode" id="cb9" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">smooth_y</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">presmoothing</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Q1_y</span>, smoothmethod <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"loglinear"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: glm.fit: algorithm did not converge

Warning: glm.fit: fitted rates numerically 0 occurred</code></pre>
</div>
<div class="sourceCode" id="cb11" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">smooth_x</span>, xlab <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Total Scores Form X"</span>, ylab <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Common Anchor Scores Form X"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="index_files/figure-html/unnamed-chunk-5-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img src="https://emrekaragul.com/posts/Test Equating/index_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<div class="sourceCode" id="cb12" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">smooth_y</span>, xlab <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Total Scores Form y"</span>, ylab <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Common Anchor Scores Form y"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="index_files/figure-html/unnamed-chunk-5-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4"><img src="https://emrekaragul.com/posts/Test Equating/index_files/figure-html/unnamed-chunk-5-2.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>Now, it can be roughly said that the forms are ready to be equated. Before we try several methods, lets see the results of the Tucker method as it can produce equating error as well:</p>
<div class="cell" data-code_folding="true">
<div class="sourceCode" id="cb13" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Linear Tucker Equating</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Q1_tucker</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">equate</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Q1_x</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Q1_y</span>, type <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"linear"</span>, method <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tucker"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Q1_tucker</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">concordance</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   scale        yx      se.n      se.g
1      0  6.597617 2.0378528 3.3547355
2      1  7.404998 1.9751403 3.2551073
3      2  8.212379 1.9124541 3.1554875
4      3  9.019759 1.8497970 3.0558770
5      4  9.827140 1.7871721 2.9562768
6      5 10.634520 1.7245827 2.8566879
7      6 11.441901 1.6620331 2.7571116
8      7 12.249282 1.5995277 2.6575492
9      8 13.056662 1.5370720 2.5580024
10     9 13.864043 1.4746724 2.4584730
11    10 14.671423 1.4123363 2.3589634
12    11 15.478804 1.3500723 2.2594761
13    12 16.286185 1.2878911 2.1600141
14    13 17.093565 1.2258052 2.0605812
15    14 17.900946 1.1638299 1.9611818
16    15 18.708326 1.1019838 1.8618212
17    16 19.515707 1.0402899 1.7625060
18    17 20.323088 0.9787772 1.6632444
19    18 21.130468 0.9174818 1.5640464
20    19 21.937849 0.8564507 1.4649252
21    20 22.745229 0.7957445 1.3658973
22    21 23.552610 0.7354438 1.2669847
23    22 24.359991 0.6756570 1.1682166
24    23 25.167371 0.6165338 1.0696330
25    24 25.974752 0.5582849 0.9712903
26    25 26.782132 0.5012154 0.8732696
27    26 27.589513 0.4457784 0.7756933
28    27 28.396894 0.3926659 0.6787528
29    28 29.204274 0.3429596 0.5827655
30    29 30.011655 0.2983669 0.4882941
31    30 30.819035 0.2615166 0.3964236
32    31 31.626416 0.2360629 0.3094791
33    32 32.433797 0.2258919 0.2330408
34    33 33.241177 0.2330134 0.1809526
35    34 34.048558 0.2559883 0.1763087
36    35 34.855938 0.2910866 0.2221053</code></pre>
</div>
</div>
<p>You will see that the equating errors are above 1 before the score of 25 as there isn’t much data in the low scores. Also, as we investigate the lower marks, we see that the gap between equated scores are increasing. For instance, 0 on form X is equal to 6.597617 on form Y. This is because there isn’t data in these regions of the scores. Despite that, equated scores get more meaningful after 20. Especially after the total score 30, the equated scores are too close and the equation error is too low, which would be quite better if the situation was like that on all total score ranges. Let’s see some other equating methods:</p>
<div class="cell" data-code_folding="true">
<div class="sourceCode" id="cb15" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Comparing Multiple Methods</span></span>
<span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Nominal method with mean equating</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Q1_nom</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">equate</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Q1_x</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Q1_y</span>, type <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mean"</span>, method <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"nom"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span></span>
<span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Frequency method with equipercentile</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Q1_freq</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">equate</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Q1_x</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Q1_y</span>, type <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"equip"</span>, method <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"freq"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span></span>
<span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Braun method with linear equating</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Q1_braun</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">equate</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Q1_x</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Q1_y</span>, type <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"linear"</span>, method <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"braun"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span></span>
<span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Compare equated scores</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>xscale <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">35</span>, </span>
<span>            nominal <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Q1_nom</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">concordance</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">yx</span>,</span>
<span>            tucker <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Q1_tucker</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">concordance</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">yx</span>, </span>
<span>            freq <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Q1_freq</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">concordance</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">yx</span>, </span>
<span>            braun <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Q1_braun</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">concordance</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">yx</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      xscale nominal tucker  freq braun
 [1,]      0   -0.01   6.60 -0.50  5.65
 [2,]      1    0.99   7.40 -0.50  6.49
 [3,]      2    1.99   8.21 -0.50  7.32
 [4,]      3    2.99   9.02 -0.50  8.16
 [5,]      4    3.99   9.83 -0.50  9.00
 [6,]      5    4.99  10.63 -0.50  9.83
 [7,]      6    5.99  11.44 -0.50 10.67
 [8,]      7    6.99  12.25 -0.50 11.50
 [9,]      8    7.99  13.06 -0.50 12.34
[10,]      9    8.99  13.86 -0.50 13.17
[11,]     10    9.99  14.67 -0.50 14.01
[12,]     11   10.99  15.48 -0.50 14.84
[13,]     12   11.99  16.29 -0.50 15.68
[14,]     13   12.99  17.09 -0.50 16.51
[15,]     14   13.99  17.90 -0.50 17.35
[16,]     15   14.99  18.71 -0.50 18.19
[17,]     16   15.99  19.52 -0.50 19.02
[18,]     17   16.99  20.32 -0.50 19.86
[19,]     18   17.99  21.13 -0.50 20.69
[20,]     19   18.99  21.94 -0.50 21.53
[21,]     20   19.99  22.75 -0.50 22.36
[22,]     21   20.99  23.55 23.66 23.20
[23,]     22   21.99  24.36 23.82 24.03
[24,]     23   22.99  25.17 24.10 24.87
[25,]     24   23.99  25.97 24.38 25.71
[26,]     25   24.99  26.78 24.57 26.54
[27,]     26   25.99  27.59 25.35 27.38
[28,]     27   26.99  28.40 27.28 28.21
[29,]     28   27.99  29.20 29.14 29.05
[30,]     29   28.99  30.01 30.65 29.88
[31,]     30   29.99  30.82 31.34 30.72
[32,]     31   30.99  31.63 31.76 31.55
[33,]     32   31.99  32.43 32.35 32.39
[34,]     33   32.99  33.24 33.09 33.22
[35,]     34   33.99  34.05 33.88 34.06
[36,]     35   34.99  34.86 34.86 34.90</code></pre>
</div>
</div>
<p>Although the equating methods vary, the results are similar to those of Tucker method. Especially Frequency Estimation method shows how important it is to have data in different score ranges because there is no meaningful equation before the scale score of 20 and all lower scores are equated to -.5 in this method. Let’s also see the plotting of the chart above:</p>
<div class="cell" data-code_folding="true">
<div class="sourceCode" id="cb17" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot the results</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Q1_tucker</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Q1_nom</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Q1_freq</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Q1_braun</span>, lty<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>,</span>
<span>     col<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blue"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"forestgreen"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>, addident <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="index_files/figure-html/unnamed-chunk-8-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5"><img src="https://emrekaragul.com/posts/Test Equating/index_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>As also can be seen in the plot above, after the scale score of 20, all equating methods are quite similar to each other. Scores lower than 20 are equated with linear methods much better than the equi-percentile method as there isn’t adequate data in those score ranges.</p>
<p>This study is conducted for demonstrative purposes and still we can say that scale scores over 30 can be equated in the given forms.</p>



 ]]></description>
  <category>equate</category>
  <guid>https://emrekaragul.com/posts/Test Equating/</guid>
  <pubDate>Mon, 19 Sep 2022 21:00:00 GMT</pubDate>
  <media:content url="https://emrekaragul.com/posts/Test Equating/image.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Madde Tepki Kuramı Temelli Madde Analizi</title>
  <dc:creator>Ali Emre Karagül</dc:creator>
  <link>https://emrekaragul.com/posts/Item Analysis with Item Response Theory (in Turkish)/</link>
  <description><![CDATA[ <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mailchimp Subscription Modal</title>
<link href="//cdn-images.mailchimp.com/embedcode/classic-071822.css" rel="stylesheet" type="text/css">
<style>
        /* Modal Background */
        .modal {
            display: none; /* Hidden by default */
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5); /* Dimmed background */
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        #openModalBtn {
            background-color: tomato; /* background */
            color: white; /* White text */
            border: none; /* Remove border */
            padding: 10px 20px; /* Add padding */
            font-size: 24px; /* Adjust font size */
            border-radius: 5px; /* Rounded corners */
            cursor: pointer; /* Pointer cursor on hover */
            transition: background-color 0.3s ease; /* Smooth hover effect */
            width: 100%;
            margin-bottom: 20px; /* Add space after the button */
        }

        #openModalBtn:hover {
            background-color: rgb(255, 58, 23); /* Darker on hover */
        }
        /* Modal Content */
        .modal-content {
            background-color: #fff;
            padding: 20px;
            border-radius: 8px;
            max-width: 600px;
            width: 90%;
            text-align: center;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            overflow: auto;
        }

        /* Close Button */
        .close-btn {
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 20px;
            font-weight: bold;
            color: #aaa;
            cursor: pointer;
        }

        .close-btn:hover {
            color: #000;
        }
    </style>
<!-- Trigger Button --><button id="openModalBtn">Wanna subscribe?</button>


    <!-- Modal Structure -->
    <div id="subscriptionModal" class="modal">
        <div class="modal-content">
            <span class="close-btn">×</span>
            <!-- Mailchimp Signup Form -->
            <div>
                <div id="mc_embed_signup">
                    <form action="https://emrekaragul.us21.list-manage.com/subscribe/post?u=e72720e0214b2266cab41097e&amp;id=5cddb1a68e&amp;f_id=0038dfe1f0" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate="">
                        <div id="mc_embed_signup_scroll">
                            <h2 class="anchored">Submit your e-mail to subscribe!</h2>
                            <div class="mc-field-group">
                                <label for="mce-EMAIL">Email Address <span class="asterisk">*</span></label>
                                <input type="email" value="" name="EMAIL" class="required email" id="mce-EMAIL" required=""><span id="mce-EMAIL-HELPERTEXT" class="helper_text"></span>
                            </div>
                            <div id="mce-responses" class="clear foot">
                                <div class="response" id="mce-error-response" style="display:none"></div>
                                <div class="response" id="mce-success-response" style="display:none"></div>
                            </div>
                            
                            <div class="optionalParent">
                                <div class="clear foot">
                                    <input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button">
</div>
                            </div>
                        </div>
                    </form>
                </div>
                <script type="text/javascript" src="//s3.amazonaws.com/downloads.mailchimp.com/js/mc-validate.js"></script><script type="text/javascript">
                    (function($) {
                        window.fnames = new Array();
                        window.ftypes = new Array();
                        fnames[0] = 'EMAIL';
                        ftypes[0] = 'email';
                    }(jQuery));
                    var $mcj = jQuery.noConflict(true);
                </script><!--End mc_embed_signup-->
</div>
        </div>
    </div>

    <script>
        // Get the modal, button, and close elements
        const modal = document.getElementById("subscriptionModal");
        const openModalBtn = document.getElementById("openModalBtn");
        const closeBtn = document.querySelector(".close-btn");

        // Open the modal when the button is clicked
        openModalBtn.addEventListener("click", () => {
            modal.style.display = "flex"; // Show the modal
        });

        // Close the modal when the close button is clicked
        closeBtn.addEventListener("click", () => {
            modal.style.display = "none"; // Hide the modal
        });

        // Close the modal when clicking outside of it
        window.addEventListener("click", (e) => {
            if (e.target === modal) {
                modal.style.display = "none";
            }
        });
    </script><section id="giriş" class="level2"><h2 class="anchored" data-anchor-id="giriş">GİRİŞ</h2>
<p>Bu çalışmada çok kategorili puanlanan maddelerden elde edilen bir veri seti kullanılmıştır. Çalışmanın ilk kısmında çok kategorili maddelere yönelik MTK analizleri yürütülmüştür. Daha sonra aynı veri seti iki kategorili verilere dönüştürülmüştür. Yine MTK süreçleri bu sefer de iki kategorili maddeler için yürütülmüştür. İzlenen adımlar şu şekildedir:</p>
<p><strong>1. Çoklu puanlanan maddelere yönelik olarak;</strong></p>
<ul>
<li>Uygun MTK modeli nedir?</li>
<li>Bu modele göre madde ve test parametreleri nasıldır?</li>
<li>İdeal ve sorunlu madde örnekleri nasıldır?</li>
<li>Test bilgi fonksiyonunu nasıldır?</li>
<li>Birey yetenek puanlarının dağılımı nasıldır?</li>
</ul>
<p><strong>2. Her bir maddeyi, kendi madde ortalamasından keserek 1-0 verisine dönüştürünüz. Buna göre iki kategorili puanlanan maddelere yönelik olarak;</strong></p>
<ul>
<li>Uygun MTK modeli nedir?</li>
<li>Bu modele göre madde ve test parametreleri nasıldır?</li>
<li>İdeal ve sorunlu madde örnekleri nasıldır?</li>
<li>Test bilgi fonksiyonunu nasıldır?</li>
<li>Birey yetenek puanlarının dağılımı nasıldır?</li>
</ul>
<section id="veri-ön-hazırlığı" class="level3"><h3 class="anchored" data-anchor-id="veri-ön-hazırlığı"><strong>Veri Ön Hazırlığı</strong></h3>
<p>Kullanılan paketleri listeleyelim:</p>
<div class="cell">
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;"><a href="https://personality-project.org/r/psych/">psych</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;"><a href="https://optimizer.r-forge.r-project.org/GPArotation_www/">GPArotation</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;"><a href="https://github.com/alexanderrobitzsch/sirt">sirt</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;"><a href="https://github.com/drizopoulos/ltm">ltm</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
</div>
<p>Tabi ki işe öncelikle verinin working directory’den yüklenmesi ve ön düzenleme süreçleri ile başladık:</p>
<div class="cell">
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/utils/read.table.html">read.csv2</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sampledata.csv"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> </span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   531 obs. of  25 variables:
 $ SIRA    : int  1 2 3 4 5 6 7 8 9 10 ...
 $ Fakulte : chr  "Diger" "Diger" "Diger" "Diger" ...
 $ Sinif   : int  4 4 5 4 5 4 4 4 4 4 ...
 $ Cinsiyet: chr  "Kad\xfdn" "Kad\xfdn" "Kad\xfdn" "Kad\xfdn" ...
 $ Ortalama: chr  "2.88" "2.93" "3.12" "3.28" ...
 $ L1      : int  2 1 2 2 1 3 3 1 1 2 ...
 $ L2      : int  1 1 4 2 1 4 4 3 4 1 ...
 $ L3      : int  2 4 4 3 1 4 3 1 4 4 ...
 $ L4      : int  1 2 4 3 2 4 4 1 2 3 ...
 $ L5      : int  2 4 4 4 2 5 4 1 3 4 ...
 $ L6      : int  1 5 4 3 4 3 3 5 4 2 ...
 $ L7      : int  2 1 4 3 5 4 4 1 2 3 ...
 $ L8      : int  1 3 3 3 1 4 4 1 2 1 ...
 $ L9      : int  2 1 4 4 1 3 5 1 3 4 ...
 $ L10     : int  1 1 2 3 2 4 4 1 4 2 ...
 $ L11     : int  2 1 4 3 3 4 5 4 3 2 ...
 $ L12     : int  1 3 4 3 5 4 5 2 3 2 ...
 $ L13     : int  2 1 2 2 1 2 3 1 1 4 ...
 $ L14     : int  1 1 1 2 1 3 4 1 2 5 ...
 $ L15     : int  3 3 4 3 2 3 4 1 2 4 ...
 $ L16     : int  1 1 1 2 1 2 2 2 2 5 ...
 $ L17     : int  2 2 2 2 1 3 4 1 2 4 ...
 $ L18     : int  2 2 2 3 4 3 2 1 2 3 ...
 $ L19     : int  2 2 2 3 2 4 3 1 4 2 ...
 $ L20     : int  1 1 2 3 1 3 4 1 3 4 ...</code></pre>
</div>
</div>
<p>Veri setinde ilk sütunun sıra sayıları olduğunu görünce aman tanrım dedik ve sildik.</p>
<div class="cell">
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span> </span></code></pre></div>
</div>
<p>Kayıp veri olup olmadığını anlamak için:</p>
<div class="cell">
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 44</code></pre>
</div>
</div>
<p>Neredeyse %8 oranında missing value var. Too much! Alayını atıyoruz. Artık adını da değiştirelim.</p>
<div class="cell">
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
</div>
<p>Madem ki öylesine bir veri seti ile öylesine bir analiz yapıyoruz ve practical kaygılarımız yok, veri setimizi büyütelim. 1000 kişi olsun:</p>
<div class="cell">
<div class="sourceCode" id="cb8" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">16611106</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>  </span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data3</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">495</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>, replace <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">T</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#adını da değiştirelim </span></span></code></pre></div>
</div>
<p>Son olarak, veri setinde işimize yaramayacak bir sürü demografik detay var. Atıyoruz:</p>
<div class="cell">
<div class="sourceCode" id="cb9" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/row.names.html">row.names</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data3</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span> </span>
<span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data4</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data3</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">24</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span></span></code></pre></div>
</div>
<p>Çalışmanın birinci araştırma sorusu kapsamında “data4” adlı veri seti kullanılmıştır. Bu veri seti 1000 gözlemden ve 20 değişkenden oluşmaktadır. Değişkenler, 1 ile 5 arasında bir tam sayı değeri almaktadır. Çalışmanın ikinci araştırma sorusu kapsamında ise her bir madde kendi madde ortalamasından kesilerek iki kategorili veriye dönüştürülmüştür. Bu aşamalar ilgili başlık altında raporlaştırılmıştır. Ön düzenlemelerin ardından araştırma sorularına cevap aramak için ileri analizlere devam edilmiştir.</p>
</section></section><section id="çok-boyutlu-maddelere-yönelik-aşamalar" class="level2"><h2 class="anchored" data-anchor-id="çok-boyutlu-maddelere-yönelik-aşamalar"><strong>1. Çok Boyutlu Maddelere Yönelik Aşamalar</strong></h2>
<p>Çalışmanın ilk araştırma sorusu kapsamında, yapılan analizler çok kategorili puanlanan maddeler üzerinden yürütülmüştür.</p>
<section id="a.-varsayımların-kontrolü-ve-uygun-mtk-modelinin-belirlenmesi" class="level3"><h3 class="anchored" data-anchor-id="a.-varsayımların-kontrolü-ve-uygun-mtk-modelinin-belirlenmesi"><strong>1.a. Varsayımların kontrolü ve uygun MTK modelinin belirlenmesi</strong></h3>
<p>Çok kategorili puanlanan maddelerden oluşan ölçeğin Madde Tepki Kuramı çerçevesinde incelenmesi sürecinde öncelikle uygun MTK modelinin belirlenebilmesi için varsayım kontrolleri yapılmıştır. Bu bağlamda, tek boyutluluk ve yerel bağımsızlık varsayımları ile model-veri uyumu kontrol edilmiştir. Tek boyutluluk varsayımı kontrolü için paralel analiz, yamaç birikinti grafiği ve faktör analizi kullanılmıştır. Bu aşamada kullanılan paketler: <em>Psych</em> ve <em>GPArotation.</em></p>
<p>Paralel Analizden elde edilen yamaç birikinti grafiği şöyledir:</p>
<div class="cell">
<div class="sourceCode" id="cb10" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/psych/man/fa.parallel.html">fa.parallel</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data4</span>, n.obs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>, cor <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"poly"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="https://emrekaragul.com/posts/Item Analysis with Item Response Theory (in Turkish)/index_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Parallel analysis suggests that the number of factors =  5  and the number of components =  2 </code></pre>
</div>
</div>
<p>Yamaç birikinti grafiği iki bileşenli bir yapıyı göstermektedir.&nbsp; Son olarak faktör analizi yardımı ile hem tek hem de iki bileşenli modeller oluşturulmuştur:</p>
<div class="cell">
<div class="sourceCode" id="cb12" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fa_model1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/psych/man/deprecated.html">fa.poly</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data4</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fa_model2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/psych/man/fa.html">fa</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data4</span>, nfactors <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, cor<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"poly"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
</div>
<p>Bu iki modelin burada çıktılarını alsak baya uzun oluyor. Ama özetle; ben beğendiğim ve devam analizi için seçtiğim 2 faktörlü model ile devam ediyorum. Bu modelin çıktıları incelendiğinde, 1-12 numaralı maddelerin bir boyutta, 13-20 numaralı maddelerin ise diğer bir boyutta yüklendiği görülmektedir. Bu nedenle veri seti aşağıdaki adımlar izlenerek ikiye bölünmüş ve ileri analizler her iki faktör için de ayrı ayrı yürütülmüştür.</p>
<div class="cell">
<div class="sourceCode" id="cb13" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data4a</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data4</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data4b</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data4</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span></span></code></pre></div>
</div>
<p>Yerel bağımsızlık varsayımının kontrolü için Yen’in Q analizi (Yen, 1984) her iki bileşen için de uygulanmıştır. Bu süreçte sirt paketinden (Robitzsch, 2020) yararlanılmış ve aşağıdaki adımlar izlenmiştir. &nbsp;</p>
<pre><code>Mod1 &lt;- TAM::tam.mml( resp=data4a )
Mod1.wle &lt;- TAM::tam.wle(Mod1)
Mod1.q3 &lt;- sirt::Q3( dat=data4a, theta=Mod1.wle$theta, b=Mod1$item_irt[[3]] )
Mod2 &lt;- TAM::tam.mml( resp=data4b )
Mod2.wle &lt;- TAM::tam.wle(Mod2)
Mod2.q3 &lt;- sirt::Q3( dat=data4b, theta=Mod2.wle$theta, b=Mod2$item_irt[[3]] )</code></pre>
<p>Bu üstteki kodun çıktısı çooook uzun. Buraya koymuyorum. Tabi biz veriyi bootstrap ile çoğalttığımız için bu varsayım karşılanmadı ama gerçek veri ile çalışsaydık bu varsayımın karşılanmaması durumunda çöp olacaktı analiz. Yani örneklem yetersiz, daha çok örneklem lazım diyecektik. Ya da modeli veya madde sayılarını inceleyecektik vs.&nbsp;vs.</p>
<p>Birinci araştırma sorusunun son aşamasında ise model veri uyumunun incelenmesi ve en uygun modelin seçilmesi yer almaktadır. Model-veri uyumu incelemesi ltm paketi (Rizopoulos, 2006) yardımı ile her iki bileşen için de ayrı ayrı GRM modeli ile yürütülmüştür. Her iki bileşende de model-1, ayırt edicilik düzeylerinin her madde için farklılaştığı modeli betimlemektedir. Model-2 ise ayırt edicilik düzeylerinin her madde için eşit tutulduğu modeldir.</p>
<div class="cell">
<div class="sourceCode" id="cb15" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model1_d4a</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/ltm/man/grm.html">grm</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data4a</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model2_d4a</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/ltm/man/grm.html">grm</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data4a</span>, constrained <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model1_d4b</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/ltm/man/grm.html">grm</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data4b</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model2_d4b</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/ltm/man/grm.html">grm</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data4b</span>, constrained <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model2_d4a</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model1_d4a</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 Likelihood Ratio Table
                AIC      BIC   log.Lik    LRT df p.value
model2_d4a 31785.45 32025.93 -15843.72                  
model1_d4a 31660.51 31954.98 -15770.26 146.94 11  &lt;0.001</code></pre>
</div>
<div class="sourceCode" id="cb17" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model2_d4b</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model1_d4b</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 Likelihood Ratio Table
                AIC      BIC   log.Lik   LRT df p.value
model2_d4b 21742.58 21904.54 -10838.29                 
model1_d4b 21664.77 21861.08 -10792.38 91.81  7  &lt;0.001</code></pre>
</div>
</div>
<p>Modeller arasında manidar farklılık anlamına gelen p değerlerine (&lt;.05) sahip olmasının yanı sıra, Akaike ve Bayesian bilgi kriter değerleri en düşük olan modellerin her iki bileşen için de model-1 olduğu görülmektedir. Bu nedenle model-1 ile daha iyi bir model-veri uyumu sağlanmaktadır. Devam analizleri her iki bileşen için de model-1 ile yürütülmüştür.</p>
</section><section id="b.-madde-parametreleri" class="level3"><h3 class="anchored" data-anchor-id="b.-madde-parametreleri">1.b. Madde parametreleri</h3>
<p>Model-veri uyumu sınandıktan ve en uygun model belirlendikten sonra, madde parametrelerinin incelenmesi aşamasına geçilmiştir. Model-1 üzerinden aşağıdaki kod satırları kullanılarak elde edilen madde parametreleri görülebilir.</p>
<div class="cell">
<div class="sourceCode" id="cb19" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model1_d4a</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Extrmt1 Extrmt2 Extrmt3 Extrmt4 Dscrmn
L1   -1.259  -0.119   0.576   1.625  2.361
L2   -0.994   0.224   1.002   2.265  1.383
L3   -1.157  -0.363   0.254   1.498  2.401
L4   -1.270  -0.276   0.610   1.718  2.355
L5   -1.130  -0.312   0.337   1.382  2.248
L6   -1.565  -0.657   0.322   1.309  1.895
L7   -1.061  -0.257   0.460   1.453  2.129
L8   -1.201  -0.401   0.314   1.367  2.635
L9   -1.102  -0.322   0.363   1.246  2.296
L10  -1.222  -0.295   0.476   1.473  1.815
L11  -1.218  -0.457   0.345   1.320  2.123
L12  -1.096  -0.249   0.737   1.819  1.661</code></pre>
</div>
<div class="sourceCode" id="cb21" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model1_d4b</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Extrmt1 Extrmt2 Extrmt3 Extrmt4 Dscrmn
L13  -0.665   0.150   0.830   1.786  2.353
L14  -0.791   0.148   0.917   1.802  2.290
L15  -1.388  -0.736   0.198   0.920  2.308
L16  -1.210   0.064   1.206   1.969  1.718
L17  -0.998   0.150   1.077   1.832  1.898
L18  -1.775  -0.720   0.598   1.664  1.338
L19  -1.751  -0.514   0.694   1.600  1.505
L20  -1.262  -0.351   0.505   1.277  2.007</code></pre>
</div>
</div>
<p>Tablo 4 incelendiğinde, her madde için eşik parametrelerinin beklendik bir şekilde birinciden dördüncüye doğru arttığı görülmektedir. Bazı maddelerin birinci eşik parametresinin -1’den daha büyük bir değerle başladığı dikkat çekmektedir. Örneğin ikinci bileşene ait ilk madde olan 13. Maddenin ilk kategorisini seçen bir bireyin yetenek seviyesi %50 ihtimalle -.66’dan daha düşüktür.&nbsp;</p>
</section><section id="c.-örnek-madde-karakteristik-eğrileri" class="level3"><h3 class="anchored" data-anchor-id="c.-örnek-madde-karakteristik-eğrileri">1.c. Örnek Madde Karakteristik Eğrileri</h3>
<p>Çalışmanın bu aşamasında madde karakteristik eğrisi ideal ve sorunlu olan birer madde incelenmiş ve yorumlanmıştır. Bu nedenle, öncelikle birinci bileşeni oluşturan tüm maddelerin madde karakteristik eğrileri <code><a href="https://rdrr.io/r/graphics/plot.default.html">plot()</a></code> fonksiyonu ile oluşturulmuştur. İdeal bir madde karakteristik eğrisine sahip olduğu düşünülen sekizinci madde ve kısmi sorunlu olduğu düşünülen ikinci maddenin madde karakteristik eğrileri aşağıdaki kod satırları yürütülerek oluşturulmuştur.</p>
<div class="cell">
<div class="sourceCode" id="cb23" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model1_d4a</span>, type<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ICC"</span>,item<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, xlab<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"YETENEK"</span>, cex.main <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, main <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"MADDE KARAKTERİSTİK EĞRİSİ- Madde: 6"</span>, ylab <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"OLASILIK"</span> , lwd<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, col.main<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>, font.axis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, font.lab<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="https://emrekaragul.com/posts/Item Analysis with Item Response Theory (in Turkish)/index_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode" id="cb24" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model1_d4a</span>, type<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ICC"</span>,xlab<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"YETENEK"</span>, cex.main <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, ylab <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"OLASILIK"</span> , lwd<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, col.main<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>, font.axis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, font.lab<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, main <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"MADDE KARAKTERİSTİK EĞRİSİ- Madde: 2"</span>, items <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="https://emrekaragul.com/posts/Item Analysis with Item Response Theory (in Turkish)/index_files/figure-html/unnamed-chunk-13-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Görülen ilk grafik diğer maddelere göre daha ideal dağılım gösteren bir maddeye aittir. Bu maddenin eğrileri tüm yetenek düzeylerini kapsayacak şekilde sivrilip dağılmaktadır. Örneğin, sıfır yetenek düzeyinde bir bireyin üçüncü kategoride yer alma olasılığı en yüksek düzeydedir. Benzer şekillerde diğer kategorilerin de yüksek olasılık ile temsil ettikleri yetenek düzeyleri belirgin bir şekilde görülmektedir. Bu durumda bu maddenin ayırt edicilik düzeyinin yüksek olması beklenir. Madde parametreleri çıktısında da görüleceği üzere, bu maddeye ait ayırt edicilik parametresi birinci bileşenin en yüksek ayırt edicilik düzeyidir.</p>
<p>İkinci grafik ise kısmen problemli olduğu düşünülen bir grafiktir. Bu grafiğin daha iyi yorumlanabilmesi için, eksenlerinde yer alan değerler axis() fonksiyonu ile daha detaylı hale getirilmiştir. Ayrıca abline() fonksiyonu ile 0.6 yetenek düzeyine dikey bir çizgi eklenmiştir.</p>
<div class="cell">
<div class="sourceCode" id="cb25" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model1_d4a</span>, type<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ICC"</span>,</span>
<span>     xlab<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"YETENEK"</span>, </span>
<span>     cex.main <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, </span>
<span>     ylab <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"OLASILIK"</span> , </span>
<span>     lwd<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, col.main<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>, </span>
<span>     font.axis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, </span>
<span>     font.lab<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, </span>
<span>     main <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"MADDE KARAKTERİSTİK EĞRİSİ- Madde: 2"</span>, </span>
<span>     items <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/graphics/axis.html">axis</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, at <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, by <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/graphics/axis.html">axis</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, at <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, by <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>v<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.6</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="https://emrekaragul.com/posts/Item Analysis with Item Response Theory (in Turkish)/index_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Maddenin eğrileri incelendiğinde, 0.6 yetenek düzeyinde bir bireyin ikinci, üçüncü ve dördüncü kategorileri seçme olasılıklarının birbirlerine çok yakın olduğu görülmektedir. Bu durum, maddenin ayırt ediciliğini olumsuz olarak etkilemektedir. Daha önceki çıktılardan bilindiği üzere bu maddeye ait ayırt edicilik parametresi birinci bileşenin en düşük ayırt edicilik düzeyidir. Ayrıca, bu maddenin üçüncü kategorisinin sivrilmediği de dikkat çekmektedir. Bu durumda bu maddenin üçüncü kategorisinin çıkarılarak dört kategorili bir maddeye dönüştürülmesi düşünülebilir. Bir başka seçenek ise bu maddenin ölçekten çıkarılması ve analizlerin yeniden yapılması olabilir.&nbsp;</p>
</section><section id="d.-test-bilgi-fonksiyonu" class="level3"><h3 class="anchored" data-anchor-id="d.-test-bilgi-fonksiyonu">1.d. Test Bilgi Fonksiyonu</h3>
<p>Her iki bileşen için de test bilgi fonksiyonları aşağıdaki kod satırları kullanılarak elde edilmiştir:</p>
<div class="cell">
<div class="sourceCode" id="cb26" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model1_d4a</span>, type<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"IIC"</span>, items <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, xlab<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"YETENEK"</span>, cex.main <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, main <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"TEST   BİLGİ   FONKSİYONU"</span>, ylab <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"BİLGİ"</span> , lwd<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, col.main<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>, col<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blue"</span>, font.axis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, font.lab<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="https://emrekaragul.com/posts/Item Analysis with Item Response Theory (in Turkish)/index_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode" id="cb27" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model1_d4b</span>, type<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"IIC"</span>, items <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, xlab<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"YETENEK"</span>, cex.main <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, main <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"TEST   BİLGİ   FONKSİYONU"</span>, ylab <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"BİLGİ"</span> , lwd<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, col.main<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>, col<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blue"</span>, font.axis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, font.lab<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="https://emrekaragul.com/posts/Item Analysis with Item Response Theory (in Turkish)/index_files/figure-html/unnamed-chunk-15-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Test bilgi fonksiyonlarının 0 yetenek düzeyinde en yüksek seviyede olduğu, -/+ 2 yetenek düzeylerinde sert bir şekilde düşmeye başladığı ve -/+ 4 yetenek düzeylerinde en düşük seviyesinde olduğu görülmektedir. Bu durumda her iki bileşenin de en çok 0 yetenek düzeyinde bilgi sağladığı ve -2 ile +2 aralığında yüksek düzeyde bilgi sağladığı söylenebilir. Ancak bu aralığın ötesinde sağlanan bilginin hızla azaldığı düşünülebilir.&nbsp;</p>
<p>Çalışmanın bu aşamasında madde bilgi eğrileri de aşağıdaki kod satırları kullanılarak elde edilmiştir:</p>
<div class="cell">
<div class="sourceCode" id="cb28" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model1_d4a</span>, type<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"IIC"</span>,xlab<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"YETENEK"</span>, cex.main <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, ylab <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"BİLGİ"</span> , col.main<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>, font.axis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, font.lab<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, main <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1. BİLEŞEN MADDE BİLGİ  EĞRİLERİ"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="https://emrekaragul.com/posts/Item Analysis with Item Response Theory (in Turkish)/index_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode" id="cb29" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model1_d4b</span>, type<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"IIC"</span>,xlab<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"YETENEK"</span>, cex.main <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, ylab <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"BİLGİ"</span> , col.main<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>, font.axis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, font.lab<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, main <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2. BİLEŞEN MADDE BİLGİ  EĞRİLERİ"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="https://emrekaragul.com/posts/Item Analysis with Item Response Theory (in Turkish)/index_files/figure-html/unnamed-chunk-16-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Bunlar incelendiğinde ise her iki bileşen için de maddelerin ölçülen özelliği geniş bir yetenek puanı ölçeğinde ölçtüğü görülmektedir. Birinci bileşen içerisinde en düşük bilgi sağlayan maddenin ikinci madde olduğu dikkat çekmektedir. Yine bilgi eğrisi en yüksek maddenin birinci bileşen için sekizinci madde olduğu da görülmektedir.&nbsp; Bunlar, bir önceki bölümde kısmi problemli ve ideal dağılımlı olarak incelenen maddelerdir. Eğer ikinci bileşen için birer madde seçilecek olsaydı, o bileşene ait altı ve üç numaralı maddeler sırasıyla kısmi problemli ve ideal maddelere örnek olarak seçilebilirdi.&nbsp;</p>
</section><section id="e.-yetenek-puanları" class="level3"><h3 class="anchored" data-anchor-id="e.-yetenek-puanları">1.e. Yetenek Puanları</h3>
<p>Çok kategorili puanlanan maddelere yönelik olarak yürütülen analizlerin son aşamasında bireylere ait yetenek puanları hesaplanmış ve bunların dağılımı incelenmiştir. Analizlerin bu aşamasında şu kod satırları kullanılarak birinci ve ikinci bileşen için yetenek puanları ayrı ayrı hesaplanmıştır.&nbsp;</p>
<div class="cell">
<details class="code-fold"><summary>Kod</summary><div class="sourceCode" id="cb30" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#BİLEŞEN-1</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">score_d4a</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/psych/man/factor.scores.html">factor.scores</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model1_d4a</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">oruntu_d4a</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">score_d4a</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[[</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">oruntu_d4a</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">toplam</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/colSums.html">rowSums</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">oruntu_d4a</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">score_d4a</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/psych/man/factor.scores.html">factor.scores</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model1_d4a</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">oruntu_d4a</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">score_d4a</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[[</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">oruntu_d4a</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">toplam</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/colSums.html">rowSums</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">oruntu_d4a</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">theta_d4a</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/numeric.html">numeric</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">i</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">419</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span> </span>
<span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">j</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span>         <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/sum.html">sum</a></span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">oruntu_d4a</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">i</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data4a</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">j</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span>              <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">theta_d4a</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">j</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">oruntu_d4a</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">i</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span>      <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data4a</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">theta</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">theta_d4a</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data4a</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">toplam</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/colSums.html">rowSums</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data4a</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span></span>
<span></span>
<span></span>
<span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#BİLEŞEN-2</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">score_d4b</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/psych/man/factor.scores.html">factor.scores</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model1_d4b</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">oruntu_d4b</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">score_d4b</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[[</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">oruntu_d4b</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">toplam</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/colSums.html">rowSums</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">oruntu_d4b</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">theta_d4b</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/numeric.html">numeric</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">i</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">404</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span>  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">j</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span>      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/sum.html">sum</a></span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">oruntu_d4b</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">i</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data4b</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">j</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span>             <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">theta_d4b</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">j</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">oruntu_d4b</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">i</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data4b</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">theta</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">theta_d4b</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data4b</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">toplam</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/colSums.html">rowSums</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data4b</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
</details>
</div>
<p>Bunun ardından <code><a href="https://rdrr.io/pkg/psych/man/describe.html">describe()</a></code> fonksiyonu ile birey yetenek puanlarının betimsel istatikleri elde edilmiştir. Ayrıca <code><a href="https://rdrr.io/r/graphics/hist.html">hist()</a></code> fonksiyonu ile histogram grafikleri oluşturulmuştur. Şu kod satırları kullanılmıştır.&nbsp;</p>
<div class="cell">
<details class="code-fold"><summary>Kod</summary><div class="sourceCode" id="cb31" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#BİLEŞEN-1</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/psych/man/describe.html">describe</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data4a</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">theta</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>   vars    n mean   sd median trimmed  mad  min  max range skew kurtosis   se
X1    1 1000 0.05 0.93   0.02    0.05 0.92 -2.3 2.59  4.88 0.03     -0.2 0.03</code></pre>
</div>
<details class="code-fold"><summary>Kod</summary><div class="sourceCode" id="cb33" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data4a</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">theta</span>, xlab<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"YETENEK"</span>, cex.main <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, ylab <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FREKANS"</span> , col.main<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>, font.axis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, font.lab<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, main <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1. BİLEŞEN BİREY YETENEK PUANLARI"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="https://emrekaragul.com/posts/Item Analysis with Item Response Theory (in Turkish)/index_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Kod</summary><div class="sourceCode" id="cb34" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#BİLEŞEN-2</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/psych/man/describe.html">describe</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data4b</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">theta</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>   vars    n  mean   sd median trimmed  mad   min max range  skew kurtosis   se
X1    1 1000 -0.01 0.92   0.05       0 0.89 -2.19 2.5  4.69 -0.04    -0.14 0.03</code></pre>
</div>
<details class="code-fold"><summary>Kod</summary><div class="sourceCode" id="cb36" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data4b</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">theta</span>, xlab<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"YETENEK"</span>, cex.main <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, ylab <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FREKANS"</span> , col.main<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>, font.axis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, font.lab<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, main <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2. BİLEŞEN BİREY YETENEK PUANLARI"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="https://emrekaragul.com/posts/Item Analysis with Item Response Theory (in Turkish)/index_files/figure-html/unnamed-chunk-18-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Her iki bileşene ait betimsel istatikler ve histogram grafikleri incelendiğinde, ortalamalarının sıfıra, standart sapmalarının da bire çok yakın olduğu görülmektedir. Bu durum her iki bileşenden elde edilen verinin de normal dağılım sergilediğini göstermektedir.</p>
</section></section><section id="iki-kategorili-maddelere-yönelik-aşamalar" class="level2"><h2 class="anchored" data-anchor-id="iki-kategorili-maddelere-yönelik-aşamalar"><strong>2. İki Kategorili Maddelere Yönelik Aşamalar</strong></h2>
<p>Çalışmanın ikinci araştırma sorusu kapsamında, çok kategorili maddelerden oluşan veri setinin iki kategoriye dönüştürülmesi gerekmektedir. Çok kategorili puanlanan maddelerin iki kategorili olarak kodlanmasında izlenen adımlar şunlardır:</p>
<div class="cell">
<div class="sourceCode" id="cb37" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data5</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data4</span></span>
<span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">i</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span>   <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">j</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data5</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">i</span>,<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">j</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data5</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>,<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">j</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data5</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">i</span>,<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">j</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span> </span>
<span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data5</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">i</span>,<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">j</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span></code></pre></div>
</div>
<section id="a.-varsayımların-kontrolü-ve-uygun-mtk-modeli" class="level3"><h3 class="anchored" data-anchor-id="a.-varsayımların-kontrolü-ve-uygun-mtk-modeli"><strong>2.a. Varsayımların Kontrolü ve Uygun MTK Modeli</strong></h3>
<p>İki kategorili puanlanan maddelerden oluşan ölçeğin Madde Tepki Kuramı çerçevesinde incelenmesi sürecinde öncelikle uygun MTK modelinin belirlenebilmesi için varsayım kontrolleri yapılmıştır. Bu bağlamda, tek boyutluluk ve yerel bağımsızlık varsayımları ile model-veri uyumu kontrol edilmiştir. Tek boyutluluk varsayımı kontrolü için paralel analiz, yamaç birikinti grafiği ve faktör analizi kullanılmıştır. Bu amaçla, Psych paketinden (Revelle, 2020) faydalanılmıştır.</p>
<div class="cell">
<div class="sourceCode" id="cb38" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/psych/man/fa.parallel.html">fa.parallel</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data5</span>, main <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"PARALEL ANALİZ SAÇILIM GRAFİĞİ"</span>, ylabel <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Temel Bileşenler ve Faktör Analizi Özdeğerleri"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="https://emrekaragul.com/posts/Item Analysis with Item Response Theory (in Turkish)/index_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Parallel analysis suggests that the number of factors =  4  and the number of components =  2 </code></pre>
</div>
</div>
<p>Paralel analiz ve yamaç birikinti grafiği iki bileşenli bir yapıyı göstermektedir.&nbsp; Bu nedenle hem iki hem de tek bileşenli modeller oluşturulmuştur. Aşağıda izlenen adımlar sonrası elde edilen modeller ait faktör yükleri görülebilir.</p>
<div class="cell">
<div class="sourceCode" id="cb40" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/psych/man/fa.html">fa</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data5</span>, cor <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tet"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="sourceCode" id="cb41" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/psych/man/fa.html">fa</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data5</span>, cor <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tet"</span>, nfactors <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
</div>
<p>Faktör yüklerinin her madde için her iki modelde de .60’nın üzerinde olduğu görülmektedir. Tek bileşenli yapının açıkladığı varyansın ise %61 olduğu anlaşılmaktadır. Bunun yanı sıra, iki bileşenli yapının birinci bileşenin %40, ikinci bileşenin %28 olmak üzere toplamda %68 oranında açıklanan varyansa sahip olduğu görülmektedir. Açıklanan varyans açısından modeller arasındaki farkın çok büyük olmadığı düşünüldüğünden, ileri analizlere tek bileşenli model ile devam edilmesine karar verilmiştir.&nbsp;&nbsp;</p>
<p>Yerel bağımsızlık varsayımının kontrolü için Yen’in Q analizi (Yen, 1984)&nbsp; uygulanmıştır. Bu süreçte sirt paketinden (Robitzsch, 2020) yararlanılmış ve aşağıdaki adımlar izlenmiştir.&nbsp;</p>
<div class="cell">
<details class="code-fold"><summary>Kod</summary><div class="sourceCode" id="cb42" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/sirt/man/rasch.mml.html">rasch.mml2</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data5</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model.wle</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/sirt/man/wle.rasch.html">wle.rasch</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span> dat<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data5</span>, b<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">item</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">b</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">yenq3</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/sirt/man/Q3.html">Q3</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span> dat<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data5</span>, theta<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model.wle</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">theta</span>, b<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">item</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">b</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
</details>
</div>
<p>Yerel bağımsızlık varsayımının karşılandığı görülmektedir. Bu nedenle model-veri uyumu incleme aşamasına geçilmiştir. Bu aşamada ltm paketinden (Rizopoulos, 2006) faydalanılmıştır. Aşağıdaki kod satırları kullanılarak elde edilen Benzerlik oranı tabloları görülebilir.</p>
<div class="cell">
<div class="sourceCode" id="cb43" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/ltm/man/rasch.html">rasch</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data5</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/ltm/man/ltm.html">ltm</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data5</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">z1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>  </span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model3</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/ltm/man/tpm.html">tpm</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data5</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model1</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 Likelihood Ratio Table
            AIC      BIC  log.Lik    LRT df p.value
model1 15975.79 16078.85 -7966.89                  
model2 15913.21 16109.52 -7916.61 100.58 19  &lt;0.001</code></pre>
</div>
<div class="sourceCode" id="cb45" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model1</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model3</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 Likelihood Ratio Table
            AIC      BIC  log.Lik    LRT df p.value
model1 15975.79 16078.85 -7966.89                  
model3 15914.14 16208.61 -7897.07 139.64 39  &lt;0.001</code></pre>
</div>
<div class="sourceCode" id="cb47" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model2</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model3</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 Likelihood Ratio Table
            AIC      BIC  log.Lik   LRT df p.value
model2 15913.21 16109.52 -7916.61                 
model3 15914.14 16208.61 -7897.07 39.07 20   0.007</code></pre>
</div>
</div>
<p>Akaike ve Bayesian bilgi kriterleri incelendiğinde, üç model arasında ikinci modelin manidar farkla en uygun model olduğu görülmektedir. Bu nedenle, devam analizleri iki parametreli model ile yürütülmüştür.</p>
</section><section id="b.-madde-parametreleri-1" class="level3"><h3 class="anchored" data-anchor-id="b.-madde-parametreleri-1"><strong>2.b. Madde Parametreleri</strong></h3>
<p>Model-veri uyumu sınandıktan ve en uygun model belirlendikten sonra, madde parametrelerinin incelenmesi aşamasına geçilmiştir. Model-2 üzerinden <code><a href="https://rdrr.io/r/stats/coef.html">coef()</a></code> fonksiyonu kullanılarak elde edilen madde parametreleri aşağıdadır.</p>
<div class="cell">
<div class="sourceCode" id="cb49" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        Dffclt   Dscrmn
L1  -0.8112296 2.832181
L2  -0.7312085 1.933827
L3  -0.8181936 2.659799
L4  -0.8109842 3.100650
L5  -0.8380050 2.394060
L6  -1.0180088 2.070947
L7  -0.8694781 2.103077
L8  -0.8977956 2.683691
L9  -0.7951705 2.798913
L10 -0.8580558 2.207506
L11 -0.8789145 2.322482
L12 -0.8528908 1.705619
L13 -0.6390827 2.246105
L14 -0.6903395 2.247931
L15 -0.8834606 2.517332
L16 -0.7716486 2.330535
L17 -0.7333232 2.334138
L18 -1.1852158 1.497807
L19 -1.0471877 1.896025
L20 -0.8162163 2.864486</code></pre>
</div>
</div>
<p>Çıktılar incelendiğinde, güçlük parametresi en yüksek olan maddenin 13. madde olduğu göze çarpmaktadır. Yetenek düzeyi -.63’ten daha yüksek olan bireyler bu maddeyi %50’den daha yüksek bir ihtimalle doğru cevaplayacaklardır.</p>
</section><section id="c.-örnek-madde-karakteristik-eğrileri-1" class="level3"><h3 class="anchored" data-anchor-id="c.-örnek-madde-karakteristik-eğrileri-1"><strong>2.c.&nbsp; Örnek Madde Karakteristik Eğrileri</strong></h3>
<p>Çalışmanın bu aşamasında, iki kategorili puanlanan maddelerin analizinde madde karakteristik eğrisi ideal ve sorunlu olan birer madde incelenmiş ve yorumlanmıştır. Bu nedenle, öncelikle birinci bileşeni oluşturan tüm maddelerin madde bilgi eğrileri <code><a href="https://rdrr.io/r/graphics/plot.default.html">plot()</a></code> fonksiyonu ile oluşturulmuş, aşağıdaki kod satırları kullanılmıştır:</p>
<div class="cell">
<div class="sourceCode" id="cb51" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model2</span>, type<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"IIC"</span>,xlab<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"YETENEK"</span>, cex.main <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, ylab <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"BİLGİ"</span> , col.main<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>, font.axis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, font.lab<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, main <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"MADDE BİLGİ  EĞRİLERİ"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="https://emrekaragul.com/posts/Item Analysis with Item Response Theory (in Turkish)/index_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Madde bilgi eğrileri incelendiğinde, en çok bilgiyi dördüncü maddenin sağladığı görülmektedir. En düşük bilgi sağlayan maddelerden birisinin ise 12. madde olduğu görülmektedir. Bu nedenle madde karakteristik eğrilerinin incelenmesi sürecinde örnek olarak bu iki madde tercih edilmiştir. Bu maddelere ait karakteristik eğrileri aşağıdaki kod satırları ile elde edilmiştir.</p>
<div class="cell">
<div class="sourceCode" id="cb52" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model2</span>, type<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ICC"</span>, items <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>, labels <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"madde-4"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"madde-12"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>, legend <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">T</span>, xlab<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"YETENEK"</span>, cex.main <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, main <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"MADDE KARAKTERİSTİK EĞRİSİ"</span>, ylab <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"OLASILIK"</span> , lwd<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.81</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.5</span>, lwd<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, pch<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/graphics/text.html">text</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.81</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.5</span>, lwd<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, labels <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"b par.: -0.81"</span>, pos <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.85</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.5</span>, lwd<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, col<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>, pch<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/graphics/text.html">text</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.85</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.5</span>, lwd<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, labels <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"b par.: -0.85"</span>, pos <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, col<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="https://emrekaragul.com/posts/Item Analysis with Item Response Theory (in Turkish)/index_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Dört ve 12 numaralı maddelerin güçlük parametreleri birbirlerine oldukça yakındır. Ancak dördüncü madde diğerine göre daha dik bir karakteristik eğrisine sahiptir. Bu durum iki maddenin ayırt edicilik parametrelerindeki farklılıktan kaynaklanmaktadır. Dördüncü madde yüksek bir ayırt edicilik parametresi ile ideal bir madde gibi görünürken, 12. madde düşük bir ayırt edicilik parametresi ile kısmi problemli bir madde görüntüsü sergilemektedir. Yine de 12 numaralı maddenin parametre değerlerinin kabul edilebilir olduğu da vurgulanmalıdır.&nbsp;</p>
</section><section id="d.-test-bilgi-fonksiyonu-1" class="level3"><h3 class="anchored" data-anchor-id="d.-test-bilgi-fonksiyonu-1"><strong>2.d. Test Bilgi Fonksiyonu</strong></h3>
<p>İki kategorili puanlanan maddelere yönelik test bilgi fonksiyonunu elde etmek için aşağıdaki kod satırları kullanılmıştır. <code><a href="https://rdrr.io/r/graphics/locator.html">locator()</a></code> fonksiyonu aracılığı ile test bilgi fonksiyonunun tepe noktası tespit edilmiş ve ardından <code><a href="https://rdrr.io/r/graphics/abline.html">abline()</a></code> fonksiyonu ile tepe noktasının koordinat çizgileri grafiğe eklenmiştir.</p>
<div class="cell">
<div class="sourceCode" id="cb53" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model2</span>, type<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"IIC"</span>, items <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, xlab<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"YETENEK"</span>, cex.main <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, main <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"TEST   BİLGİ   FONKSİYONU"</span>, ylab <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"BİLGİ"</span> , lwd<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,col.main<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>,col<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blue"</span>, font.axis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, font.lab<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/graphics/axis.html">axis</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, at <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>, by <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/graphics/axis.html">axis</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, at <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, by <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>h<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">27.74</span>, v<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.8451</span>, lty<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="https://emrekaragul.com/posts/Item Analysis with Item Response Theory (in Turkish)/index_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Test bilgi fonksiyonunun -0.84 yetenek düzeyinde en yüksek seviyede olduğu, -1.5 ile 0 yetenek düzeylerinde sert bir şekilde düşmeye başladığı ve -2.8 ve 1.1 yetenek düzeylerinde en düşük seviyesinde olduğu görülmektedir. Bu durumda en yüksek bilginin bu ölçekte -.8 yetenek düzeylerinde sağlandığı söylenebilir.&nbsp;</p>
<p>Bu durumda her iki bileşenin de en çok 0 yetenek düzeyinde bilgi sağladığı ve -2 ile +2 aralığında yüksek düzeyde bilgi sağladığı söylenebilir. Ancak bu aralığın ötesinde sağlanan bilginin hızla azaldığı düşünülebilir.</p>
</section><section id="e.-yetenek-puanları-1" class="level3"><h3 class="anchored" data-anchor-id="e.-yetenek-puanları-1"><strong>2.e. Yetenek Puanları</strong></h3>
<p>İki kategorili puanlanan maddelere yönelik olarak yürütülen analizlerin son aşamasında bireylere ait yetenek puanları hesaplanmış ve bunların dağılımı incelenmiştir. Şu kod satırları ile hesaplanan yetenek puanları veri setine eklenmiştir.</p>
<div class="cell">
<div class="sourceCode" id="cb54" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">score_d5</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/ltm/man/factor.scores.html">factor.scores.ltm</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">model2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">oruntu_d5</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">score_d5</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[[</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">oruntu_d5</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">toplam</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/colSums.html">rowSums</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">oruntu_d5</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">theta_d5</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/numeric.html">numeric</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">i</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">454</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span>     <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">j</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span>         <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/sum.html">sum</a></span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">oruntu_d5</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">i</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data5</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">j</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span>             <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">theta_d5</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">j</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">oruntu_d5</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">i</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">23</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data5</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">theta</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">theta_d5</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data5</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">toplam</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/colSums.html">rowSums</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data5</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
</div>
<p>Bunun ardından <code><a href="https://rdrr.io/pkg/psych/man/describe.html">describe()</a></code> fonksiyonu ile birey yetenek puanlarının betimsel istatikleri elde edilmiştir. Ayrıca hist() fonksiyonu ile histogram grafikleri oluşturulmuştur. Bu süreçlerde kullanılan kod satırları şunlardır:</p>
<div class="cell">
<div class="sourceCode" id="cb55" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#BİLEŞEN-1</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/psych/man/describe.html">describe</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data5</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">theta</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   vars    n  mean   sd median trimmed  mad   min  max range  skew kurtosis
X1    1 1000 -0.03 0.81   0.05    0.04 1.24 -2.17 0.89  3.06 -0.45     -0.8
     se
X1 0.03</code></pre>
</div>
<div class="sourceCode" id="cb57" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data5</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">theta</span>, xlab<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"YETENEK"</span>, cex.main <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, ylab <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FREKANS"</span> , col.main<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>, font.axis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, font.lab<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, main <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"BİREY YETENEK PUANLARI"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="https://emrekaragul.com/posts/Item Analysis with Item Response Theory (in Turkish)/index_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>İncelenen iki kategorili puanlanan veriye ait betimsel istatikleri incelendiğinde, ortalamanın -.03, standart sapmanın da .81 olduğu görülmektedir. Bu durum verinin normal dağıldığı şeklinde yorumlanabilir, ancak histogram grafiği incelendiğinde yetenek puanlarının -2 ile 1 arasında dağılım gösterdiği ve 1 yetenek puanında bir yığılma olduğu görülmektedir. Bu durum, verilerin çok kategorili puanlanan maddelerden ortalamaları doğrultusunda iki kategorili puanlanan maddelere çevrilmesiyle ilişkisi olduğu düşünülmektedir.</p>
</section></section><section id="sonuç" class="level2"><h2 class="anchored" data-anchor-id="sonuç">SONUÇ</h2>
<p>Bu çalışma simüle edilmiş veri ile yürütülmüştür. Çıktılarında bu nedenle temel problemler görülebilmektedir. Yine de aşama aşama MTK ile madde analizinin R ile nasıl yapılacağına dair bana güzel bir referans olmaktadır. Bu çalışma, bir ders raporu olarak hazırlanmıştır.</p>


</section> ]]></description>
  <category>psych</category>
  <category>GPArotation</category>
  <category>sirt</category>
  <category>ltm</category>
  <guid>https://emrekaragul.com/posts/Item Analysis with Item Response Theory (in Turkish)/</guid>
  <pubDate>Fri, 19 Nov 2021 21:00:00 GMT</pubDate>
  <media:content url="https://emrekaragul.com/posts/Item Analysis with Item Response Theory (in Turkish)/mtk.png" medium="image" type="image/png" height="144" width="144"/>
</item>
</channel>
</rss>
